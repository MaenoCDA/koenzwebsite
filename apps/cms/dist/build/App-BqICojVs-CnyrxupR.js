import{nN as Zb,r as v,al as xi,rs as ew,i2 as tw,sB as nw,sC as rw,aa as tt,z as om,j as y,aA as Kt,R as iw,a as Ir,P as gt,ae as wu,ad as sm,cP as Ao,b1 as am,sD as wt,aW as lm,aU as vu,L as Nt,N as ac,sE as Gf,n as ye,o as lc,G as Tt,B as vt,b3 as se,e as Me,sF as ow,d as Ns,sG as cm,b8 as Zr,sH as Te,a6 as sw,v as he,b_ as um,sI as aw,a2 as lw,M as Oe,sJ as Jf,U as X,a4 as lo,u as cw,s as uw,jj as fw,sK as dw,S as hw,Z as er,sL as Is,K as fm,X as Uf,sM as pw,_ as ga,$ as co,rv as mw,sN as gw,jC as yw,J as bw,sO as ww,sP as vw,jr as Kf,sQ as xw,H as Sw,sR as Cw,W as dm,sS as kw,js as Ow,sT as Yf}from"./strapi-BzDuHlVM.js";import{p as Fn}from"./index-CaWW6mk2.js";import{u as Ct}from"./index-SwOCJniP.js";var hm={exports:{}},Do={},cc={exports:{}};(function(n,e){(function(t,r){r(e)})(Zb,function(t){function r(I){return function(ne,Q,Z,pe,ke,De,de){return I(ne,Q,de)}}function i(I){return function(ne,Q,Z,pe){if(!ne||!Q||typeof ne!="object"||typeof Q!="object")return I(ne,Q,Z,pe);var ke=pe.get(ne),De=pe.get(Q);if(ke&&De)return ke===Q&&De===ne;pe.set(ne,Q),pe.set(Q,ne);var de=I(ne,Q,Z,pe);return pe.delete(ne),pe.delete(Q),de}}function o(I,L){var ne={};for(var Q in I)ne[Q]=I[Q];for(var Q in L)ne[Q]=L[Q];return ne}function s(I){return I.constructor===Object||I.constructor==null}function a(I){return typeof I.then=="function"}function l(I,L){return I===L||I!==I&&L!==L}var c="[object Arguments]",u="[object Boolean]",f="[object Date]",d="[object RegExp]",h="[object Map]",p="[object Number]",m="[object Object]",g="[object Set]",b="[object String]",x=Object.prototype.toString;function w(I){var L=I.areArraysEqual,ne=I.areDatesEqual,Q=I.areMapsEqual,Z=I.areObjectsEqual,pe=I.areRegExpsEqual,ke=I.areSetsEqual,De=I.createIsNestedEqual,de=De(Mt);function Mt(le,me,Et){if(le===me)return!0;if(!le||!me||typeof le!="object"||typeof me!="object")return le!==le&&me!==me;if(s(le)&&s(me))return Z(le,me,de,Et);var Gn=Array.isArray(le),qf=Array.isArray(me);if(Gn||qf)return Gn===qf&&L(le,me,de,Et);var Vt=x.call(le);return Vt!==x.call(me)?!1:Vt===f?ne(le,me,de,Et):Vt===d?pe(le,me,de,Et):Vt===h?Q(le,me,de,Et):Vt===g?ke(le,me,de,Et):Vt===m||Vt===c?a(le)||a(me)?!1:Z(le,me,de,Et):Vt===u||Vt===p||Vt===b?l(le.valueOf(),me.valueOf()):!1}return Mt}function C(I,L,ne,Q){var Z=I.length;if(L.length!==Z)return!1;for(;Z-- >0;)if(!ne(I[Z],L[Z],Z,Z,I,L,Q))return!1;return!0}var S=i(C);function k(I,L){return l(I.valueOf(),L.valueOf())}function O(I,L,ne,Q){var Z=I.size===L.size;if(!Z)return!1;if(!I.size)return!0;var pe={},ke=0;return I.forEach(function(De,de){if(Z){var Mt=!1,le=0;L.forEach(function(me,Et){!Mt&&!pe[le]&&(Mt=ne(de,Et,ke,le,I,L,Q)&&ne(De,me,de,Et,I,L,Q))&&(pe[le]=!0),le++}),ke++,Z=Mt}}),Z}var M=i(O),R="_owner",T=Object.prototype.hasOwnProperty;function P(I,L,ne,Q){var Z=Object.keys(I),pe=Z.length;if(Object.keys(L).length!==pe)return!1;for(var ke;pe-- >0;){if(ke=Z[pe],ke===R){var De=!!I.$$typeof,de=!!L.$$typeof;if((De||de)&&De!==de)return!1}if(!T.call(L,ke)||!ne(I[ke],L[ke],ke,ke,I,L,Q))return!1}return!0}var z=i(P);function U(I,L){return I.source===L.source&&I.flags===L.flags}function H(I,L,ne,Q){var Z=I.size===L.size;if(!Z)return!1;if(!I.size)return!0;var pe={};return I.forEach(function(ke,De){if(Z){var de=!1,Mt=0;L.forEach(function(le,me){!de&&!pe[Mt]&&(de=ne(ke,le,De,me,I,L,Q))&&(pe[Mt]=!0),Mt++}),Z=de}}),Z}var Se=i(H),J=Object.freeze({areArraysEqual:C,areDatesEqual:k,areMapsEqual:O,areObjectsEqual:P,areRegExpsEqual:U,areSetsEqual:H,createIsNestedEqual:r}),oe=Object.freeze({areArraysEqual:S,areDatesEqual:k,areMapsEqual:M,areObjectsEqual:z,areRegExpsEqual:U,areSetsEqual:Se,createIsNestedEqual:r}),ee=w(J);function Ce(I,L){return ee(I,L,void 0)}var Ot=w(o(J,{createIsNestedEqual:function(){return l}}));function Pr(I,L){return Ot(I,L,void 0)}var tl=w(oe);function qo(I,L){return tl(I,L,new WeakMap)}var nl=w(o(oe,{createIsNestedEqual:function(){return l}}));function Nr(I,L){return nl(I,L,new WeakMap)}function vn(I){return w(o(J,I(J)))}function Go(I){var L=w(o(oe,I(oe)));return function(ne,Q,Z){return Z===void 0&&(Z=new WeakMap),L(ne,Q,Z)}}t.circularDeepEqual=qo,t.circularShallowEqual=Nr,t.createCustomCircularEqual=Go,t.createCustomEqual=vn,t.deepEqual=Ce,t.sameValueZeroEqual=l,t.shallowEqual=Pr,Object.defineProperty(t,"__esModule",{value:!0})})})(cc,cc.exports);var xu=cc.exports,uc={exports:{}};function pm(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=pm(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Xf(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=pm(n))&&(r&&(r+=" "),r+=e);return r}uc.exports=Xf,uc.exports.clsx=Xf;var ya=uc.exports,K={},Mw=function(e,t,r){return e===t?!0:e.className===t.className&&r(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&r(e.verticalCompact,t.verticalCompact)&&r(e.compactType,t.compactType)&&r(e.layout,t.layout)&&r(e.margin,t.margin)&&r(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&r(e.resizeHandles,t.resizeHandles)&&r(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&r(e.droppingItem,t.droppingItem)&&r(e.innerRef,t.innerRef)};Object.defineProperty(K,"__esModule",{value:!0});K.bottom=Su;K.childrenEqual=Rw;K.cloneLayout=mm;K.cloneLayoutItem=ur;K.collides=ba;K.compact=ym;K.compactItem=bm;K.compactType=Ww;K.correctBounds=wm;K.fastPositionEqual=Aw;K.fastRGLPropsEqual=void 0;K.getAllCollisions=vm;K.getFirstCollision=tr;K.getLayoutItem=Cu;K.getStatics=ku;K.modifyLayout=gm;K.moveElement=Bi;K.moveElementAwayFromCollision=dc;K.noop=void 0;K.perc=$w;K.resizeItemInDirection=Lw;K.setTopLeft=Fw;K.setTransform=Bw;K.sortLayoutItems=Au;K.sortLayoutItemsByColRow=Om;K.sortLayoutItemsByRowCol=km;K.synchronizeLayoutWithChildren=_w;K.validateLayout=Mm;K.withLayoutItem=Tw;var Qf=xu,Li=Ew(v);function Ew(n){return n&&n.__esModule?n:{default:n}}function Su(n){let e=0,t;for(let r=0,i=n.length;r<i;r++)t=n[r].y+n[r].h,t>e&&(e=t);return e}function mm(n){const e=Array(n.length);for(let t=0,r=n.length;t<r;t++)e[t]=ur(n[t]);return e}function gm(n,e){const t=Array(n.length);for(let r=0,i=n.length;r<i;r++)e.i===n[r].i?t[r]=e:t[r]=n[r];return t}function Tw(n,e,t){let r=Cu(n,e);return r?(r=t(ur(r)),n=gm(n,r),[n,r]):[n,null]}function ur(n){return{w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minW:n.minW,maxW:n.maxW,minH:n.minH,maxH:n.maxH,moved:!!n.moved,static:!!n.static,isDraggable:n.isDraggable,isResizable:n.isResizable,resizeHandles:n.resizeHandles,isBounded:n.isBounded}}function Rw(n,e){return(0,Qf.deepEqual)(Li.default.Children.map(n,t=>t?.key),Li.default.Children.map(e,t=>t?.key))&&(0,Qf.deepEqual)(Li.default.Children.map(n,t=>t?.props["data-grid"]),Li.default.Children.map(e,t=>t?.props["data-grid"]))}K.fastRGLPropsEqual=Mw;function Aw(n,e){return n.left===e.left&&n.top===e.top&&n.width===e.width&&n.height===e.height}function ba(n,e){return!(n.i===e.i||n.x+n.w<=e.x||n.x>=e.x+e.w||n.y+n.h<=e.y||n.y>=e.y+e.h)}function ym(n,e,t,r){const i=ku(n),o=Au(n,e),s=Array(n.length);for(let a=0,l=o.length;a<l;a++){let c=ur(o[a]);c.static||(c=bm(i,c,e,t,o,r),i.push(c)),s[n.indexOf(o[a])]=c,c.moved=!1}return s}const Dw={x:"w",y:"h"};function fc(n,e,t,r){const i=Dw[r];e[r]+=1;const o=n.map(s=>s.i).indexOf(e.i);for(let s=o+1;s<n.length;s++){const a=n[s];if(!a.static){if(a.y>e.y+e.h)break;ba(e,a)&&fc(n,a,t+e[i],r)}}e[r]=t}function bm(n,e,t,r,i,o){const s=t==="vertical",a=t==="horizontal";if(s)for(e.y=Math.min(Su(n),e.y);e.y>0&&!tr(n,e);)e.y--;else if(a)for(;e.x>0&&!tr(n,e);)e.x--;let l;for(;(l=tr(n,e))&&!(t===null&&o);)if(a?fc(i,e,l.x+l.w,"x"):fc(i,e,l.y+l.h,"y"),a&&e.x+e.w>r)for(e.x=r-e.w,e.y++;e.x>0&&!tr(n,e);)e.x--;return e.y=Math.max(e.y,0),e.x=Math.max(e.x,0),e}function wm(n,e){const t=ku(n);for(let r=0,i=n.length;r<i;r++){const o=n[r];if(o.x+o.w>e.cols&&(o.x=e.cols-o.w),o.x<0&&(o.x=0,o.w=e.cols),!o.static)t.push(o);else for(;tr(t,o);)o.y++}return n}function Cu(n,e){for(let t=0,r=n.length;t<r;t++)if(n[t].i===e)return n[t]}function tr(n,e){for(let t=0,r=n.length;t<r;t++)if(ba(n[t],e))return n[t]}function vm(n,e){return n.filter(t=>ba(t,e))}function ku(n){return n.filter(e=>e.static)}function Bi(n,e,t,r,i,o,s,a,l){if(e.static&&e.isDraggable!==!0||e.y===r&&e.x===t)return n;`${e.i}${String(t)}${String(r)}${e.x}${e.y}`;const c=e.x,u=e.y;typeof t=="number"&&(e.x=t),typeof r=="number"&&(e.y=r),e.moved=!0;let f=Au(n,s);(s==="vertical"&&typeof r=="number"?u>=r:s==="horizontal"&&typeof t=="number"?c>=t:!1)&&(f=f.reverse());const h=vm(f,e),p=h.length>0;if(p&&l)return mm(n);if(p&&o)return`${e.i}`,e.x=c,e.y=u,e.moved=!1,n;for(let m=0,g=h.length;m<g;m++){const b=h[m];`${e.i}${e.x}${e.y}${b.i}${b.x}${b.y}`,!b.moved&&(b.static?n=dc(n,b,e,i,s):n=dc(n,e,b,i,s))}return n}function dc(n,e,t,r,i,o){const s=i==="horizontal",a=i==="vertical",l=e.static;if(r){r=!1;const f={x:s?Math.max(e.x-t.w,0):t.x,y:a?Math.max(e.y-t.h,0):t.y,w:t.w,h:t.h,i:"-1"},d=tr(n,f),h=d&&d.y+d.h>e.y,p=d&&e.x+e.w>d.x;if(d){if(h&&a)return Bi(n,t,void 0,e.y+1,r,l,i);if(h&&i==null)return e.y=t.y,t.y=t.y+t.h,n;if(p&&s)return Bi(n,e,t.x,void 0,r,l,i)}else return`${t.i}${f.x}${f.y}`,Bi(n,t,s?f.x:void 0,a?f.y:void 0,r,l,i)}const c=s?t.x+1:void 0,u=a?t.y+1:void 0;return c==null&&u==null?n:Bi(n,t,s?t.x+1:void 0,a?t.y+1:void 0,r,l,i)}function $w(n){return n*100+"%"}const xm=(n,e,t,r)=>n+t>r?e:t,Sm=(n,e,t)=>n<0?e:t,Cm=n=>Math.max(0,n),Ou=n=>Math.max(0,n),Mu=(n,e,t)=>{let{left:r,height:i,width:o}=e;const s=n.top-(i-n.height);return{left:r,width:o,height:Sm(s,n.height,i),top:Ou(s)}},Eu=(n,e,t)=>{let{top:r,left:i,height:o,width:s}=e;return{top:r,height:o,width:xm(n.left,n.width,s,t),left:Cm(i)}},Tu=(n,e,t)=>{let{top:r,height:i,width:o}=e;const s=n.left-(o-n.width);return{height:i,width:s<0?n.width:xm(n.left,n.width,o,t),top:Ou(r),left:Cm(s)}},Ru=(n,e,t)=>{let{top:r,left:i,height:o,width:s}=e;return{width:s,left:i,height:Sm(r,n.height,o),top:Ou(r)}},Pw=function(){return Mu(arguments.length<=0?void 0:arguments[0],Eu(...arguments))},Nw=function(){return Mu(arguments.length<=0?void 0:arguments[0],Tu(...arguments))},Iw=function(){return Ru(arguments.length<=0?void 0:arguments[0],Eu(...arguments))},zw=function(){return Ru(arguments.length<=0?void 0:arguments[0],Tu(...arguments))},jw={n:Mu,ne:Pw,e:Eu,se:Iw,s:Ru,sw:zw,w:Tu,nw:Nw};function Lw(n,e,t,r){const i=jw[n];return i?i(e,{...e,...t},r):t}function Bw(n){let{top:e,left:t,width:r,height:i}=n;const o=`translate(${t}px,${e}px)`;return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:`${r}px`,height:`${i}px`,position:"absolute"}}function Fw(n){let{top:e,left:t,width:r,height:i}=n;return{top:`${e}px`,left:`${t}px`,width:`${r}px`,height:`${i}px`,position:"absolute"}}function Au(n,e){return e==="horizontal"?Om(n):e==="vertical"?km(n):n}function km(n){return n.slice(0).sort(function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1})}function Om(n){return n.slice(0).sort(function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1})}function _w(n,e,t,r,i){n=n||[];const o=[];Li.default.Children.forEach(e,a=>{if(a?.key==null)return;const l=Cu(n,String(a.key)),c=a.props["data-grid"];l&&c==null?o.push(ur(l)):c?(Mm([c],"ReactGridLayout.children"),o.push(ur({...c,i:a.key}))):o.push(ur({w:1,h:1,x:0,y:Su(o),i:String(a.key)}))});const s=wm(o,{cols:t});return i?s:ym(s,r,t)}function Mm(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout";const t=["x","y","w","h"];if(!Array.isArray(n))throw new Error(e+" must be an array!");for(let r=0,i=n.length;r<i;r++){const o=n[r];for(let s=0;s<t.length;s++){const a=t[s],l=o[a];if(typeof l!="number"||Number.isNaN(l))throw new Error(`ReactGridLayout: ${e}[${r}].${a} must be a number! Received: ${l} (${typeof l})`)}if(typeof o.i<"u"&&typeof o.i!="string")throw new Error(`ReactGridLayout: ${e}[${r}].i must be a string! Received: ${o.i} (${typeof o.i})`)}}function Ww(n){const{verticalCompact:e,compactType:t}=n||{};return e===!1?null:t}const Hw=()=>{};K.noop=Hw;var en={};Object.defineProperty(en,"__esModule",{value:!0});en.calcGridColWidth=wa;en.calcGridItemPosition=Vw;en.calcGridItemWHPx=hc;en.calcWH=Gw;en.calcXY=qw;en.clamp=nr;function wa(n){const{margin:e,containerPadding:t,containerWidth:r,cols:i}=n;return(r-e[0]*(i-1)-t[0]*2)/i}function hc(n,e,t){return Number.isFinite(n)?Math.round(e*n+Math.max(0,n-1)*t):n}function Vw(n,e,t,r,i,o){const{margin:s,containerPadding:a,rowHeight:l}=n,c=wa(n),u={};return o&&o.resizing?(u.width=Math.round(o.resizing.width),u.height=Math.round(o.resizing.height)):(u.width=hc(r,c,s[0]),u.height=hc(i,l,s[1])),o&&o.dragging?(u.top=Math.round(o.dragging.top),u.left=Math.round(o.dragging.left)):o&&o.resizing&&typeof o.resizing.top=="number"&&typeof o.resizing.left=="number"?(u.top=Math.round(o.resizing.top),u.left=Math.round(o.resizing.left)):(u.top=Math.round((l+s[1])*t+a[1]),u.left=Math.round((c+s[0])*e+a[0])),u}function qw(n,e,t,r,i){const{margin:o,containerPadding:s,cols:a,rowHeight:l,maxRows:c}=n,u=wa(n);let f=Math.round((t-s[0])/(u+o[0])),d=Math.round((e-s[1])/(l+o[1]));return f=nr(f,0,a-r),d=nr(d,0,c-i),{x:f,y:d}}function Gw(n,e,t,r,i,o){const{margin:s,maxRows:a,cols:l,rowHeight:c}=n,u=wa(n);let f=Math.round((e+s[0])/(u+s[0])),d=Math.round((t+s[1])/(c+s[1])),h=nr(f,0,l-r),p=nr(d,0,a-i);return["sw","w","nw"].indexOf(o)!==-1&&(h=nr(f,0,l)),["nw","n","ne"].indexOf(o)!==-1&&(p=nr(d,0,a)),{w:h,h:p}}function nr(n,e,t){return Math.max(Math.min(n,t),e)}var va={},xa={exports:{}},Em={},xe={},tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.dontSetMe=Xw;tn.findInArray=Jw;tn.int=Yw;tn.isFunction=Uw;tn.isNum=Kw;function Jw(n,e){for(let t=0,r=n.length;t<r;t++)if(e.apply(e,[n[t],t,n]))return n[t]}function Uw(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Function]"}function Kw(n){return typeof n=="number"&&!isNaN(n)}function Yw(n){return parseInt(n,10)}function Xw(n,e,t){if(n[e])return new Error(`Invalid prop ${e} passed to ${t} - do not set this, set it on the child.`)}var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.browserPrefixToKey=Rm;Mr.browserPrefixToStyle=Qw;Mr.default=void 0;Mr.getPrefix=Tm;const rl=["Moz","Webkit","O","ms"];function Tm(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const e=window.document?.documentElement?.style;if(!e||n in e)return"";for(let t=0;t<rl.length;t++)if(Rm(n,rl[t])in e)return rl[t];return""}function Rm(n,e){return e?`${e}${Zw(n)}`:n}function Qw(n,e){return e?`-${e.toLowerCase()}-${n}`:n}function Zw(n){let e="",t=!0;for(let r=0;r<n.length;r++)t?(e+=n[r].toUpperCase(),t=!1):n[r]==="-"?t=!0:e+=n[r];return e}Mr.default=Tm();Object.defineProperty(xe,"__esModule",{value:!0});xe.addClassName=$m;xe.addEvent=tv;xe.addUserSelectStyles=dv;xe.createCSSTransform=lv;xe.createSVGTransform=cv;xe.getTouch=uv;xe.getTouchIdentifier=fv;xe.getTranslation=Du;xe.innerHeight=ov;xe.innerWidth=sv;xe.matchesSelector=Dm;xe.matchesSelectorAndParentsTo=ev;xe.offsetXYFromParent=av;xe.outerHeight=rv;xe.outerWidth=iv;xe.removeClassName=Pm;xe.removeEvent=nv;xe.scheduleRemoveUserSelectStyles=hv;var xt=tn,Zf=Am(Mr);function Am(n,e){if(typeof WeakMap=="function")var t=new WeakMap,r=new WeakMap;return(Am=function(i,o){if(!o&&i&&i.__esModule)return i;var s,a,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(s=o?r:t){if(s.has(i))return s.get(i);s.set(i,l)}for(const c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(a.get||a.set)?s(l,c,a):l[c]=i[c]);return l})(n,e)}let Jo="";function Dm(n,e){return Jo||(Jo=(0,xt.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(t){return(0,xt.isFunction)(n[t])})),(0,xt.isFunction)(n[Jo])?n[Jo](e):!1}function ev(n,e,t){let r=n;do{if(Dm(r,e))return!0;if(r===t)return!1;r=r.parentNode}while(r);return!1}function tv(n,e,t,r){if(!n)return;const i={capture:!0,...r};n.addEventListener?n.addEventListener(e,t,i):n.attachEvent?n.attachEvent("on"+e,t):n["on"+e]=t}function nv(n,e,t,r){if(!n)return;const i={capture:!0,...r};n.removeEventListener?n.removeEventListener(e,t,i):n.detachEvent?n.detachEvent("on"+e,t):n["on"+e]=null}function rv(n){let e=n.clientHeight;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e+=(0,xt.int)(t.borderTopWidth),e+=(0,xt.int)(t.borderBottomWidth),e}function iv(n){let e=n.clientWidth;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e+=(0,xt.int)(t.borderLeftWidth),e+=(0,xt.int)(t.borderRightWidth),e}function ov(n){let e=n.clientHeight;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e-=(0,xt.int)(t.paddingTop),e-=(0,xt.int)(t.paddingBottom),e}function sv(n){let e=n.clientWidth;const t=n.ownerDocument.defaultView.getComputedStyle(n);return e-=(0,xt.int)(t.paddingLeft),e-=(0,xt.int)(t.paddingRight),e}function av(n,e,t){const i=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect(),o=(n.clientX+e.scrollLeft-i.left)/t,s=(n.clientY+e.scrollTop-i.top)/t;return{x:o,y:s}}function lv(n,e){const t=Du(n,e,"px");return{[(0,Zf.browserPrefixToKey)("transform",Zf.default)]:t}}function cv(n,e){return Du(n,e,"")}function Du(n,e,t){let{x:r,y:i}=n,o=`translate(${r}${t},${i}${t})`;if(e){const s=`${typeof e.x=="string"?e.x:e.x+t}`,a=`${typeof e.y=="string"?e.y:e.y+t}`;o=`translate(${s}, ${a})`+o}return o}function uv(n,e){return n.targetTouches&&(0,xt.findInArray)(n.targetTouches,t=>e===t.identifier)||n.changedTouches&&(0,xt.findInArray)(n.changedTouches,t=>e===t.identifier)}function fv(n){if(n.targetTouches&&n.targetTouches[0])return n.targetTouches[0].identifier;if(n.changedTouches&&n.changedTouches[0])return n.changedTouches[0].identifier}function dv(n){if(!n)return;let e=n.getElementById("react-draggable-style-el");e||(e=n.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,n.getElementsByTagName("head")[0].appendChild(e)),n.body&&$m(n.body,"react-draggable-transparent-selection")}function hv(n){window.requestAnimationFrame?window.requestAnimationFrame(()=>{ed(n)}):ed(n)}function ed(n){if(n)try{if(n.body&&Pm(n.body,"react-draggable-transparent-selection"),n.selection)n.selection.empty();else{const e=(n.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function $m(n,e){n.classList?n.classList.add(e):n.className.match(new RegExp(`(?:^|\\s)${e}(?!\\S)`))||(n.className+=` ${e}`)}function Pm(n,e){n.classList?n.classList.remove(e):n.className=n.className.replace(new RegExp(`(?:^|\\s)${e}(?!\\S)`,"g"),"")}var nn={};Object.defineProperty(nn,"__esModule",{value:!0});nn.canDragX=gv;nn.canDragY=yv;nn.createCoreData=wv;nn.createDraggableData=vv;nn.getBoundPosition=pv;nn.getControlPosition=bv;nn.snapToGrid=mv;var ht=tn,Yr=xe;function pv(n,e,t){if(!n.props.bounds)return[e,t];let{bounds:r}=n.props;r=typeof r=="string"?r:xv(r);const i=$u(n);if(typeof r=="string"){const{ownerDocument:o}=i,s=o.defaultView;let a;if(r==="parent"?a=i.parentNode:a=i.getRootNode().querySelector(r),!(a instanceof s.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');const l=a,c=s.getComputedStyle(i),u=s.getComputedStyle(l);r={left:-i.offsetLeft+(0,ht.int)(u.paddingLeft)+(0,ht.int)(c.marginLeft),top:-i.offsetTop+(0,ht.int)(u.paddingTop)+(0,ht.int)(c.marginTop),right:(0,Yr.innerWidth)(l)-(0,Yr.outerWidth)(i)-i.offsetLeft+(0,ht.int)(u.paddingRight)-(0,ht.int)(c.marginRight),bottom:(0,Yr.innerHeight)(l)-(0,Yr.outerHeight)(i)-i.offsetTop+(0,ht.int)(u.paddingBottom)-(0,ht.int)(c.marginBottom)}}return(0,ht.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,ht.isNum)(r.bottom)&&(t=Math.min(t,r.bottom)),(0,ht.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,ht.isNum)(r.top)&&(t=Math.max(t,r.top)),[e,t]}function mv(n,e,t){const r=Math.round(e/n[0])*n[0],i=Math.round(t/n[1])*n[1];return[r,i]}function gv(n){return n.props.axis==="both"||n.props.axis==="x"}function yv(n){return n.props.axis==="both"||n.props.axis==="y"}function bv(n,e,t){const r=typeof e=="number"?(0,Yr.getTouch)(n,e):null;if(typeof e=="number"&&!r)return null;const i=$u(t),o=t.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,Yr.offsetXYFromParent)(r||n,o,t.props.scale)}function wv(n,e,t){const r=!(0,ht.isNum)(n.lastX),i=$u(n);return r?{node:i,deltaX:0,deltaY:0,lastX:e,lastY:t,x:e,y:t}:{node:i,deltaX:e-n.lastX,deltaY:t-n.lastY,lastX:n.lastX,lastY:n.lastY,x:e,y:t}}function vv(n,e){const t=n.props.scale;return{node:e.node,x:n.state.x+e.deltaX/t,y:n.state.y+e.deltaY/t,deltaX:e.deltaX/t,deltaY:e.deltaY/t,lastX:n.state.x,lastY:n.state.y}}function xv(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom}}function $u(n){const e=n.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var Sa={},Ca={};Object.defineProperty(Ca,"__esModule",{value:!0});Ca.default=Sv;function Sv(){}Object.defineProperty(Sa,"__esModule",{value:!0});Sa.default=void 0;var il=Nm(v),Qe=Pu(Fn),Cv=Pu(xi),_e=xe,xn=nn,ol=tn,Di=Pu(Ca);function Pu(n){return n&&n.__esModule?n:{default:n}}function Nm(n,e){if(typeof WeakMap=="function")var t=new WeakMap,r=new WeakMap;return(Nm=function(i,o){if(!o&&i&&i.__esModule)return i;var s,a,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(s=o?r:t){if(s.has(i))return s.get(i);s.set(i,l)}for(const c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(a.get||a.set)?s(l,c,a):l[c]=i[c]);return l})(n,e)}function et(n,e,t){return(e=kv(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kv(n){var e=Ov(n,"string");return typeof e=="symbol"?e:e+""}function Ov(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Pt={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Sn=Pt.mouse,ka=class extends il.Component{constructor(){super(...arguments),et(this,"dragging",!1),et(this,"lastX",NaN),et(this,"lastY",NaN),et(this,"touchIdentifier",null),et(this,"mounted",!1),et(this,"handleDragStart",e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&typeof e.button=="number"&&e.button!==0)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:r}=t;if(this.props.disabled||!(e.target instanceof r.defaultView.Node)||this.props.handle&&!(0,_e.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,_e.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;e.type==="touchstart"&&!this.props.allowMobileScroll&&e.preventDefault();const i=(0,_e.getTouchIdentifier)(e);this.touchIdentifier=i;const o=(0,xn.getControlPosition)(e,i,this);if(o==null)return;const{x:s,y:a}=o,l=(0,xn.createCoreData)(this,s,a);(0,Di.default)("DraggableCore: handleDragStart: %j",l),(0,Di.default)("calling",this.props.onStart),!(this.props.onStart(e,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,_e.addUserSelectStyles)(r),this.dragging=!0,this.lastX=s,this.lastY=a,(0,_e.addEvent)(r,Sn.move,this.handleDrag),(0,_e.addEvent)(r,Sn.stop,this.handleDragStop))}),et(this,"handleDrag",e=>{const t=(0,xn.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:r,y:i}=t;if(Array.isArray(this.props.grid)){let a=r-this.lastX,l=i-this.lastY;if([a,l]=(0,xn.snapToGrid)(this.props.grid,a,l),!a&&!l)return;r=this.lastX+a,i=this.lastY+l}const o=(0,xn.createCoreData)(this,r,i);if((0,Di.default)("DraggableCore: handleDrag: %j",o),this.props.onDrag(e,o)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=r,this.lastY=i}),et(this,"handleDragStop",e=>{if(!this.dragging)return;const t=(0,xn.getControlPosition)(e,this.touchIdentifier,this);if(t==null)return;let{x:r,y:i}=t;if(Array.isArray(this.props.grid)){let l=r-this.lastX||0,c=i-this.lastY||0;[l,c]=(0,xn.snapToGrid)(this.props.grid,l,c),r=this.lastX+l,i=this.lastY+c}const o=(0,xn.createCoreData)(this,r,i);if(this.props.onStop(e,o)===!1||this.mounted===!1)return!1;const a=this.findDOMNode();a&&this.props.enableUserSelectHack&&(0,_e.scheduleRemoveUserSelectStyles)(a.ownerDocument),(0,Di.default)("DraggableCore: handleDragStop: %j",o),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,a&&((0,Di.default)("DraggableCore: Removing handlers"),(0,_e.removeEvent)(a.ownerDocument,Sn.move,this.handleDrag),(0,_e.removeEvent)(a.ownerDocument,Sn.stop,this.handleDragStop))}),et(this,"onMouseDown",e=>(Sn=Pt.mouse,this.handleDragStart(e))),et(this,"onMouseUp",e=>(Sn=Pt.mouse,this.handleDragStop(e))),et(this,"onTouchStart",e=>(Sn=Pt.touch,this.handleDragStart(e))),et(this,"onTouchEnd",e=>(Sn=Pt.touch,this.handleDragStop(e)))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,_e.addEvent)(e,Pt.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,_e.removeEvent)(t,Pt.mouse.move,this.handleDrag),(0,_e.removeEvent)(t,Pt.touch.move,this.handleDrag),(0,_e.removeEvent)(t,Pt.mouse.stop,this.handleDragStop),(0,_e.removeEvent)(t,Pt.touch.stop,this.handleDragStop),(0,_e.removeEvent)(e,Pt.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,_e.scheduleRemoveUserSelectStyles)(t)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:Cv.default.findDOMNode(this)}render(){return il.cloneElement(il.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};Sa.default=ka;et(ka,"displayName","DraggableCore");et(ka,"propTypes",{allowAnyClick:Qe.default.bool,allowMobileScroll:Qe.default.bool,children:Qe.default.node.isRequired,disabled:Qe.default.bool,enableUserSelectHack:Qe.default.bool,offsetParent:function(n,e){if(n[e]&&n[e].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Qe.default.arrayOf(Qe.default.number),handle:Qe.default.string,cancel:Qe.default.string,nodeRef:Qe.default.object,onStart:Qe.default.func,onDrag:Qe.default.func,onStop:Qe.default.func,onMouseDown:Qe.default.func,scale:Qe.default.number,className:ol.dontSetMe,style:ol.dontSetMe,transform:ol.dontSetMe});et(ka,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),n.default=void 0;var e=f(v),t=u(Fn),r=u(xi),i=ya,o=xe,s=nn,a=tn,l=u(Sa),c=u(Ca);function u(b){return b&&b.__esModule?b:{default:b}}function f(b,x){if(typeof WeakMap=="function")var w=new WeakMap,C=new WeakMap;return(f=function(S,k){if(!k&&S&&S.__esModule)return S;var O,M,R={__proto__:null,default:S};if(S===null||typeof S!="object"&&typeof S!="function")return R;if(O=k?C:w){if(O.has(S))return O.get(S);O.set(S,R)}for(const T in S)T!=="default"&&{}.hasOwnProperty.call(S,T)&&((M=(O=Object.defineProperty)&&Object.getOwnPropertyDescriptor(S,T))&&(M.get||M.set)?O(R,T,M):R[T]=S[T]);return R})(b,x)}function d(){return d=Object.assign?Object.assign.bind():function(b){for(var x=1;x<arguments.length;x++){var w=arguments[x];for(var C in w)({}).hasOwnProperty.call(w,C)&&(b[C]=w[C])}return b},d.apply(null,arguments)}function h(b,x,w){return(x=p(x))in b?Object.defineProperty(b,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):b[x]=w,b}function p(b){var x=m(b,"string");return typeof x=="symbol"?x:x+""}function m(b,x){if(typeof b!="object"||!b)return b;var w=b[Symbol.toPrimitive];if(w!==void 0){var C=w.call(b,x);if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(b)}class g extends e.Component{static getDerivedStateFromProps(x,w){let{position:C}=x,{prevPropsPosition:S}=w;return C&&(!S||C.x!==S.x||C.y!==S.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:C,prevPropsPosition:S}),{x:C.x,y:C.y,prevPropsPosition:{...C}}):null}constructor(x){super(x),h(this,"onDragStart",(w,C)=>{if((0,c.default)("Draggable: onDragStart: %j",C),this.props.onStart(w,(0,s.createDraggableData)(this,C))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),h(this,"onDrag",(w,C)=>{if(!this.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",C);const S=(0,s.createDraggableData)(this,C),k={x:S.x,y:S.y,slackX:0,slackY:0};if(this.props.bounds){const{x:M,y:R}=k;k.x+=this.state.slackX,k.y+=this.state.slackY;const[T,P]=(0,s.getBoundPosition)(this,k.x,k.y);k.x=T,k.y=P,k.slackX=this.state.slackX+(M-k.x),k.slackY=this.state.slackY+(R-k.y),S.x=k.x,S.y=k.y,S.deltaX=k.x-this.state.x,S.deltaY=k.y-this.state.y}if(this.props.onDrag(w,S)===!1)return!1;this.setState(k)}),h(this,"onDragStop",(w,C)=>{if(!this.state.dragging||this.props.onStop(w,(0,s.createDraggableData)(this,C))===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",C);const k={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:M,y:R}=this.props.position;k.x=M,k.y=R}this.setState(k)}),this.state={dragging:!1,dragged:!1,x:x.position?x.position.x:x.defaultPosition.x,y:x.position?x.position.y:x.defaultPosition.y,prevPropsPosition:{...x.position},slackX:0,slackY:0,isElementSVG:!1},x.position&&!(x.onDrag||x.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??r.default.findDOMNode(this)}render(){const{axis:x,bounds:w,children:C,defaultPosition:S,defaultClassName:k,defaultClassNameDragging:O,defaultClassNameDragged:M,position:R,positionOffset:T,scale:P,...z}=this.props;let U={},H=null;const J=!!!R||this.state.dragging,oe=R||S,ee={x:(0,s.canDragX)(this)&&J?this.state.x:oe.x,y:(0,s.canDragY)(this)&&J?this.state.y:oe.y};this.state.isElementSVG?H=(0,o.createSVGTransform)(ee,T):U=(0,o.createCSSTransform)(ee,T);const Ce=(0,i.clsx)(C.props.className||"",k,{[O]:this.state.dragging,[M]:this.state.dragged});return e.createElement(l.default,d({},z,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(C),{className:Ce,style:{...C.props.style,...U},transform:H}))}}n.default=g,h(g,"displayName","Draggable"),h(g,"propTypes",{...l.default.propTypes,axis:t.default.oneOf(["both","x","y","none"]),bounds:t.default.oneOfType([t.default.shape({left:t.default.number,right:t.default.number,top:t.default.number,bottom:t.default.number}),t.default.string,t.default.oneOf([!1])]),defaultClassName:t.default.string,defaultClassNameDragging:t.default.string,defaultClassNameDragged:t.default.string,defaultPosition:t.default.shape({x:t.default.number,y:t.default.number}),positionOffset:t.default.shape({x:t.default.oneOfType([t.default.number,t.default.string]),y:t.default.oneOfType([t.default.number,t.default.string])}),position:t.default.shape({x:t.default.number,y:t.default.number}),className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe}),h(g,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(Em);const{default:Im,DraggableCore:Mv}=Em;xa.exports=Im;xa.exports.default=Im;xa.exports.DraggableCore=Mv;var zm=xa.exports,Oa={exports:{}},$o={},Nu={};Nu.__esModule=!0;Nu.cloneElement=$v;var Ev=Tv(v);function Tv(n){return n&&n.__esModule?n:{default:n}}function td(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function nd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?td(Object(t),!0).forEach(function(r){Rv(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):td(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Rv(n,e,t){return e=Av(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Av(n){var e=Dv(n,"string");return typeof e=="symbol"?e:String(e)}function Dv(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $v(n,e){return e.style&&n.props.style&&(e.style=nd(nd({},n.props.style),e.style)),e.className&&n.props.className&&(e.className=n.props.className+" "+e.className),Ev.default.cloneElement(n,e)}var Po={};Po.__esModule=!0;Po.resizableProps=void 0;var V=Pv(Fn);function Pv(n){return n&&n.__esModule?n:{default:n}}var Nv={axis:V.default.oneOf(["both","x","y","none"]),className:V.default.string,children:V.default.element.isRequired,draggableOpts:V.default.shape({allowAnyClick:V.default.bool,cancel:V.default.string,children:V.default.node,disabled:V.default.bool,enableUserSelectHack:V.default.bool,offsetParent:V.default.node,grid:V.default.arrayOf(V.default.number),handle:V.default.string,nodeRef:V.default.object,onStart:V.default.func,onDrag:V.default.func,onStop:V.default.func,onMouseDown:V.default.func,scale:V.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0];if(i.axis==="both"||i.axis==="y"){var o;return(o=V.default.number).isRequired.apply(o,t)}return V.default.number.apply(V.default,t)},handle:V.default.oneOfType([V.default.node,V.default.func]),handleSize:V.default.arrayOf(V.default.number),lockAspectRatio:V.default.bool,maxConstraints:V.default.arrayOf(V.default.number),minConstraints:V.default.arrayOf(V.default.number),onResizeStop:V.default.func,onResizeStart:V.default.func,onResize:V.default.func,resizeHandles:V.default.arrayOf(V.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:V.default.number,width:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t[0];if(i.axis==="both"||i.axis==="x"){var o;return(o=V.default.number).isRequired.apply(o,t)}return V.default.number.apply(V.default,t)}};Po.resizableProps=Nv;$o.__esModule=!0;$o.default=void 0;var $i=Bv(v),Iv=zm,zv=Nu,jv=Po,Lv=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function jm(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(jm=function(i){return i?t:e})(n)}function Bv(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=jm(e);if(t&&t.has(n))return t.get(n);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in n)if(o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)){var s=i?Object.getOwnPropertyDescriptor(n,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=n[o]}return r.default=n,t&&t.set(n,r),r}function pc(){return pc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pc.apply(this,arguments)}function Fv(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function rd(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function sl(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?rd(Object(t),!0).forEach(function(r){_v(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):rd(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function _v(n,e,t){return e=Wv(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wv(n){var e=Hv(n,"string");return typeof e=="symbol"?e:String(e)}function Hv(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Vv(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,mc(n,e)}function mc(n,e){return mc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},mc(n,e)}var Iu=function(n){Vv(e,n);function e(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=n.call.apply(n,[this].concat(o))||this,r.handleRefs={},r.lastHandleRect=null,r.slack=null,r}var t=e.prototype;return t.componentWillUnmount=function(){this.resetData()},t.resetData=function(){this.lastHandleRect=this.slack=null},t.runConstraints=function(i,o){var s=this.props,a=s.minConstraints,l=s.maxConstraints,c=s.lockAspectRatio;if(!a&&!l&&!c)return[i,o];if(c){var u=this.props.width/this.props.height,f=i-this.props.width,d=o-this.props.height;Math.abs(f)>Math.abs(d*u)?o=i/u:i=o*u}var h=i,p=o,m=this.slack||[0,0],g=m[0],b=m[1];return i+=g,o+=b,a&&(i=Math.max(a[0],i),o=Math.max(a[1],o)),l&&(i=Math.min(l[0],i),o=Math.min(l[1],o)),this.slack=[g+(h-i),b+(p-o)],[i,o]},t.resizeHandler=function(i,o){var s=this;return function(a,l){var c=l.node,u=l.deltaX,f=l.deltaY;i==="onResizeStart"&&s.resetData();var d=(s.props.axis==="both"||s.props.axis==="x")&&o!=="n"&&o!=="s",h=(s.props.axis==="both"||s.props.axis==="y")&&o!=="e"&&o!=="w";if(!(!d&&!h)){var p=o[0],m=o[o.length-1],g=c.getBoundingClientRect();if(s.lastHandleRect!=null){if(m==="w"){var b=g.left-s.lastHandleRect.left;u+=b}if(p==="n"){var x=g.top-s.lastHandleRect.top;f+=x}}s.lastHandleRect=g,m==="w"&&(u=-u),p==="n"&&(f=-f);var w=s.props.width+(d?u/s.props.transformScale:0),C=s.props.height+(h?f/s.props.transformScale:0),S=s.runConstraints(w,C);w=S[0],C=S[1];var k=w!==s.props.width||C!==s.props.height,O=typeof s.props[i]=="function"?s.props[i]:null,M=i==="onResize"&&!k;O&&!M&&(a.persist==null||a.persist(),O(a,{node:c,size:{width:w,height:C},handle:o})),i==="onResizeStop"&&s.resetData()}}},t.renderResizeHandle=function(i,o){var s=this.props.handle;if(!s)return $i.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+i,ref:o});if(typeof s=="function")return s(i,o);var a=typeof s.type=="string",l=sl({ref:o},a?{}:{handleAxis:i});return $i.cloneElement(s,l)},t.render=function(){var i=this,o=this.props,s=o.children,a=o.className,l=o.draggableOpts;o.width,o.height,o.handle,o.handleSize,o.lockAspectRatio,o.axis,o.minConstraints,o.maxConstraints,o.onResize,o.onResizeStop,o.onResizeStart;var c=o.resizeHandles;o.transformScale;var u=Fv(o,Lv);return(0,zv.cloneElement)(s,sl(sl({},u),{},{className:(a?a+" ":"")+"react-resizable",children:[].concat(s.props.children,c.map(function(f){var d,h=(d=i.handleRefs[f])!=null?d:i.handleRefs[f]=$i.createRef();return $i.createElement(Iv.DraggableCore,pc({},l,{nodeRef:h,key:"resizableHandle-"+f,onStop:i.resizeHandler("onResizeStop",f),onStart:i.resizeHandler("onResizeStart",f),onDrag:i.resizeHandler("onResize",f)}),i.renderResizeHandle(f,h))}))}))},e}($i.Component);$o.default=Iu;Iu.propTypes=jv.resizableProps;Iu.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1};var Ma={};Ma.__esModule=!0;Ma.default=void 0;var al=Kv(v),qv=Lm(Fn),Gv=Lm($o),Jv=Po,Uv=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function Lm(n){return n&&n.__esModule?n:{default:n}}function Bm(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Bm=function(i){return i?t:e})(n)}function Kv(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=Bm(e);if(t&&t.has(n))return t.get(n);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in n)if(o!=="default"&&Object.prototype.hasOwnProperty.call(n,o)){var s=i?Object.getOwnPropertyDescriptor(n,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=n[o]}return r.default=n,t&&t.set(n,r),r}function gc(){return gc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},gc.apply(this,arguments)}function id(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function zs(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?id(Object(t),!0).forEach(function(r){Yv(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):id(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Yv(n,e,t){return e=Xv(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Xv(n){var e=Qv(n,"string");return typeof e=="symbol"?e:String(e)}function Qv(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Zv(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function ex(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,yc(n,e)}function yc(n,e){return yc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},yc(n,e)}var Fm=function(n){ex(e,n);function e(){for(var r,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r=n.call.apply(n,[this].concat(o))||this,r.state={width:r.props.width,height:r.props.height,propsWidth:r.props.width,propsHeight:r.props.height},r.onResize=function(a,l){var c=l.size;r.props.onResize?(a.persist==null||a.persist(),r.setState(c,function(){return r.props.onResize&&r.props.onResize(a,l)})):r.setState(c)},r}e.getDerivedStateFromProps=function(i,o){return o.propsWidth!==i.width||o.propsHeight!==i.height?{width:i.width,height:i.height,propsWidth:i.width,propsHeight:i.height}:null};var t=e.prototype;return t.render=function(){var i=this.props,o=i.handle,s=i.handleSize;i.onResize;var a=i.onResizeStart,l=i.onResizeStop,c=i.draggableOpts,u=i.minConstraints,f=i.maxConstraints,d=i.lockAspectRatio,h=i.axis;i.width,i.height;var p=i.resizeHandles,m=i.style,g=i.transformScale,b=Zv(i,Uv);return al.createElement(Gv.default,{axis:h,draggableOpts:c,handle:o,handleSize:s,height:this.state.height,lockAspectRatio:d,maxConstraints:f,minConstraints:u,onResizeStart:a,onResize:this.onResize,onResizeStop:l,resizeHandles:p,transformScale:g,width:this.state.width},al.createElement("div",gc({},b,{style:zs(zs({},m),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},e}(al.Component);Ma.default=Fm;Fm.propTypes=zs(zs({},Jv.resizableProps),{},{children:qv.default.element});Oa.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};Oa.exports.Resizable=$o.default;Oa.exports.ResizableBox=Ma.default;var tx=Oa.exports,pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.resizeHandleType=pn.resizeHandleAxesType=pn.default=void 0;var q=_m(Fn),nx=_m(v);function _m(n){return n&&n.__esModule?n:{default:n}}const rx=pn.resizeHandleAxesType=q.default.arrayOf(q.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),ix=pn.resizeHandleType=q.default.oneOfType([q.default.node,q.default.func]);pn.default={className:q.default.string,style:q.default.object,width:q.default.number,autoSize:q.default.bool,cols:q.default.number,draggableCancel:q.default.string,draggableHandle:q.default.string,verticalCompact:function(n){n.verticalCompact===!1&&console.warn('`verticalCompact` on <ReactGridLayout> is deprecated and will be removed soon. Use `compactType`: "horizontal" | "vertical" | null.')},compactType:q.default.oneOf(["vertical","horizontal"]),layout:function(n){var e=n.layout;e!==void 0&&K.validateLayout(e,"layout")},margin:q.default.arrayOf(q.default.number),containerPadding:q.default.arrayOf(q.default.number),rowHeight:q.default.number,maxRows:q.default.number,isBounded:q.default.bool,isDraggable:q.default.bool,isResizable:q.default.bool,allowOverlap:q.default.bool,preventCollision:q.default.bool,useCSSTransforms:q.default.bool,transformScale:q.default.number,isDroppable:q.default.bool,resizeHandles:rx,resizeHandle:ix,onLayoutChange:q.default.func,onDragStart:q.default.func,onDrag:q.default.func,onDragStop:q.default.func,onResizeStart:q.default.func,onResize:q.default.func,onResizeStop:q.default.func,onDrop:q.default.func,droppingItem:q.default.shape({i:q.default.string.isRequired,w:q.default.number.isRequired,h:q.default.number.isRequired}),children:function(n,e){const t=n[e],r={};nx.default.Children.forEach(t,function(i){if(i?.key!=null){if(r[i.key])throw new Error('Duplicate child key "'+i.key+'" found! This will cause problems in ReactGridLayout.');r[i.key]=!0}})},innerRef:q.default.any};Object.defineProperty(va,"__esModule",{value:!0});va.default=void 0;var zr=zu(v),od=xi,te=zu(Fn),ox=zm,sx=tx,jr=K,ze=en,sd=pn,ax=zu(ya);function zu(n){return n&&n.__esModule?n:{default:n}}function Gt(n,e,t){return(e=lx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lx(n){var e=cx(n,"string");return typeof e=="symbol"?e:e+""}function cx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class ju extends zr.default.Component{constructor(){super(...arguments),Gt(this,"state",{resizing:null,dragging:null,className:""}),Gt(this,"elementRef",zr.default.createRef()),Gt(this,"onDragStart",(e,t)=>{let{node:r}=t;const{onDragStart:i,transformScale:o}=this.props;if(!i)return;const s={top:0,left:0},{offsetParent:a}=r;if(!a)return;const l=a.getBoundingClientRect(),c=r.getBoundingClientRect(),u=c.left/o,f=l.left/o,d=c.top/o,h=l.top/o;s.left=u-f+a.scrollLeft,s.top=d-h+a.scrollTop,this.setState({dragging:s});const{x:p,y:m}=(0,ze.calcXY)(this.getPositionParams(),s.top,s.left,this.props.w,this.props.h);return i.call(this,this.props.i,p,m,{e,node:r,newPosition:s})}),Gt(this,"onDrag",(e,t,r)=>{let{node:i,deltaX:o,deltaY:s}=t;const{onDrag:a}=this.props;if(!a)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let l=this.state.dragging.top+s,c=this.state.dragging.left+o;const{isBounded:u,i:f,w:d,h,containerWidth:p}=this.props,m=this.getPositionParams();if(u){const{offsetParent:w}=i;if(w){const{margin:C,rowHeight:S}=this.props,k=w.clientHeight-(0,ze.calcGridItemWHPx)(h,S,C[1]);l=(0,ze.clamp)(l,0,k);const O=(0,ze.calcGridColWidth)(m),M=p-(0,ze.calcGridItemWHPx)(d,O,C[0]);c=(0,ze.clamp)(c,0,M)}}const g={top:l,left:c};r?this.setState({dragging:g}):(0,od.flushSync)(()=>{this.setState({dragging:g})});const{x:b,y:x}=(0,ze.calcXY)(m,l,c,d,h);return a.call(this,f,b,x,{e,node:i,newPosition:g})}),Gt(this,"onDragStop",(e,t)=>{let{node:r}=t;const{onDragStop:i}=this.props;if(!i)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");const{w:o,h:s,i:a}=this.props,{left:l,top:c}=this.state.dragging,u={top:c,left:l};this.setState({dragging:null});const{x:f,y:d}=(0,ze.calcXY)(this.getPositionParams(),c,l,o,s);return i.call(this,a,f,d,{e,node:r,newPosition:u})}),Gt(this,"onResizeStop",(e,t,r)=>this.onResizeHandler(e,t,r,"onResizeStop")),Gt(this,"onResizeStart",(e,t,r)=>this.onResizeHandler(e,t,r,"onResizeStart")),Gt(this,"onResize",(e,t,r)=>this.onResizeHandler(e,t,r,"onResize"))}shouldComponentUpdate(e,t){if(this.props.children!==e.children||this.props.droppingPosition!==e.droppingPosition)return!0;const r=(0,ze.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),i=(0,ze.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,jr.fastPositionEqual)(r,i)||this.props.useCSSTransforms!==e.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(e){this.moveDroppingItem(e)}moveDroppingItem(e){const{droppingPosition:t}=this.props;if(!t)return;const r=this.elementRef.current;if(!r)return;const i=e.droppingPosition||{left:0,top:0},{dragging:o}=this.state,s=o&&t.left!==i.left||t.top!==i.top;if(!o)this.onDragStart(t.e,{node:r,deltaX:t.left,deltaY:t.top});else if(s){const a=t.left-o.left,l=t.top-o.top;this.onDrag(t.e,{node:r,deltaX:a,deltaY:l},!0)}}getPositionParams(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}createStyle(e){const{usePercentages:t,containerWidth:r,useCSSTransforms:i}=this.props;let o;return i?o=(0,jr.setTransform)(e):(o=(0,jr.setTopLeft)(e),t&&(o.left=(0,jr.perc)(e.left/r),o.width=(0,jr.perc)(e.width/r))),o}mixinDraggable(e,t){return zr.default.createElement(ox.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}curryResizeHandler(e,t){return(r,i)=>t(r,i,e)}mixinResizable(e,t,r){const{cols:i,minW:o,minH:s,maxW:a,maxH:l,transformScale:c,resizeHandles:u,resizeHandle:f}=this.props,d=this.getPositionParams(),h=(0,ze.calcGridItemPosition)(d,0,0,i,0).width,p=(0,ze.calcGridItemPosition)(d,0,0,o,s),m=(0,ze.calcGridItemPosition)(d,0,0,a,l),g=[p.width,p.height],b=[Math.min(m.width,h),Math.min(m.height,1/0)];return zr.default.createElement(sx.Resizable,{draggableOpts:{disabled:!r},className:r?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:g,maxConstraints:b,onResizeStop:this.curryResizeHandler(t,this.onResizeStop),onResizeStart:this.curryResizeHandler(t,this.onResizeStart),onResize:this.curryResizeHandler(t,this.onResize),transformScale:c,resizeHandles:u,handle:f},e)}onResizeHandler(e,t,r,i){let{node:o,size:s,handle:a}=t;const l=this.props[i];if(!l)return;const{x:c,y:u,i:f,maxH:d,minH:h,containerWidth:p}=this.props,{minW:m,maxW:g}=this.props;let b=s;o&&(b=(0,jr.resizeItemInDirection)(a,r,s,p),(0,od.flushSync)(()=>{this.setState({resizing:i==="onResizeStop"?null:b})}));let{w:x,h:w}=(0,ze.calcWH)(this.getPositionParams(),b.width,b.height,c,u,a);x=(0,ze.clamp)(x,Math.max(m,1),g),w=(0,ze.clamp)(w,h,d),l.call(this,f,x,w,{e,node:o,size:b,handle:a})}render(){const{x:e,y:t,w:r,h:i,isDraggable:o,isResizable:s,droppingPosition:a,useCSSTransforms:l}=this.props,c=(0,ze.calcGridItemPosition)(this.getPositionParams(),e,t,r,i,this.state),u=zr.default.Children.only(this.props.children);let f=zr.default.cloneElement(u,{ref:this.elementRef,className:(0,ax.default)("react-grid-item",u.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":o,"react-draggable-dragging":!!this.state.dragging,dropping:!!a,cssTransforms:l}),style:{...this.props.style,...u.props.style,...this.createStyle(c)}});return f=this.mixinResizable(f,c,s),f=this.mixinDraggable(f,o),f}}va.default=ju;Gt(ju,"propTypes",{children:te.default.element,cols:te.default.number.isRequired,containerWidth:te.default.number.isRequired,rowHeight:te.default.number.isRequired,margin:te.default.array.isRequired,maxRows:te.default.number.isRequired,containerPadding:te.default.array.isRequired,x:te.default.number.isRequired,y:te.default.number.isRequired,w:te.default.number.isRequired,h:te.default.number.isRequired,minW:function(n,e){const t=n[e];if(typeof t!="number")return new Error("minWidth not Number");if(t>n.w||t>n.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(n,e){const t=n[e];if(typeof t!="number")return new Error("maxWidth not Number");if(t<n.w||t<n.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(n,e){const t=n[e];if(typeof t!="number")return new Error("minHeight not Number");if(t>n.h||t>n.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(n,e){const t=n[e];if(typeof t!="number")return new Error("maxHeight not Number");if(t<n.h||t<n.minH)return new Error("maxHeight smaller than item height/minHeight")},i:te.default.string.isRequired,resizeHandles:sd.resizeHandleAxesType,resizeHandle:sd.resizeHandleType,onDragStop:te.default.func,onDragStart:te.default.func,onDrag:te.default.func,onResizeStop:te.default.func,onResizeStart:te.default.func,onResize:te.default.func,isDraggable:te.default.bool.isRequired,isResizable:te.default.bool.isRequired,isBounded:te.default.bool.isRequired,static:te.default.bool,useCSSTransforms:te.default.bool.isRequired,transformScale:te.default.number,className:te.default.string,handle:te.default.string,cancel:te.default.string,droppingPosition:te.default.shape({e:te.default.object.isRequired,left:te.default.number.isRequired,top:te.default.number.isRequired})});Gt(ju,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1});Object.defineProperty(Do,"__esModule",{value:!0});Do.default=void 0;var Jn=Wm(v),ll=xu,ux=Lu(ya),W=K,fx=en,ad=Lu(va),dx=Lu(pn);function Lu(n){return n&&n.__esModule?n:{default:n}}function Wm(n,e){if(typeof WeakMap=="function")var t=new WeakMap,r=new WeakMap;return(Wm=function(i,o){if(!o&&i&&i.__esModule)return i;var s,a,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(s=o?r:t){if(s.has(i))return s.get(i);s.set(i,l)}for(const c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(a.get||a.set)?s(l,c,a):l[c]=i[c]);return l})(n,e)}function We(n,e,t){return(e=hx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function hx(n){var e=px(n,"string");return typeof e=="symbol"?e:e+""}function px(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const ld="react-grid-layout";let Hm=!1;try{Hm=/firefox/i.test(navigator.userAgent)}catch{}let Ea=class extends Jn.Component{constructor(){super(...arguments),We(this,"state",{activeDrag:null,layout:(0,W.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,W.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),We(this,"dragEnterCounter",0),We(this,"onDragStart",(e,t,r,i)=>{let{e:o,node:s}=i;const{layout:a}=this.state,l=(0,W.getLayoutItem)(a,e);if(!l)return;const c={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:e};return this.setState({oldDragItem:(0,W.cloneLayoutItem)(l),oldLayout:a,activeDrag:c}),this.props.onDragStart(a,l,l,null,o,s)}),We(this,"onDrag",(e,t,r,i)=>{let{e:o,node:s}=i;const{oldDragItem:a}=this.state;let{layout:l}=this.state;const{cols:c,allowOverlap:u,preventCollision:f}=this.props,d=(0,W.getLayoutItem)(l,e);if(!d)return;const h={w:d.w,h:d.h,x:d.x,y:d.y,placeholder:!0,i:e};l=(0,W.moveElement)(l,d,t,r,!0,f,(0,W.compactType)(this.props),c,u),this.props.onDrag(l,a,d,h,o,s),this.setState({layout:u?l:(0,W.compact)(l,(0,W.compactType)(this.props),c),activeDrag:h})}),We(this,"onDragStop",(e,t,r,i)=>{let{e:o,node:s}=i;if(!this.state.activeDrag)return;const{oldDragItem:a}=this.state;let{layout:l}=this.state;const{cols:c,preventCollision:u,allowOverlap:f}=this.props,d=(0,W.getLayoutItem)(l,e);if(!d)return;l=(0,W.moveElement)(l,d,t,r,!0,u,(0,W.compactType)(this.props),c,f);const p=f?l:(0,W.compact)(l,(0,W.compactType)(this.props),c);this.props.onDragStop(p,a,d,null,o,s);const{oldLayout:m}=this.state;this.setState({activeDrag:null,layout:p,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(p,m)}),We(this,"onResizeStart",(e,t,r,i)=>{let{e:o,node:s}=i;const{layout:a}=this.state,l=(0,W.getLayoutItem)(a,e);l&&(this.setState({oldResizeItem:(0,W.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(a,l,l,null,o,s))}),We(this,"onResize",(e,t,r,i)=>{let{e:o,node:s,size:a,handle:l}=i;const{oldResizeItem:c}=this.state,{layout:u}=this.state,{cols:f,preventCollision:d,allowOverlap:h}=this.props;let p=!1,m,g,b;const[x,w]=(0,W.withLayoutItem)(u,e,S=>{let k;return g=S.x,b=S.y,["sw","w","nw","n","ne"].indexOf(l)!==-1&&(["sw","nw","w"].indexOf(l)!==-1&&(g=S.x+(S.w-t),t=S.x!==g&&g<0?S.w:t,g=g<0?0:g),["ne","n","nw"].indexOf(l)!==-1&&(b=S.y+(S.h-r),r=S.y!==b&&b<0?S.h:r,b=b<0?0:b),p=!0),d&&!h&&(k=(0,W.getAllCollisions)(u,{...S,w:t,h:r,x:g,y:b}).filter(M=>M.i!==S.i).length>0,k&&(b=S.y,r=S.h,g=S.x,t=S.w,p=!1)),S.w=t,S.h=r,S});if(!w)return;m=x,p&&(m=(0,W.moveElement)(x,w,g,b,!0,this.props.preventCollision,(0,W.compactType)(this.props),f,h));const C={w:w.w,h:w.h,x:w.x,y:w.y,static:!0,i:e};this.props.onResize(m,c,w,C,o,s),this.setState({layout:h?m:(0,W.compact)(m,(0,W.compactType)(this.props),f),activeDrag:C})}),We(this,"onResizeStop",(e,t,r,i)=>{let{e:o,node:s}=i;const{layout:a,oldResizeItem:l}=this.state,{cols:c,allowOverlap:u}=this.props,f=(0,W.getLayoutItem)(a,e),d=u?a:(0,W.compact)(a,(0,W.compactType)(this.props),c);this.props.onResizeStop(d,l,f,null,o,s);const{oldLayout:h}=this.state;this.setState({activeDrag:null,layout:d,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(d,h)}),We(this,"onDragOver",e=>{if(e.preventDefault(),e.stopPropagation(),Hm&&!e.nativeEvent.target?.classList.contains(ld))return!1;const{droppingItem:t,onDropDragOver:r,margin:i,cols:o,rowHeight:s,maxRows:a,width:l,containerPadding:c,transformScale:u}=this.props,f=r?.(e);if(f===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;const d={...t,...f},{layout:h}=this.state,p=e.currentTarget.getBoundingClientRect(),m=e.clientX-p.left,g=e.clientY-p.top,b={left:m/u,top:g/u,e};if(this.state.droppingDOMNode){if(this.state.droppingPosition){const{left:x,top:w}=this.state.droppingPosition;(x!=m||w!=g)&&this.setState({droppingPosition:b})}}else{const x={cols:o,margin:i,maxRows:a,rowHeight:s,containerWidth:l,containerPadding:c||i},w=(0,fx.calcXY)(x,g,m,d.w,d.h);this.setState({droppingDOMNode:Jn.createElement("div",{key:d.i}),droppingPosition:b,layout:[...h,{...d,x:w.x,y:w.y,static:!1,isDraggable:!0}]})}}),We(this,"removeDroppingPlaceholder",()=>{const{droppingItem:e,cols:t}=this.props,{layout:r}=this.state,i=(0,W.compact)(r.filter(o=>o.i!==e.i),(0,W.compactType)(this.props),t,this.props.allowOverlap);this.setState({layout:i,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),We(this,"onDragLeave",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),We(this,"onDragEnter",e=>{e.preventDefault(),e.stopPropagation(),this.dragEnterCounter++}),We(this,"onDrop",e=>{e.preventDefault(),e.stopPropagation();const{droppingItem:t}=this.props,{layout:r}=this.state,i=r.find(o=>o.i===t.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(r,i,e)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(e,t){let r;return t.activeDrag?null:(!(0,ll.deepEqual)(e.layout,t.propsLayout)||e.compactType!==t.compactType?r=e.layout:(0,W.childrenEqual)(e.children,t.children)||(r=t.layout),r?{layout:(0,W.synchronizeLayoutWithChildren)(r,e.children,e.cols,(0,W.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}shouldComponentUpdate(e,t){return this.props.children!==e.children||!(0,W.fastRGLPropsEqual)(this.props,e,ll.deepEqual)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}componentDidUpdate(e,t){if(!this.state.activeDrag){const r=this.state.layout,i=t.layout;this.onLayoutMaybeChanged(r,i)}}containerHeight(){if(!this.props.autoSize)return;const e=(0,W.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+t*2+"px"}onLayoutMaybeChanged(e,t){t||(t=this.state.layout),(0,ll.deepEqual)(t,e)||this.props.onLayoutChange(e)}placeholder(){const{activeDrag:e}=this.state;if(!e)return null;const{width:t,cols:r,margin:i,containerPadding:o,rowHeight:s,maxRows:a,useCSSTransforms:l,transformScale:c}=this.props;return Jn.createElement(ad.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:t,cols:r,margin:i,containerPadding:o||i,maxRows:a,rowHeight:s,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:l,transformScale:c},Jn.createElement("div",null))}processGridItem(e,t){if(!e||!e.key)return;const r=(0,W.getLayoutItem)(this.state.layout,String(e.key));if(!r)return null;const{width:i,cols:o,margin:s,containerPadding:a,rowHeight:l,maxRows:c,isDraggable:u,isResizable:f,isBounded:d,useCSSTransforms:h,transformScale:p,draggableCancel:m,draggableHandle:g,resizeHandles:b,resizeHandle:x}=this.props,{mounted:w,droppingPosition:C}=this.state,S=typeof r.isDraggable=="boolean"?r.isDraggable:!r.static&&u,k=typeof r.isResizable=="boolean"?r.isResizable:!r.static&&f,O=r.resizeHandles||b,M=S&&d&&r.isBounded!==!1;return Jn.createElement(ad.default,{containerWidth:i,cols:o,margin:s,containerPadding:a||s,maxRows:c,rowHeight:l,cancel:m,handle:g,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:S,isResizable:k,isBounded:M,useCSSTransforms:h&&w,usePercentages:!w,transformScale:p,w:r.w,h:r.h,x:r.x,y:r.y,i:r.i,minH:r.minH,minW:r.minW,maxH:r.maxH,maxW:r.maxW,static:r.static,droppingPosition:t?C:void 0,resizeHandles:O,resizeHandle:x},e)}render(){const{className:e,style:t,isDroppable:r,innerRef:i}=this.props,o=(0,ux.default)(ld,e),s={height:this.containerHeight(),...t};return Jn.createElement("div",{ref:i,className:o,style:s,onDrop:r?this.onDrop:W.noop,onDragLeave:r?this.onDragLeave:W.noop,onDragEnter:r?this.onDragEnter:W.noop,onDragOver:r?this.onDragOver:W.noop},Jn.Children.map(this.props.children,a=>this.processGridItem(a)),r&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}};Do.default=Ea;We(Ea,"displayName","ReactGridLayout");We(Ea,"propTypes",dx.default);We(Ea,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:W.noop,onDragStart:W.noop,onDrag:W.noop,onDragStop:W.noop,onResizeStart:W.noop,onResize:W.noop,onResizeStop:W.noop,onDrop:W.noop,onDropDragOver:W.noop});var Ta={},Er={};Object.defineProperty(Er,"__esModule",{value:!0});Er.findOrGenerateResponsiveLayout=yx;Er.getBreakpointFromWidth=mx;Er.getColsFromBreakpoint=gx;Er.sortBreakpoints=Bu;var Uo=K;function mx(n,e){const t=Bu(n);let r=t[0];for(let i=1,o=t.length;i<o;i++){const s=t[i];e>n[s]&&(r=s)}return r}function gx(n,e){if(!e[n])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+n+" is missing!");return e[n]}function yx(n,e,t,r,i,o){if(n[t])return(0,Uo.cloneLayout)(n[t]);let s=n[r];const a=Bu(e),l=a.slice(a.indexOf(t));for(let c=0,u=l.length;c<u;c++){const f=l[c];if(n[f]){s=n[f];break}}return s=(0,Uo.cloneLayout)(s||[]),(0,Uo.compact)((0,Uo.correctBounds)(s,{cols:i}),o,i)}function Bu(n){return Object.keys(n).sort(function(t,r){return n[t]-n[r]})}Object.defineProperty(Ta,"__esModule",{value:!0});Ta.default=void 0;var cd=qm(v),at=Vm(Fn),cl=xu,ei=K,Un=Er,bx=Vm(Do);function Vm(n){return n&&n.__esModule?n:{default:n}}function qm(n,e){if(typeof WeakMap=="function")var t=new WeakMap,r=new WeakMap;return(qm=function(i,o){if(!o&&i&&i.__esModule)return i;var s,a,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(s=o?r:t){if(s.has(i))return s.get(i);s.set(i,l)}for(const c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(a.get||a.set)?s(l,c,a):l[c]=i[c]);return l})(n,e)}function bc(){return bc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},bc.apply(null,arguments)}function js(n,e,t){return(e=wx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wx(n){var e=vx(n,"string");return typeof e=="symbol"?e:e+""}function vx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const ud=n=>Object.prototype.toString.call(n);function Ko(n,e){return n==null?null:Array.isArray(n)?n:n[e]}class Fu extends cd.Component{constructor(){super(...arguments),js(this,"state",this.generateInitialState()),js(this,"onLayoutChange",e=>{this.props.onLayoutChange(e,{...this.props.layouts,[this.state.breakpoint]:e})})}generateInitialState(){const{width:e,breakpoints:t,layouts:r,cols:i}=this.props,o=(0,Un.getBreakpointFromWidth)(t,e),s=(0,Un.getColsFromBreakpoint)(o,i),a=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,Un.findOrGenerateResponsiveLayout)(r,t,o,o,s,a),breakpoint:o,cols:s}}static getDerivedStateFromProps(e,t){if(!(0,cl.deepEqual)(e.layouts,t.layouts)){const{breakpoint:r,cols:i}=t;return{layout:(0,Un.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,r,r,i,e.compactType),layouts:e.layouts}}return null}componentDidUpdate(e){(this.props.width!=e.width||this.props.breakpoint!==e.breakpoint||!(0,cl.deepEqual)(this.props.breakpoints,e.breakpoints)||!(0,cl.deepEqual)(this.props.cols,e.cols))&&this.onWidthChange(e)}onWidthChange(e){const{breakpoints:t,cols:r,layouts:i,compactType:o}=this.props,s=this.props.breakpoint||(0,Un.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),a=this.state.breakpoint,l=(0,Un.getColsFromBreakpoint)(s,r),c={...i};if(a!==s||e.breakpoints!==t||e.cols!==r){a in c||(c[a]=(0,ei.cloneLayout)(this.state.layout));let d=(0,Un.findOrGenerateResponsiveLayout)(c,t,s,a,l,o);d=(0,ei.synchronizeLayoutWithChildren)(d,this.props.children,l,o,this.props.allowOverlap),c[s]=d,this.props.onBreakpointChange(s,l),this.props.onLayoutChange(d,c),this.setState({breakpoint:s,layout:d,cols:l})}const u=Ko(this.props.margin,s),f=Ko(this.props.containerPadding,s);this.props.onWidthChange(this.props.width,u,l,f)}render(){const{breakpoint:e,breakpoints:t,cols:r,layouts:i,margin:o,containerPadding:s,onBreakpointChange:a,onLayoutChange:l,onWidthChange:c,...u}=this.props;return cd.createElement(bx.default,bc({},u,{margin:Ko(o,this.state.breakpoint),containerPadding:Ko(s,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}Ta.default=Fu;js(Fu,"propTypes",{breakpoint:at.default.string,breakpoints:at.default.object,allowOverlap:at.default.bool,cols:at.default.object,margin:at.default.oneOfType([at.default.array,at.default.object]),containerPadding:at.default.oneOfType([at.default.array,at.default.object]),layouts(n,e){if(ud(n[e])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+ud(n[e]));Object.keys(n[e]).forEach(t=>{if(!(t in n.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,ei.validateLayout)(n.layouts[t],"layouts."+t)})},width:at.default.number.isRequired,onBreakpointChange:at.default.func,onLayoutChange:at.default.func,onWidthChange:at.default.func});js(Fu,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:ei.noop,onLayoutChange:ei.noop,onWidthChange:ei.noop});var _u={},Gm=function(){if(typeof Map<"u")return Map;function n(e,t){var r=-1;return e.some(function(i,o){return i[0]===t?(r=o,!0):!1}),r}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t){var r=n(this.__entries__,t),i=this.__entries__[r];return i&&i[1]},e.prototype.set=function(t,r){var i=n(this.__entries__,t);~i?this.__entries__[i][1]=r:this.__entries__.push([t,r])},e.prototype.delete=function(t){var r=this.__entries__,i=n(r,t);~i&&r.splice(i,1)},e.prototype.has=function(t){return!!~n(this.__entries__,t)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,r){r===void 0&&(r=null);for(var i=0,o=this.__entries__;i<o.length;i++){var s=o[i];t.call(r,s[1],s[0])}},e}()}(),wc=typeof window<"u"&&typeof document<"u"&&window.document===document,Ls=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),xx=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(Ls):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),Sx=2;function Cx(n,e){var t=!1,r=!1,i=0;function o(){t&&(t=!1,n()),r&&a()}function s(){xx(o)}function a(){var l=Date.now();if(t){if(l-i<Sx)return;r=!0}else t=!0,r=!1,setTimeout(s,e);i=l}return a}var kx=20,Ox=["top","right","bottom","left","width","height","size","weight"],Mx=typeof MutationObserver<"u",Ex=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Cx(this.refresh.bind(this),kx)}return n.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},n.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var e=this.updateObservers_();e&&this.refresh()},n.prototype.updateObservers_=function(){var e=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return e.forEach(function(t){return t.broadcastActive()}),e.length>0},n.prototype.connect_=function(){!wc||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Mx?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!wc||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=t===void 0?"":t,i=Ox.some(function(o){return!!~r.indexOf(o)});i&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),Jm=function(n,e){for(var t=0,r=Object.keys(e);t<r.length;t++){var i=r[t];Object.defineProperty(n,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return n},li=function(n){var e=n&&n.ownerDocument&&n.ownerDocument.defaultView;return e||Ls},Um=Ra(0,0,0,0);function Bs(n){return parseFloat(n)||0}function fd(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return e.reduce(function(r,i){var o=n["border-"+i+"-width"];return r+Bs(o)},0)}function Tx(n){for(var e=["top","right","bottom","left"],t={},r=0,i=e;r<i.length;r++){var o=i[r],s=n["padding-"+o];t[o]=Bs(s)}return t}function Rx(n){var e=n.getBBox();return Ra(0,0,e.width,e.height)}function Ax(n){var e=n.clientWidth,t=n.clientHeight;if(!e&&!t)return Um;var r=li(n).getComputedStyle(n),i=Tx(r),o=i.left+i.right,s=i.top+i.bottom,a=Bs(r.width),l=Bs(r.height);if(r.boxSizing==="border-box"&&(Math.round(a+o)!==e&&(a-=fd(r,"left","right")+o),Math.round(l+s)!==t&&(l-=fd(r,"top","bottom")+s)),!$x(n)){var c=Math.round(a+o)-e,u=Math.round(l+s)-t;Math.abs(c)!==1&&(a-=c),Math.abs(u)!==1&&(l-=u)}return Ra(i.left,i.top,a,l)}var Dx=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof li(n).SVGGraphicsElement}:function(n){return n instanceof li(n).SVGElement&&typeof n.getBBox=="function"}}();function $x(n){return n===li(n).document.documentElement}function Px(n){return wc?Dx(n)?Rx(n):Ax(n):Um}function Nx(n){var e=n.x,t=n.y,r=n.width,i=n.height,o=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,s=Object.create(o.prototype);return Jm(s,{x:e,y:t,width:r,height:i,top:t,right:e+r,bottom:i+t,left:e}),s}function Ra(n,e,t,r){return{x:n,y:e,width:t,height:r}}var Ix=function(){function n(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Ra(0,0,0,0),this.target=e}return n.prototype.isActive=function(){var e=Px(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},n}(),zx=function(){function n(e,t){var r=Nx(t);Jm(this,{target:e,contentRect:r})}return n}(),jx=function(){function n(e,t,r){if(this.activeObservations_=[],this.observations_=new Gm,typeof e!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=r}return n.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof li(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Ix(e)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(e instanceof li(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(r){return new zx(r.target,r.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),Km=typeof WeakMap<"u"?new WeakMap:new Gm,Ym=function(){function n(e){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=Ex.getInstance(),r=new jx(e,t,this);Km.set(this,r)}return n}();["observe","unobserve","disconnect"].forEach(function(n){Ym.prototype[n]=function(){var e;return(e=Km.get(this))[n].apply(e,arguments)}});var Lx=function(){return typeof Ls.ResizeObserver<"u"?Ls.ResizeObserver:Ym}();const Bx=Object.freeze(Object.defineProperty({__proto__:null,default:Lx},Symbol.toStringTag,{value:"Module"})),Fx=ew(Bx);Object.defineProperty(_u,"__esModule",{value:!0});_u.default=Jx;var Yo=Xm(v),_x=Wu(Fn),Wx=Wu(Fx),Hx=Wu(ya);function Wu(n){return n&&n.__esModule?n:{default:n}}function Xm(n,e){if(typeof WeakMap=="function")var t=new WeakMap,r=new WeakMap;return(Xm=function(i,o){if(!o&&i&&i.__esModule)return i;var s,a,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(s=o?r:t){if(s.has(i))return s.get(i);s.set(i,l)}for(const c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((a=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(a.get||a.set)?s(l,c,a):l[c]=i[c]);return l})(n,e)}function vc(){return vc=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},vc.apply(null,arguments)}function Lr(n,e,t){return(e=Vx(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Vx(n){var e=qx(n,"string");return typeof e=="symbol"?e:e+""}function qx(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Gx="react-grid-layout";function Jx(n){var e;return e=class extends Yo.Component{constructor(){super(...arguments),Lr(this,"state",{width:1280}),Lr(this,"elementRef",Yo.createRef()),Lr(this,"mounted",!1),Lr(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new Wx.default(i=>{if(this.elementRef.current instanceof HTMLElement){const s=i[0].contentRect.width;this.setState({width:s})}});const r=this.elementRef.current;r instanceof HTMLElement&&this.resizeObserver.observe(r)}componentWillUnmount(){this.mounted=!1;const r=this.elementRef.current;r instanceof HTMLElement&&this.resizeObserver.unobserve(r),this.resizeObserver.disconnect()}render(){const{measureBeforeMount:r,...i}=this.props;return r&&!this.mounted?Yo.createElement("div",{className:(0,Hx.default)(this.props.className,Gx),style:this.props.style,ref:this.elementRef}):Yo.createElement(n,vc({innerRef:this.elementRef},i,this.state))}},Lr(e,"defaultProps",{measureBeforeMount:!1}),Lr(e,"propTypes",{measureBeforeMount:_x.default.bool}),e}(function(n){n.exports=Do.default,n.exports.utils=K,n.exports.calculateUtils=en,n.exports.Responsive=Ta.default,n.exports.Responsive.utils=Er,n.exports.WidthProvider=_u.default})(hm);var Ux=hm.exports;const Kx=tw(Ux),Qm=6048e5,Yx=864e5,dd=Symbol.for("constructDateFrom");function zn(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&dd in n?n[dd](e):n instanceof Date?new n.constructor(e):new Date(e)}function Wt(n,e){return zn(e||n,n)}let Xx={};function Aa(){return Xx}function uo(n,e){const t=Aa(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=Wt(n,e?.in),o=i.getDay(),s=(o<r?7:0)+o-r;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function Fs(n,e){return uo(n,{...e,weekStartsOn:1})}function Zm(n,e){const t=Wt(n,e?.in),r=t.getFullYear(),i=zn(t,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const o=Fs(i),s=zn(t,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const a=Fs(s);return t.getTime()>=o.getTime()?r+1:t.getTime()>=a.getTime()?r:r-1}function hd(n){const e=Wt(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Qx(n,...e){const t=zn.bind(null,e.find(r=>typeof r=="object"));return e.map(t)}function pd(n,e){const t=Wt(n,e?.in);return t.setHours(0,0,0,0),t}function Zx(n,e,t){const[r,i]=Qx(t?.in,n,e),o=pd(r),s=pd(i),a=+o-hd(o),l=+s-hd(s);return Math.round((a-l)/Yx)}function eS(n,e){const t=Zm(n,e),r=zn(n,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Fs(r)}function tS(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function nS(n){return!(!tS(n)&&typeof n!="number"||isNaN(+Wt(n)))}function rS(n,e){const t=Wt(n,e?.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}const iS={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},oS=(n,e,t)=>{let r;const i=iS[n];return typeof i=="string"?r=i:e===1?r=i.one:r=i.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function ul(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const sS={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},aS={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lS={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},cS={date:ul({formats:sS,defaultWidth:"full"}),time:ul({formats:aS,defaultWidth:"full"}),dateTime:ul({formats:lS,defaultWidth:"full"})},uS={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},fS=(n,e,t,r)=>uS[n];function Pi(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let i;if(r==="formatting"&&n.formattingValues){const s=n.defaultFormattingWidth||n.defaultWidth,a=t?.width?String(t.width):s;i=n.formattingValues[a]||n.formattingValues[s]}else{const s=n.defaultWidth,a=t?.width?String(t.width):n.defaultWidth;i=n.values[a]||n.values[s]}const o=n.argumentCallback?n.argumentCallback(e):e;return i[o]}}const dS={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},hS={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},pS={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},mS={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},gS={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},yS={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bS=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},wS={ordinalNumber:bS,era:Pi({values:dS,defaultWidth:"wide"}),quarter:Pi({values:hS,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Pi({values:pS,defaultWidth:"wide"}),day:Pi({values:mS,defaultWidth:"wide"}),dayPeriod:Pi({values:gS,defaultWidth:"wide",formattingValues:yS,defaultFormattingWidth:"wide"})};function Ni(n){return(e,t={})=>{const r=t.width,i=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],o=e.match(i);if(!o)return null;const s=o[0],a=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(a)?xS(a,f=>f.test(s)):vS(a,f=>f.test(s));let c;c=n.valueCallback?n.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;const u=e.slice(s.length);return{value:c,rest:u}}}function vS(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function xS(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function SS(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const i=r[0],o=e.match(n.parsePattern);if(!o)return null;let s=n.valueCallback?n.valueCallback(o[0]):o[0];s=t.valueCallback?t.valueCallback(s):s;const a=e.slice(i.length);return{value:s,rest:a}}}const CS=/^(\d+)(th|st|nd|rd)?/i,kS=/\d+/i,OS={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},MS={any:[/^b/i,/^(a|c)/i]},ES={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},TS={any:[/1/i,/2/i,/3/i,/4/i]},RS={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},AS={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DS={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},$S={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},PS={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},NS={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},IS={ordinalNumber:SS({matchPattern:CS,parsePattern:kS,valueCallback:n=>parseInt(n,10)}),era:Ni({matchPatterns:OS,defaultMatchWidth:"wide",parsePatterns:MS,defaultParseWidth:"any"}),quarter:Ni({matchPatterns:ES,defaultMatchWidth:"wide",parsePatterns:TS,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Ni({matchPatterns:RS,defaultMatchWidth:"wide",parsePatterns:AS,defaultParseWidth:"any"}),day:Ni({matchPatterns:DS,defaultMatchWidth:"wide",parsePatterns:$S,defaultParseWidth:"any"}),dayPeriod:Ni({matchPatterns:PS,defaultMatchWidth:"any",parsePatterns:NS,defaultParseWidth:"any"})},zS={code:"en-US",formatDistance:oS,formatLong:cS,formatRelative:fS,localize:wS,match:IS,options:{weekStartsOn:0,firstWeekContainsDate:1}};function jS(n,e){const t=Wt(n,e?.in);return Zx(t,rS(t))+1}function LS(n,e){const t=Wt(n,e?.in),r=+Fs(t)-+eS(t);return Math.round(r/Qm)+1}function eg(n,e){const t=Wt(n,e?.in),r=t.getFullYear(),i=Aa(),o=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=zn(e?.in||n,0);s.setFullYear(r+1,0,o),s.setHours(0,0,0,0);const a=uo(s,e),l=zn(e?.in||n,0);l.setFullYear(r,0,o),l.setHours(0,0,0,0);const c=uo(l,e);return+t>=+a?r+1:+t>=+c?r:r-1}function BS(n,e){const t=Aa(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,i=eg(n,e),o=zn(e?.in||n,0);return o.setFullYear(i,0,r),o.setHours(0,0,0,0),uo(o,e)}function FS(n,e){const t=Wt(n,e?.in),r=+uo(t,e)-+BS(t,e);return Math.round(r/Qm)+1}function re(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const Cn={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return re(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):re(t+1,2)},d(n,e){return re(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return re(n.getHours()%12||12,e.length)},H(n,e){return re(n.getHours(),e.length)},m(n,e){return re(n.getMinutes(),e.length)},s(n,e){return re(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),i=Math.trunc(r*Math.pow(10,t-3));return re(i,e.length)}},Br={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},md={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),i=r>0?r:1-r;return t.ordinalNumber(i,{unit:"year"})}return Cn.y(n,e)},Y:function(n,e,t,r){const i=eg(n,r),o=i>0?i:1-i;if(e==="YY"){const s=o%100;return re(s,2)}return e==="Yo"?t.ordinalNumber(o,{unit:"year"}):re(o,e.length)},R:function(n,e){const t=Zm(n);return re(t,e.length)},u:function(n,e){const t=n.getFullYear();return re(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return re(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return re(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return Cn.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return re(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const i=FS(n,r);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):re(i,e.length)},I:function(n,e,t){const r=LS(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):re(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Cn.d(n,e)},D:function(n,e,t){const r=jS(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):re(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const i=n.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return re(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const i=n.getDay(),o=(i-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return re(o,e.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),i=r===0?7:r;switch(e){case"i":return String(i);case"ii":return re(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let i;switch(r===12?i=Br.noon:r===0?i=Br.midnight:i=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let i;switch(r>=17?i=Br.evening:r>=12?i=Br.afternoon:r>=4?i=Br.morning:i=Br.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Cn.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Cn.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):re(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):re(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Cn.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Cn.s(n,e)},S:function(n,e){return Cn.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return yd(r);case"XXXX":case"XX":return Kn(r);case"XXXXX":case"XXX":default:return Kn(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return yd(r);case"xxxx":case"xx":return Kn(r);case"xxxxx":case"xxx":default:return Kn(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+gd(r,":");case"OOOO":default:return"GMT"+Kn(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+gd(r,":");case"zzzz":default:return"GMT"+Kn(r,":")}},t:function(n,e,t){const r=Math.trunc(+n/1e3);return re(r,e.length)},T:function(n,e,t){return re(+n,e.length)}};function gd(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),i=Math.trunc(r/60),o=r%60;return o===0?t+String(i):t+String(i)+e+re(o,2)}function yd(n,e){return n%60===0?(n>0?"-":"+")+re(Math.abs(n)/60,2):Kn(n,e)}function Kn(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),i=re(Math.trunc(r/60),2),o=re(r%60,2);return t+i+e+o}const bd=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},tg=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},_S=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],i=t[2];if(!i)return bd(n,e);let o;switch(r){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",bd(r,e)).replace("{{time}}",tg(i,e))},WS={p:tg,P:_S},HS=/^D+$/,VS=/^Y+$/,qS=["D","DD","YY","YYYY"];function GS(n){return HS.test(n)}function JS(n){return VS.test(n)}function US(n,e,t){const r=KS(n,e,t);if(console.warn(r),qS.includes(n))throw new RangeError(r)}function KS(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const YS=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,XS=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,QS=/^'([^]*?)'?$/,ZS=/''/g,e1=/[a-zA-Z]/;function wd(n,e,t){const r=Aa(),i=r.locale??zS,o=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=Wt(n,t?.in);if(!nS(a))throw new RangeError("Invalid time value");let l=e.match(XS).map(u=>{const f=u[0];if(f==="p"||f==="P"){const d=WS[f];return d(u,i.formatLong)}return u}).join("").match(YS).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const f=u[0];if(f==="'")return{isToken:!1,value:t1(u)};if(md[f])return{isToken:!0,value:u};if(f.match(e1))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:u}});i.localize.preprocessor&&(l=i.localize.preprocessor(a,l));const c={firstWeekContainsDate:o,weekStartsOn:s,locale:i};return l.map(u=>{if(!u.isToken)return u.value;const f=u.value;(JS(f)||GS(f))&&US(f,e,String(n));const d=md[f[0]];return d(a,f,i.localize,c)}).join("")}function t1(n){const e=n.match(QS);return e?e[1].replace(ZS,"'"):n}function je(n){this.content=n}je.prototype={constructor:je,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new je(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new je(t)},addToStart:function(n,e){return new je([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new je(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new je(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=je.from(n),n.size?new je(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=je.from(n),n.size?new je(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=je.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};je.from=function(n){if(n instanceof je)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new je(e)};function ng(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=ng(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function rg(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let c=rg(s.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}let E=class Ze{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,a=0;a<t;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new Ze(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),i+=a.nodeSize),s=l}return new Ze(r,i)}cutByIndex(e,t){return e==t?Ze.empty:e==0&&t==this.content.length?this:new Ze(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new Ze(i,o)}addToStart(e){return new Ze([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Ze(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return ng(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return rg(this,e,t,r)}findIndex(e){if(e==0)return Xo(0,e);if(e==this.size)return Xo(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,r=0;;t++){let i=this.child(t),o=r+i.nodeSize;if(o>=e)return o==e?Xo(t+1,o):Xo(t,r);r=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Ze.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Ze(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Ze.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new Ze(t||e,r)}static from(e){if(!e)return Ze.empty;if(e instanceof Ze)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Ze([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}};E.empty=new E([],0);const fl={index:0,offset:0};function Xo(n,e){return fl.index=n,fl.offset=e,fl}function _s(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!_s(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!_s(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let ae=class xc{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&_s(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return xc.none;if(e instanceof xc)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};ae.none=[];let Ws=class extends Error{},D=class Vr{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=og(this.content,e+this.openStart,t);return r&&new Vr(r,this.openStart,this.openEnd)}removeBetween(e,t){return new Vr(ig(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return Vr.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new Vr(E.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new Vr(e,r,i)}};D.empty=new D(E.empty,0,0);function ig(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(i==e||o.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(ig(o.content,e-i-1,t-i-1)))}function og(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let a=og(s.content,e-o-1,t,s);return a&&n.replaceChild(i,s.copy(a))}function n1(n,e,t){if(t.openStart>n.depth)throw new Ws("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Ws("Inconsistent open depths");return sg(n,e,t,0)}function sg(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=sg(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return dr(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=r1(t,n);return dr(o,lg(n,s,a,e,r))}else return dr(o,Hs(n,e,r))}function ag(n,e){if(!e.type.compatibleContent(n.type))throw new Ws("Cannot join "+e.type.name+" onto "+n.type.name)}function Sc(n,e,t){let r=n.node(t);return ag(r,e.node(t)),r}function fr(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Xi(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(fr(n.nodeAfter,r),o++));for(let a=o;a<s;a++)fr(i.child(a),r);e&&e.depth==t&&e.textOffset&&fr(e.nodeBefore,r)}function dr(n,e){return n.type.checkContent(e),n.copy(e)}function lg(n,e,t,r,i){let o=n.depth>i&&Sc(n,e,i+1),s=r.depth>i&&Sc(t,r,i+1),a=[];return Xi(null,n,i,a),o&&s&&e.index(i)==t.index(i)?(ag(o,s),fr(dr(o,lg(n,e,t,r,i+1)),a)):(o&&fr(dr(o,Hs(n,e,i+1)),a),Xi(e,t,i,a),s&&fr(dr(s,Hs(t,r,i+1)),a)),Xi(r,null,i,a),new E(a)}function Hs(n,e,t){let r=[];if(Xi(null,n,t,r),n.depth>t){let i=Sc(n,e,t+1);fr(dr(i,Hs(n,e,t+1)),r)}return Xi(e,null,t,r),new E(r)}function r1(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(E.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}let vd=class Cc{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return ae.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Vs(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new Cc(t,r,o)}static resolveCached(e,t){let r=xd.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else xd.set(e,r=new i1);let i=r.elts[r.i]=Cc.resolve(e,t);return r.i=(r.i+1)%o1,i}},i1=class{constructor(){this.elts=[],this.i=0}};const o1=12,xd=new WeakMap;let Vs=class{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}};const s1=Object.create(null);let Dn=class kc{constructor(e,t,r,i=ae.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||E.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&_s(this.attrs,t||e.defaultAttrs||s1)&&ae.sameSet(this.marks,r||ae.none)}copy(e=null){return e==this.content?this:new kc(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new kc(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return D.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new D(c,i.depth-s,o.depth-s)}replace(e,t,r){return n1(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return vd.resolveCached(this,e)}resolveNoCache(e){return vd.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),cg(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=E.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ae.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!ae.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=E.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};Dn.prototype.text=void 0;let a1=class Oc extends Dn{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):cg(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Oc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Oc(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}};function cg(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}let fo=class ug{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new l1(e,t);if(r.next==null)return ug.empty;let i=fg(r);r.next&&r.err("Unexpected trailing text");let o=m1(p1(i));return g1(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return E.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:f}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let d=o(f,a.concat(u));if(d)return d}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}};fo.empty=new fo(!0);let l1=class{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}};function fg(n){let e=[];do e.push(c1(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function c1(n){let e=[];do e.push(u1(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function u1(n){let e=h1(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=f1(n,e);else break;return e}function Sd(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function f1(n,e){let t=Sd(n),r=t;return n.eat(",")&&(n.next!="}"?r=Sd(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function d1(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function h1(n){if(n.eat("(")){let e=fg(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=d1(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function p1(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=t())}else if(s.type=="star"){let l=t();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=t();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=t();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function dg(n,e){return e-n}function Cd(n,e){let t=[];return r(e),t.sort(dg);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&t.indexOf(l)==-1&&r(l)}}}function m1(n){let e=Object.create(null);return t(Cd(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Cd(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new fo(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(dg);o.next.push({type:i[s][0],next:e[a.join(",")]||t(a)})}return o}}function g1(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function hg(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function pg(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function mg(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function gg(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new b1(n,r,e[r]);return t}let kd=class yg{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=gg(e,r.attrs),this.defaultAttrs=hg(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==fo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:pg(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Dn(this,this.computeAttrs(e),E.from(t),ae.setFrom(r))}createChecked(e=null,t,r){return t=E.from(t),this.checkContent(t),new Dn(this,this.computeAttrs(e),t,ae.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=E.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(E.empty,!0);return o?new Dn(this,e,t.append(o),ae.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){mg(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:ae.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new yg(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function y1(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}let b1=class{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?y1(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}},bg=class wg{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=gg(e,i.attrs),this.excluded=null;let o=hg(this.attrs);this.instance=o?new ae(this,o):null}create(e=null){return!e&&this.instance?this.instance:new ae(this,pg(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new wg(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){mg(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}},vg=class{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=je.from(e.nodes),t.marks=je.from(e.marks||{}),this.nodes=kd.compile(this.spec.nodes,this),this.marks=bg.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=fo.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Od(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Od(this,s.split(" "))}this.nodeFromJSON=i=>Dn.fromJSON(this,i),this.markFromJSON=i=>ae.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof kd){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new a1(r,r.defaultAttrs,e,ae.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}};function Od(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function w1(n){return n.tag!=null}function v1(n){return n.style!=null}let Qi=class Mc{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(w1(i))this.tags.push(i);else if(v1(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new Ed(this,t,!1);return r.addAll(e,ae.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Ed(this,t,!0);return r.addAll(e,ae.none,t.from,t.to),D.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(C1(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Td(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Td(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Mc(e,Mc.schemaRules(e)))}};const xg={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},x1={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Sg={ol:!0,ul:!0},ho=1,Ec=2,Zi=4;function Md(n,e,t){return e!=null?(e?ho:0)|(e==="full"?Ec:0):n&&n.whitespace=="pre"?ho|Ec:t&~Zi}let Qo=class{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=ae.none,this.match=o||(s&Zi?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(E.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ho)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=E.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(E.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!xg.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}},Ed=class{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,s=Md(null,t.preserveWhitespace,0)|(r?Zi:0);i?o=new Qo(i.type,i.attrs,ae.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new Qo(null,null,ae.none,!0,null,s):o=new Qo(e.schema.topNodeType,null,ae.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,o=i.options&Ec?"full":this.localPreserveWS||(i.options&ho)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;Sg.hasOwnProperty(s)&&this.parser.normalizeLists&&S1(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:x1.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(xg.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let f=l&&l.skip?t:this.readStyles(e,t);f&&this.addAll(e,f),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(s,t.attrs||null,r,t.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t,r){let i,o;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(e);if(c&&(!i||i.length>c.length+a)&&(i=c,o=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!i)return null;this.sync(o);for(let s=0;s<i.length;s++)t=this.enterInner(i[s],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let o=this.textblockFromContext();o&&(t=this.enterInner(o,null,t))}let i=this.findPlace(e,t,r);if(i){this.closeExtra();let o=this.top;o.match&&(o.match=o.match.matchType(e.type));let s=ae.none;for(let a of i.concat(e.marks))(o.type?o.type.allowsMarkType(a.type):Rd(a.type,e.type))&&(s=a.addToSet(s));return o.content.push(e.mark(s)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r,!1);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Md(e,o,s.options);s.options&Zi&&s.content.length==0&&(a|=Zi);let l=ae.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Rd(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Qo(e,t,l,i,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=ho)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}};function S1(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Sg.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function C1(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Td(n){let e={};for(let t in n)e[t]=n[t];return e}function Rd(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class Tr{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=dl(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,t);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=ws(dl(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&ws(dl(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return ws(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Tr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Ad(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Ad(e.marks)}}function Ad(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function dl(n){return n.document||window.document}const Dd=new WeakMap;function k1(n){let e=Dd.get(n);return e===void 0&&Dd.set(n,e=O1(n)),e}function O1(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function ws(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=k1(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));let a,l=t?n.createElementNS(t,i):n.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let f in c)if(c[f]!=null){let d=f.indexOf(" ");d>0?l.setAttributeNS(f.slice(0,d),f.slice(d+1),c[f]):f=="style"&&l.style?l.style.cssText=c[f]:l.setAttribute(f,c[f])}}for(let f=u;f<e.length;f++){let d=e[f];if(d===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:h,contentDOM:p}=ws(n,d,t,r);if(l.appendChild(h),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const Cg=65535,kg=Math.pow(2,16);function M1(n,e){return n+e*kg}function $d(n){return n&Cg}function E1(n){return(n-(n&Cg))/kg}const Og=1,Mg=2,vs=4,Eg=8;let Tc=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Eg)>0}get deletedBefore(){return(this.delInfo&(Og|vs))>0}get deletedAfter(){return(this.delInfo&(Mg|vs))>0}get deletedAcross(){return(this.delInfo&vs)>0}},vr=class qr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&qr.empty)return qr.empty}recover(e){let t=0,r=$d(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+E1(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],f=l+c;if(e<=f){let d=c?e==l?-1:e==f?1:t:t,h=l+i+(d<0?0:u);if(r)return h;let p=e==(t<0?l:f)?null:M1(a/3,e-l),m=e==l?Mg:e==f?Og:vs;return(t<0?e!=l:e!=f)&&(m|=Eg),new Tc(h,m,p)}i+=u-c}return r?e+i:new Tc(e+i,0,null)}touches(e,t){let r=0,i=$d(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new qr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?qr.empty:new qr(e<0?[0,-e,0]:[0,0,e])}};vr.empty=new vr([]);class po{constructor(e,t,r=0,i=e?e.length:0){this.mirror=t,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new po(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new po;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Tc(e,i,null)}}const hl=Object.create(null);let Ye=class{getMap(){return vr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=hl[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in hl)throw new RangeError("Duplicate use of step JSON ID "+e);return hl[e]=t,t.prototype.jsonID=e,t}},nt=class Fi{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Fi(e,null)}static fail(e){return new Fi(null,e)}static fromReplace(e,t,r,i){try{return Fi.ok(e.replace(t,r,i))}catch(o){if(o instanceof Ws)return Fi.fail(o.message);throw o}}};function Hu(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Hu(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return E.fromArray(r)}let Vu=class _i extends Ye{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new D(Hu(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return nt.fromReplace(e,this.from,this.to,o)}invert(){return new No(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new _i(t.pos,r.pos,this.mark)}merge(e){return e instanceof _i&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new _i(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new _i(t.from,t.to,e.markFromJSON(t.mark))}};Ye.jsonID("addMark",Vu);let No=class Wi extends Ye{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new D(Hu(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return nt.fromReplace(e,this.from,this.to,r)}invert(){return new Vu(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Wi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Wi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Wi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Wi(t.from,t.to,e.markFromJSON(t.mark))}};Ye.jsonID("removeMark",No);let qu=class Hi extends Ye{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return nt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return nt.fromReplace(e,this.pos,this.pos+1,new D(E.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Hi(this.pos,t.marks[i]);return new Hi(this.pos,this.mark)}}return new qs(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Hi(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Hi(t.pos,e.markFromJSON(t.mark))}};Ye.jsonID("addNodeMark",qu);let qs=class Rc extends Ye{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return nt.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return nt.fromReplace(e,this.pos,this.pos+1,new D(E.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new qu(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Rc(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Rc(t.pos,e.markFromJSON(t.mark))}};Ye.jsonID("removeNodeMark",qs);let Lt=class Yn extends Ye{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Ac(e,this.from,this.to)?nt.fail("Structure replace would overwrite content"):nt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new vr([this.from,this.to-this.from,this.slice.size])}invert(e){return new Yn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Yn(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Yn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?D.empty:new D(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Yn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?D.empty:new D(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Yn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Yn(t.from,t.to,D.fromJSON(e,t.slice),!!t.structure)}};Ye.jsonID("replace",Lt);let ft=class xs extends Ye{constructor(e,t,r,i,o,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(Ac(e,this.from,this.gapFrom)||Ac(e,this.gapTo,this.to)))return nt.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return nt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?nt.fromReplace(e,this.from,this.to,r):nt.fail("Content does not fit in gap")}getMap(){return new vr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new xs(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new xs(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new xs(t.from,t.to,t.gapFrom,t.gapTo,D.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ye.jsonID("replaceAround",ft);function Ac(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function T1(n,e,t,r){let i=[],o=[],s,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&u.type.allowsMarkType(r.type)){let d=Math.max(c,e),h=Math.min(c+l.nodeSize,t),p=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(p)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=h:i.push(s=new No(d,h,f[m])));a&&a.to==d?a.to=h:o.push(a=new Vu(d,h,r))}}),i.forEach(l=>n.step(l)),o.forEach(l=>n.step(l))}function R1(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof bg){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,t);for(let u=0;u<l.length;u++){let f=l[u],d;for(let h=0;h<i.length;h++){let p=i[h];p.step==o-1&&f.eq(i[h].style)&&(d=p)}d?(d.to=c,d.step=o):i.push({style:f,from:Math.max(a,e),to:c,step:o})}}}),i.forEach(s=>n.step(new No(s.from,s.to,s.style)))}function Gu(n,e,t,r=t.contentMatch,i=!0){let o=n.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,f=r.matchType(c.type);if(!f)s.push(new Lt(a,u,D.empty));else{r=f;for(let d=0;d<c.marks.length;d++)t.allowsMarkType(c.marks[d].type)||n.step(new No(a,u,c.marks[d]));if(i&&c.isText&&t.whitespace!="pre"){let d,h=/\r?\n|\r/g,p;for(;d=h.exec(c.text);)p||(p=new D(E.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),s.push(new Lt(a+d.index,a+d.index+d[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(E.empty,!0);n.replace(a,a,new D(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function A1(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Si(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!A1(i,o,s))break}return null}function D1(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,c=a,u=E.empty,f=0;for(let p=o,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=E.from(r.node(p).copy(u)),f++):l--;let d=E.empty,h=0;for(let p=o,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,d=E.from(i.node(p).copy(d)),h++):c++;n.step(new ft(l,c,s,a,new D(u.append(d),f,h),u.size-f,!0))}function Ju(n,e,t=null,r=n){let i=$1(n,e),o=i&&P1(r,e);return o?i.map(Pd).concat({type:e,attrs:t}).concat(o.map(Pd)):null}function Pd(n){return{type:n,attrs:null}}function $1(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function P1(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:s}function N1(n,e,t){let r=E.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=E.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new ft(i,o,i,o,new D(r,0,0),t.length,!0))}function I1(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&z1(n.doc,n.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let h=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);h&&!p?c=!1:!h&&p&&(c=!0)}c===!1&&Rg(n,s,a,o),Gu(n,n.mapping.slice(o).map(a,1),r,void 0,c===null);let u=n.mapping.slice(o),f=u.map(a,1),d=u.map(a+s.nodeSize,1);return n.step(new ft(f,d,f+1,d-1,new D(E.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&Tg(n,s,a,o),!1}})}function Tg(n,e,t,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=n.mapping.slice(r).map(t+1+o+s.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Rg(n,e,t,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=n.mapping.slice(r).map(t+1+o);n.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function z1(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function j1(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new ft(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new D(E.from(s),0,0),1,!0))}function mn(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>o;c--,u--){let f=i.node(c),d=i.index(c);if(f.type.spec.isolating)return!1;let h=f.content.cutByIndex(d,f.childCount),p=r&&r[u+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||f;if(!f.canReplace(d+1,f.childCount)||!m.type.validContent(h))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function L1(n,e,t=1,r){let i=n.doc.resolve(e),o=E.empty,s=E.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){o=E.from(i.node(a).copy(o));let u=r&&r[c];s=E.from(u?u.type.create(u.attrs,s):i.node(a).copy(s))}n.step(new Lt(e,e,new D(o.append(s),t,t),!0))}function _n(n,e){let t=n.resolve(e),r=t.index();return Ag(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function B1(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?n.type.schema.nodes.text:o.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(o.marks))return!1}return t.validEnd}function Ag(n,e){return!!(n&&e&&!n.isLeaf&&B1(n,e))}function Da(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):t>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&Ag(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function F1(n,e,t){let r=null,{linebreakReplacement:i}=n.doc.type.schema,o=n.doc.resolve(e-t),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",f=!!s.contentMatch.matchType(i);u&&!f?r=!1:!u&&f&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);Rg(n,u.node(),u.before(),a)}s.inlineContent&&Gu(n,e+t-1,s,o.node().contentMatchAt(o.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new Lt(c,l.map(e+t,-1),D.empty,!0)),r===!0){let u=n.doc.resolve(c);Tg(n,u.node(),u.before(),n.steps.length)}return n}function _1(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function Dg(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(l,l,i);else{let f=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=f&&c.canReplaceWith(l,l,f[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function $a(n,e,t=e,r=D.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return $g(i,o,r)?new Lt(e,t,r):new W1(i,o,r).fit()}function $g(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let W1=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=E.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=E.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new D(o,s,a);return e>-1?new ft(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new Lt(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=pl(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,f=null;if(t==1&&(s?c.matchType(s.type)||(f=c.fillBefore(E.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:f};if(t==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=pl(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new D(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=pl(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new D(Vi(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new D(Vi(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));f=f.matchFragment(i)}let h=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),g=f.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(f=g,u.push(Pg(m.mark(d.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?h:-1)))}let p=c==a.childCount;p||(h=-1),this.placed=qi(this.placed,t,E.from(u)),this.frontier[t].match=f,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<h;m++){let b=g.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),g=b.content}this.unplaced=p?e==0?D.empty:new D(Vi(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new D(Vi(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!ml(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=ml(e,t,i,r,o);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=ml(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=qi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=qi(this.placed,this.depth,E.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(E.empty,!0);t.childCount&&(this.placed=qi(this.placed,this.frontier.length,t))}};function Vi(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Vi(n.firstChild.content,e-1,t)))}function qi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(qi(n.lastChild.content,e-1,t)))}function pl(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Pg(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Pg(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(E.empty,!0)))),n.copy(r)}function ml(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!H1(t,o.content,s)?a:null}function H1(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function V1(n){return n.spec.defining||n.spec.definingForContent}function q1(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if($g(i,o,r))return n.step(new Lt(e,t,r));let s=Ig(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let d=i.depth,h=i.pos-1;d>0;d--,h--){let p=i.node(d).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;s.indexOf(d)>-1?a=d:i.before(d)==h&&s.splice(1,0,-d)}let l=s.indexOf(a),c=[],u=r.openStart;for(let d=r.content,h=0;;h++){let p=d.firstChild;if(c.push(p),h==r.openStart)break;d=p.content}for(let d=u-1;d>=0;d--){let h=c[d],p=V1(h.type);if(p&&!h.sameMarkup(i.node(Math.abs(a)-1)))u=d;else if(p||!h.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let h=(d+u+1)%(r.openStart+1),p=c[h];if(p)for(let m=0;m<s.length;m++){let g=s[(m+l)%s.length],b=!0;g<0&&(b=!1,g=-g);let x=i.node(g-1),w=i.index(g-1);if(x.canReplaceWith(w,w,p.type,p.marks))return n.replace(i.before(g),b?o.after(g):t,new D(Ng(r.content,0,r.openStart,h),h,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let h=s[d];h<0||(e=i.before(h),t=o.after(h))}}function Ng(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(Ng(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(E.empty,!0))}return n}function G1(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=_1(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new D(E.from(r),0,0))}function J1(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=Ig(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return n.delete(r.before(s),t);n.delete(e,t)}function Ig(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}let zg=class Ss extends Ye{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return nt.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return nt.fromReplace(e,this.pos,this.pos+1,new D(E.from(i),0,t.isLeaf?0:1))}getMap(){return vr.empty}invert(e){return new Ss(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ss(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ss(t.pos,t.attr,t.value)}};Ye.jsonID("attr",zg);let jg=class Dc extends Ye{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return nt.ok(r)}getMap(){return vr.empty}invert(e){return new Dc(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Dc(t.attr,t.value)}};Ye.jsonID("docAttr",jg);let ci=class extends Error{};ci=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};ci.prototype=Object.create(Error.prototype);ci.prototype.constructor=ci;ci.prototype.name="TransformError";class Lg{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new po}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new ci(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=D.empty){let i=$a(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new D(E.from(r),0,0))}delete(e,t){return this.replace(e,t,D.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return q1(this,e,t,r),this}replaceRangeWith(e,t,r){return G1(this,e,t,r),this}deleteRange(e,t){return J1(this,e,t),this}lift(e,t){return D1(this,e,t),this}join(e,t=1){return F1(this,e,t),this}wrap(e,t){return N1(this,e,t),this}setBlockType(e,t=e,r,i=null){return I1(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return j1(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new zg(e,t,r)),this}setDocAttribute(e,t){return this.step(new jg(e,t)),this}addNodeMark(e,t){return this.step(new qu(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof ae)t.isInSet(r.marks)&&this.step(new qs(e,t));else{let i=r.marks,o,s=[];for(;o=t.isInSet(i);)s.push(new qs(e,o)),i=o.removeFromSet(i);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(e,t=1,r){return L1(this,e,t,r),this}addMark(e,t,r){return T1(this,e,t,r),this}removeMark(e,t,r){return R1(this,e,t,r),this}clearIncompatible(e,t,r){return Gu(this,e,t,r),this}}const gl=Object.create(null);let B=class{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new Bg(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=D.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?D.empty:t),a==0&&zd(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),zd(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new F(e):Gr(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?Gr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Gr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new gn(e.node(0))}static atStart(e){return Gr(e,e,0,0,1)||new gn(e)}static atEnd(e){return Gr(e,e,e.content.size,e.childCount,-1)||new gn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=gl[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in gl)throw new RangeError("Duplicate use of selection JSON ID "+e);return gl[e]=t,t.prototype.jsonID=e,t}getBookmark(){return F.between(this.$anchor,this.$head).getBookmark()}};B.prototype.visible=!0;let Bg=class{constructor(e,t){this.$from=e,this.$to=t}},Nd=!1;function Id(n){!Nd&&!n.parent.inlineContent&&(Nd=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}let F=class Gi extends B{constructor(e,t=e){Id(e),Id(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return B.near(r);let i=e.resolve(t.map(this.anchor));return new Gi(i.parent.inlineContent?i:r,r)}replace(e,t=D.empty){if(super.replace(e,t),t==D.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Gi&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Fg(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Gi(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=B.findFrom(t,r,!0)||B.findFrom(t,-r,!0);if(o)t=o.$head;else return B.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(B.findFrom(e,-r,!0)||B.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new Gi(e,t)}};B.jsonID("text",F);let Fg=class _g{constructor(e,t){this.anchor=e,this.head=t}map(e){return new _g(e.map(this.anchor),e.map(this.head))}resolve(e){return F.between(e.resolve(this.anchor),e.resolve(this.head))}},j=class Ji extends B{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?B.near(o):new Ji(o)}content(){return new D(E.from(this.node),0,0)}eq(e){return e instanceof Ji&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new U1(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Ji(e.resolve(t.anchor))}static create(e,t){return new Ji(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}};j.prototype.visible=!1;B.jsonID("node",j);let U1=class Wg{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Fg(r,r):new Wg(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&j.isSelectable(r)?new j(t):B.near(t)}},gn=class Cs extends B{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=D.empty){if(t==D.empty){e.delete(0,e.doc.content.size);let r=B.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Cs(e)}map(e){return new Cs(e)}eq(e){return e instanceof Cs}getBookmark(){return K1}};B.jsonID("all",gn);const K1={map(){return this},resolve(n){return new gn(n)}};function Gr(n,e,t,r,i,o=!1){if(e.inlineContent)return F.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&j.isSelectable(a))return j.create(n,t-(i<0?a.nodeSize:0))}else{let l=Gr(n,a,t+i,i<0?a.childCount:0,i,o);if(l)return l}t+=a.nodeSize*i}return null}function zd(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof Lt||i instanceof ft))return;let o=n.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),n.setSelection(B.near(n.doc.resolve(s),t))}const jd=1,Zo=2,Ld=4;class Y1 extends Lg{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|jd)&~Zo,this.storedMarks=null,this}get selectionSet(){return(this.updated&jd)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Zo,this}ensureMarks(e){return ae.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Zo)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Zo,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||ae.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(B.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Ld,this}get scrolledIntoView(){return(this.updated&Ld)>0}}function Bd(n,e){return!e||!n?n:n.bind(e)}let Ui=class{constructor(e,t,r){this.name=e,this.init=Bd(t.init,r),this.apply=Bd(t.apply,r)}};const X1=[new Ui("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Ui("selection",{init(n,e){return n.selection||B.atStart(e.doc)},apply(n){return n.selection}}),new Ui("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Ui("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class yl{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=X1.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Ui(r.key,r.spec.state,r))})}}class Xr{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Xr(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new Y1(this)}static create(e){let t=new yl(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Xr(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new yl(this.schema,e.plugins),r=t.fields,i=new Xr(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new yl(e.schema,e.plugins),o=new Xr(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Dn.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=B.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){o[s.name]=c.fromJSON.call(l,e,t[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function Hg(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=Hg(i,e,{})),t[r]=i}return t}let Fe=class{constructor(e){this.spec=e,this.props={},e.props&&Hg(e.props,this,this.props),this.key=e.key?e.key.key:Vg("plugin")}getState(e){return e[this.key]}};const bl=Object.create(null);function Vg(n){return n in bl?n+"$"+ ++bl[n]:(bl[n]=0,n+"$")}let dt=class{constructor(e="key"){this.key=Vg(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}};const Be=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ui=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let $c=null;const ln=function(n,e,t){let r=$c||($c=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},Q1=function(){$c=null},xr=function(n,e,t,r){return t&&(Fd(n,e,t,r,-1)||Fd(n,e,t,r,1))},Z1=/^(img|br|input|textarea|hr)$/i;function Fd(n,e,t,r,i){for(var o;;){if(n==t&&e==r)return!0;if(e==(i<0?0:At(n))){let s=n.parentNode;if(!s||s.nodeType!=1||Io(n)||Z1.test(n.nodeName)||n.contentEditable=="false")return!1;e=Be(n)+(i<0?0:1),n=s}else if(n.nodeType==1){let s=n.childNodes[e+(i<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((o=s.pmViewDesc)===null||o===void 0)&&o.ignoreForSelection)e+=i;else return!1;else n=s,e=i<0?At(n):0}else return!1}}function At(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function eC(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=At(n)}else if(n.parentNode&&!Io(n))e=Be(n),n=n.parentNode;else return null}}function tC(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Io(n))e=Be(n)+1,n=n.parentNode;else return null}}function nC(n,e,t){for(let r=e==0,i=e==At(n);r||i;){if(n==t)return!0;let o=Be(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==At(n)}}function Io(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Pa=function(n){return n.focusNode&&xr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Xn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function rC(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function iC(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(At(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(At(r.startContainer),r.startOffset)}}}const Xt=typeof navigator<"u"?navigator:null,_d=typeof document<"u"?document:null,Wn=Xt&&Xt.userAgent||"",Pc=/Edge\/(\d+)/.exec(Wn),qg=/MSIE \d/.exec(Wn),Nc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Wn),ct=!!(qg||Nc||Pc),$n=qg?document.documentMode:Nc?+Nc[1]:Pc?+Pc[1]:0,Dt=!ct&&/gecko\/(\d+)/i.test(Wn);Dt&&+(/Firefox\/(\d+)/.exec(Wn)||[0,0])[1];const Ic=!ct&&/Chrome\/(\d+)/.exec(Wn),qe=!!Ic,Gg=Ic?+Ic[1]:0,rt=!ct&&!!Xt&&/Apple Computer/.test(Xt.vendor),fi=rt&&(/Mobile\/\w+/.test(Wn)||!!Xt&&Xt.maxTouchPoints>2),Rt=fi||(Xt?/Mac/.test(Xt.platform):!1),oC=Xt?/Win/.test(Xt.platform):!1,dn=/Android \d/.test(Wn),zo=!!_d&&"webkitFontSmoothing"in _d.documentElement.style,sC=zo?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function aC(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function sn(n,e){return typeof n=="number"?n:n[e]}function lC(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function Wd(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;){if(s.nodeType!=1){s=ui(s);continue}let a=s,l=a==o.body,c=l?aC(o):lC(a),u=0,f=0;if(e.top<c.top+sn(r,"top")?f=-(c.top-e.top+sn(i,"top")):e.bottom>c.bottom-sn(r,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+sn(i,"top")-c.top:e.bottom-c.bottom+sn(i,"bottom")),e.left<c.left+sn(r,"left")?u=-(c.left-e.left+sn(i,"left")):e.right>c.right-sn(r,"right")&&(u=e.right-c.right+sn(i,"right")),u||f)if(l)o.defaultView.scrollBy(u,f);else{let h=a.scrollLeft,p=a.scrollTop;f&&(a.scrollTop+=f),u&&(a.scrollLeft+=u);let m=a.scrollLeft-h,g=a.scrollTop-p;e={left:e.left-m,top:e.top-g,right:e.right-m,bottom:e.bottom-g}}let d=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(d))break;s=d=="absolute"?s.offsetParent:ui(s)}}function cC(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(o,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:Jg(n.dom)}}function Jg(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=ui(r));return e}function uC({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Ug(t,r==0?0:r-e)}function Ug(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let Fr=null;function fC(n){if(n.setActive)return n.setActive();if(Fr)return n.focus(Fr);let e=Jg(n);n.focus(Fr==null?{get preventScroll(){return Fr={preventScroll:!0},!0}}:void 0),Fr||(Fr=!1,Ug(e,0))}function Kg(n,e){let t,r=2e8,i,o=0,s=e.top,a=e.top,l,c;for(let u=n.firstChild,f=0;u;u=u.nextSibling,f++){let d;if(u.nodeType==1)d=u.getClientRects();else if(u.nodeType==3)d=ln(u).getClientRects();else continue;for(let h=0;h<d.length;h++){let p=d[h];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,i=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(o=f+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(o=f+1)}}return!t&&l&&(t=l,i=c,r=0),t&&t.nodeType==3?dC(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:Kg(t,i)}function dC(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=kn(r,1);if(o.top!=o.bottom&&Uu(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function Uu(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function hC(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function pC(n,e,t){let{node:r,offset:i}=Kg(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function mC(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(a.dom.nodeName)&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function Yg(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Uu(e,c))return Yg(s,e,c)}}if((o=(o+1)%r)==i)break}return n}function gC(n,e){let t=n.dom.ownerDocument,r,i=0,o=iC(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=n.dom.getBoundingClientRect();if(!Uu(e,c)||(s=Yg(n.dom,e,c),!s))return null}if(rt)for(let c=s;r&&c;c=ui(c))c.draggable&&(r=void 0);if(s=hC(s,e),r){if(Dt&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let c;zo&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=mC(n,r,i,e))}a==null&&(a=pC(n,s,e));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Hd(n){return n.top<n.bottom||n.left<n.right}function kn(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Hd(r))return r}return Array.prototype.find.call(t,Hd)||n.getBoundingClientRect()}const yC=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Xg(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=zo||Dt;if(r.nodeType==3)if(s&&(yC.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=kn(ln(r,i,i),t);if(Dt&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=kn(ln(r,i-1,i-1),-1);if(c.top==l.top){let u=kn(ln(r,i,i+1),-1);if(u.top!=l.top)return Ii(u,u.left<c.left)}}return l}else{let l=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(l--,u=1):t<0?l--:c++,Ii(kn(ln(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==At(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return wl(l.getBoundingClientRect(),!1)}if(o==null&&i<At(r)){let l=r.childNodes[i];if(l.nodeType==1)return wl(l.getBoundingClientRect(),!0)}return wl(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==At(r))){let l=r.childNodes[i-1],c=l.nodeType==3?ln(l,At(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ii(kn(c,1),!1)}if(o==null&&i<At(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?ln(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return Ii(kn(c,-1),!0)}return Ii(kn(r.nodeType==3?ln(r):r,-t),t>=0)}function Ii(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function wl(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Qg(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function bC(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return Qg(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=Xg(n,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=ln(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const wC=/[\u0590-\u08ac]/;function vC(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=n.domSelection();return a?!wC.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:s:Qg(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:f}=n.domSelectionRange(),d=a.caretBidiLevel;a.modify("move",t,"character");let h=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),g=p&&!h.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,f),l&&(l!=u||c!=f)&&a.extend&&a.extend(l,c)}catch{}return d!=null&&(a.caretBidiLevel=d),g}):r.pos==r.start()||r.pos==r.end()}let Vd=null,qd=null,Gd=!1;function xC(n,e,t){return Vd==e&&qd==t?Gd:(Vd=e,qd=t,Gd=t=="up"||t=="down"?bC(n,e,t):vC(n,e,t))}const $t=0,Jd=1,rr=2,Qt=3;class jo{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=$t,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Be(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof ey){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Zg&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?Be(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?Be(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=s;for(let f=a;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=Be(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=Be(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let h=0,p=0;h<this.children.length;h++){let m=this.children[h],g=p+m.size;if(o>p&&s<g)return m.setSelection(e-p-m.border,t-p-m.border,r,i);p=g}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),f=!1;if((Dt||rt)&&e==t){let{node:h,offset:p}=a;if(h.nodeType==3){if(f=!!(p&&h.nodeValue[p-1]==`
`),f&&p==h.nodeValue.length)for(let m=h,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(a=l={node:g.parentNode,offset:Be(g)+1});break}let b=m.pmViewDesc;if(b&&b.node&&b.node.isBlock)break}}else{let m=h.childNodes[p-1];f=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Dt&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let h=u.focusNode.childNodes[u.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||f&&rt)&&xr(a.node,a.offset,u.anchorNode,u.anchorOffset)&&xr(l.node,l.offset,u.focusNode,u.focusOffset))return;let d=!1;if((c.extend||e==t)&&!(f&&Dt)){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>t){let p=a;a=l,l=p}let h=document.createRange();h.setEnd(l.node,l.offset),h.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+o.border,l=s-o.border;if(e>=a&&t<=l){this.dirty=e==r||t==s?rr:Jd,e==a&&t==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Qt:o.markDirty(e-a,t-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?rr:Qt}r=s}this.dirty=rr}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?rr:Jd;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class Zg extends jo{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==$t&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class SC extends jo{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Sr extends jo{constructor(e,t,r,i,o){super(e,[],r,i),this.mark=t,this.spec=o}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=Tr.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new Sr(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Qt||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Qt&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=$t){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=$t}}slice(e,t,r){let i=Sr.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=jc(o,t,s,r)),e>0&&(o=jc(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Pn extends jo{constructor(e,t,r,i,o,s,a,l,c){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,o,s){let a=o.nodeViews[t.type.name],l,c=a&&a(t,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,f=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=Tr.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let d=u;return u=ry(u,r,t),c?l=new CC(e,t,r,i,u,f||null,d,c,o,s+1):t.isText?new Na(e,t,r,i,u,d,o):new Pn(e,t,r,i,u,f||null,d,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>E.empty)}return e}matchesNode(e,t,r){return this.dirty==$t&&e.eq(this.node)&&Gs(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new OC(this,s&&s.node,e);TC(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!f&&l.syncToMarks(u==this.node.childCount?ae.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,f,d)=>{l.syncToMarks(c.marks,r,e);let h;l.findNodeMatch(c,u,f,d)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(h=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,f,h,e)||l.updateNextNode(c,u,f,e,d,i)||l.addNode(c,u,f,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==rr)&&(s&&this.protectLocalComposition(e,s),ty(this.contentDOM,this.children,e),fi&&RC(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof F)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=AC(this.node.content,s,r-t,i-t);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new SC(this,o,t,i);e.input.compositionNodes.push(s),this.children=jc(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==Qt||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=$t}updateOuterDeco(e){if(Gs(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ny(this.dom,this.nodeDOM,zc(this.outerDeco,this.node,t),zc(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function Ud(n,e,t,r,i){ry(r,e,n);let o=new Pn(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class Na extends Pn{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Qt||this.dirty!=$t&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=$t||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=$t,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Na(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Qt)}get domAtom(){return!1}isText(e){return this.node.text==e}}class ey extends jo{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==$t&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class CC extends Pn{constructor(e,t,r,i,o,s,a,l,c,u){super(e,t,r,i,o,s,a,c,u),this.spec=l}update(e,t,r,i){if(this.dirty==Qt)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ty(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=Kd(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof Sr){let l=r?r.previousSibling:n.lastChild;ty(s.contentDOM,s.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=Kd(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const eo=function(n){n&&(this.nodeName=n)};eo.prototype=Object.create(null);const ir=[new eo];function zc(n,e,t){if(n.length==0)return ir;let r=t?ir[0]:new eo,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new eo(s.nodeName));for(let a in s){let l=s[a];l!=null&&(t&&i.length==1&&i.push(r=new eo(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function ny(n,e,t,r){if(t==ir&&r==ir)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=t[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=ir[0]),i=l}kC(i,a||ir[0],s)}return i}function kC(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function ry(n,e,t){return ny(n,n,ir,zc(e,t,n.nodeType!=1))}function Gs(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function Kd(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class OC{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=MC(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=$t,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Sr.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==Qt&&s.dom==s.contentDOM&&(s.dirty=rr),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Pn){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,f,d=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Qt&&Gs(t,l.outerDeco));if(!d&&l.update(e,t,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(l,e,t,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=rr,f.updateChildren(i,s+1),f.dirty=$t),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Gs(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=Pn.create(this.top,t,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,i,o){let s=Pn.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new Zg(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Sr;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Na)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((rt||qe)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new ey(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function MC(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Sr)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function EC(n,e){return n.type.side-e.type.side}function TC(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,f;for(;s<i.length&&i[s].to==o;){let g=i[s++];g.widget&&(u?(f||(f=[u])).push(g):u=g)}if(u)if(f){f.sort(EC);for(let g=0;g<f.length;g++)t(f[g],c,!!l)}else t(u,c,!!l);let d,h;if(l)h=-1,d=l,l=null;else if(c<n.childCount)h=c,d=n.child(c++);else break;for(let g=0;g<a.length;g++)a[g].to<=o&&a.splice(g--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let p=o+d.nodeSize;if(d.isText){let g=p;s<i.length&&i[s].from<g&&(g=i[s].from);for(let b=0;b<a.length;b++)a[b].to<g&&(g=a[b].to);g<p&&(l=d.cut(g-o),d=d.cut(0,g-o),p=g,h=-1)}else for(;s<i.length&&i[s].to<p;)s++;let m=d.isInline&&!d.isLeaf?a.filter(g=>!g.inline):a.slice();r(d,m,e.forChild(o,d),h),o=p}}function RC(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function AC(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<n.childCount;){let c=n.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=t){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function jc(n,e,t,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,u=a+=l.size;c>=t||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>t&&o.push(l.slice(t-c,l.size,r)))}return o}function Ku(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(Pa(t)){for(l=s;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&j.isSelectable(f)&&i.parent&&!(f.isInline&&nC(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;c=new j(s==d?a:r.resolve(d))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=s,d=s;for(let h=0;h<t.rangeCount;h++){let p=t.getRangeAt(h);f=Math.min(f,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),d=Math.max(d,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(f<0)return null;[l,s]=d==n.state.selection.anchor?[d,f]:[f,d],a=r.resolve(s)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let f=e=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;c=Yu(n,u,a,f)}return c}function iy(n){return n.editable?n.hasFocus():sy(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function yn(n,e=!1){let t=n.state.selection;if(oy(n,t),!!iy(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&qe){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&xr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)$C(n);else{let{anchor:r,head:i}=t,o,s;Yd&&!(t instanceof F)&&(t.$from.parent.inlineContent||(o=Xd(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=Xd(n,t.to))),n.docView.setSelection(r,i,n,e),Yd&&(o&&Qd(o),s&&Qd(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&DC(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const Yd=rt||qe&&Gg<63;function Xd(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(rt&&i&&i.contentEditable=="false")return vl(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return vl(i);if(o)return vl(o)}}function vl(n){return n.contentEditable="true",rt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function Qd(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function DC(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!iy(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function $C(n){let e=n.domSelection();if(!e)return;let t=n.cursorWrapper.dom,r=t.nodeName=="IMG";r?e.collapse(t.parentNode,Be(t)+1):e.collapse(t,0),!r&&!n.state.selection.visible&&ct&&$n<=11&&(t.disabled=!0,t.disabled=!1)}function oy(n,e){if(e instanceof j){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(Zd(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else Zd(n)}function Zd(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Yu(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||F.between(e,t,r)}function eh(n){return n.editable&&!n.hasFocus()?!1:sy(n)}function sy(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function PC(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return xr(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Lc(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&B.findFrom(o,e)}function On(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function th(n,e,t){let r=n.state.selection;if(r instanceof F)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return On(n,new F(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Lc(n.state,e);return i&&i instanceof j?On(n,i):!1}else if(!(Rt&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?j.isSelectable(o)?On(n,new j(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):zo?On(n,new F(n.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof j&&r.node.isInline)return On(n,new F(e>0?r.$to:r.$from));{let i=Lc(n.state,e);return i?On(n,i):!1}}}function Js(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function to(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function _r(n,e){return e<0?NC(n):IC(n)}function NC(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(Dt&&t.nodeType==1&&r<Js(t)&&to(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(to(a,-1))i=t,o=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(ay(t))break;{let a=t.previousSibling;for(;a&&to(a,-1);)i=t.parentNode,o=Be(a),a=a.previousSibling;if(a)t=a,r=Js(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Bc(n,t,r):i&&Bc(n,i,o)}function IC(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=Js(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(to(a,1))o=t,s=++r;else break}else{if(ay(t))break;{let a=t.nextSibling;for(;a&&to(a,1);)o=a.parentNode,s=Be(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=Js(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Bc(n,o,s)}function ay(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function zC(n,e){for(;n&&e==n.childNodes.length&&!Io(n);)e=Be(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function jC(n,e){for(;n&&!e&&!Io(n);)e=Be(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Bc(n,e,t){if(e.nodeType!=3){let o,s;(s=zC(e,t))?(e=s,t=0):(o=jC(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(Pa(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&yn(n)},50)}function nh(n,e){let t=n.state.doc.resolve(e);if(!(qe||oC)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function rh(n,e,t){let r=n.state.selection;if(r instanceof F&&!r.empty||t.indexOf("s")>-1||Rt&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Lc(n.state,e);if(s&&s instanceof j)return On(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof gn?B.near(s,e):B.findFrom(s,e);return a?On(n,a):!1}return!1}function ih(n,e){if(!(n.state.selection instanceof F))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function oh(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function LC(n){if(!rt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;oh(n,r,"true"),setTimeout(()=>oh(n,r,"false"),20)}return!1}function BC(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function FC(n,e){let t=e.keyCode,r=BC(e);if(t==8||Rt&&t==72&&r=="c")return ih(n,-1)||_r(n,-1);if(t==46&&!e.shiftKey||Rt&&t==68&&r=="c")return ih(n,1)||_r(n,1);if(t==13||t==27)return!0;if(t==37||Rt&&t==66&&r=="c"){let i=t==37?nh(n,n.state.selection.from)=="ltr"?-1:1:-1;return th(n,i,r)||_r(n,i)}else if(t==39||Rt&&t==70&&r=="c"){let i=t==39?nh(n,n.state.selection.from)=="ltr"?1:-1:1;return th(n,i,r)||_r(n,i)}else{if(t==38||Rt&&t==80&&r=="c")return rh(n,-1,r)||_r(n,-1);if(t==40||Rt&&t==78&&r=="c")return LC(n)||rh(n,1,r)||_r(n,1);if(r==(Rt?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Xu(n,e){n.someProp("transformCopied",h=>{e=h(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let h=r.firstChild;t.push(h.type.name,h.attrs!=h.type.defaultAttrs?h.attrs:null),r=h.content}let s=n.someProp("clipboardSerializer")||Tr.fromSchema(n.state.schema),a=hy(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=dy[c.nodeName.toLowerCase()]);){for(let h=u.length-1;h>=0;h--){let p=a.createElement(u[h]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),f++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",h=>h(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:d,slice:e}}function ly(n,e,t,r,i){let o=i.parent.type.spec.code,s,a;if(!t&&!e)return null;let l=!!e&&(r||o||!t);if(l){if(n.someProp("transformPastedText",d=>{e=d(e,o||r,n)}),o)return a=new D(E.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),n.someProp("transformPasted",d=>{a=d(a,n,!0)}),a;let f=n.someProp("clipboardTextParser",d=>d(e,i,r,n));if(f)a=f;else{let d=i.marks(),{schema:h}=n.state,p=Tr.fromSchema(h);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=s.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(h.text(m,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),s=VC(t),zo&&qC(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Qi.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!_C.test(d.parentNode.nodeName)?{ignore:!0}:null}})),u)a=GC(sh(a,+u[1],+u[2]),u[4]);else if(a=D.maxOpen(WC(a.content,i),!0),a.openStart||a.openEnd){let f=0,d=0;for(let h=a.content.firstChild;f<a.openStart&&!h.type.spec.isolating;f++,h=h.firstChild);for(let h=a.content.lastChild;d<a.openEnd&&!h.type.spec.isolating;d++,h=h.lastChild);a=sh(a,f,d)}return n.someProp("transformPasted",f=>{a=f(a,n,l)}),a}const _C=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function WC(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&uy(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=fy(s[s.length-1],o.length));let u=cy(a,l);s.push(u),i=i.matchType(u.type),o=l}}),s)return E.from(s)}return n}function cy(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,E.from(n));return n}function uy(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=uy(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(E.from(cy(t,n,i+1))))}}function fy(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,fy(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(E.empty,!0);return n.copy(t.append(r))}function Fc(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(o=0),i<r-1&&(a=Fc(a,e,t,r,i+1,o)),i>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(E.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function sh(n,e,t){return e<n.openStart&&(n=new D(Fc(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new D(Fc(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const dy={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let ah=null;function hy(){return ah||(ah=document.implementation.createHTMLDocument("title"))}let xl=null;function HC(n){let e=window.trustedTypes;return e?(xl||(xl=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),xl.createHTML(n)):n}function VC(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=hy().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&dy[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=HC(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function qC(n){let e=n.querySelectorAll(qe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function GC(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=E.from(l.create(r[a+1],i)),o++,s++}return new D(i,o,s)}const it={},ot={},JC={touchstart:!0,touchmove:!0};class UC{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function KC(n){for(let e in it){let t=it[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{XC(n,r)&&!Qu(n,r)&&(n.editable||!(r.type in ot))&&t(n,r)},JC[e]?{passive:!0}:void 0)}rt&&n.dom.addEventListener("input",()=>null),_c(n)}function Rn(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function YC(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function _c(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Qu(n,r))})}function Qu(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function XC(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function QC(n,e){!Qu(n,e)&&it[e.type]&&(n.editable||!(e.type in ot))&&it[e.type](n,e)}ot.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!my(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(dn&&qe&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),fi&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Xn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||FC(n,t)?t.preventDefault():Rn(n,"key")};ot.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};ot.keypress=(n,e)=>{let t=e;if(my(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||Rt&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof F)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode),o=()=>n.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i,o))&&n.dispatch(o()),t.preventDefault()}};function Ia(n){return{left:n.clientX,top:n.clientY}}function ZC(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Zu(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,a=>s>o.depth?a(n,t,o.nodeAfter,o.before(s),i,!0):a(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function ti(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function ek(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&j.isSelectable(r)?(ti(n,new j(t)),!0):!1}function tk(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof j&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(j.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(ti(n,j.create(n.state.doc,i)),!0):!1}function nk(n,e,t,r,i){return Zu(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?tk(n,t):ek(n,t))}function rk(n,e,t,r){return Zu(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function ik(n,e,t,r){return Zu(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||ok(n,t,r)}function ok(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(ti(n,F.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)ti(n,F.create(r,a+1,a+1+s.content.size));else if(j.isSelectable(s))ti(n,j.create(r,a));else continue;return!0}}function ef(n){return Us(n)}const py=Rt?"metaKey":"ctrlKey";it.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=ef(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&ZC(t,n.input.lastClick)&&!t[py]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o,button:t.button};let s=n.posAtCoords(Ia(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new sk(n,s,t,!!r)):(o=="doubleClick"?rk:ik)(n,s.pos,s.inside,t)?t.preventDefault():Rn(n,"pointer"))};class sk{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[py],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let u=e.state.doc.resolve(t.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.nodeDOM.nodeType==1?l.nodeDOM:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof j&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Dt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Rn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>yn(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Ia(e))),this.updateAllowDefault(e),this.allowDefault||!t?Rn(this.view,"pointer"):nk(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||rt&&this.mightDrag&&!this.mightDrag.node.isAtom||qe&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ti(this.view,B.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):Rn(this.view,"pointer")}move(e){this.updateAllowDefault(e),Rn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}it.touchstart=n=>{n.input.lastTouch=Date.now(),ef(n),Rn(n,"pointer")};it.touchmove=n=>{n.input.lastTouch=Date.now(),Rn(n,"pointer")};it.contextmenu=n=>ef(n);function my(n,e){return n.composing?!0:rt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const ak=dn?5e3:-1;ot.compositionstart=ot.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof F&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Us(n,!0),n.markCursor=null;else if(Us(n,!e.selection.empty),Dt&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=n.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}gy(n,ak)};ot.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,gy(n,20))};function gy(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Us(n),e))}function yy(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ck());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function lk(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=eC(e.focusNode,e.focusOffset),r=tC(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function ck(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Us(n,e=!1){if(!(dn&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),yy(n),e||n.docView&&n.docView.dirty){let t=Ku(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function uk(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const mo=ct&&$n<15||fi&&sC<604;it.copy=ot.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=mo?null:t.clipboardData,s=r.content(),{dom:a,text:l}=Xu(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):uk(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function fk(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function dk(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?go(n,r.value,null,i,e):go(n,r.textContent,r.innerHTML,i,e)},50)}function go(n,e,t,r,i){let o=ly(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,o||D.empty)))return!0;if(!o)return!1;let s=fk(o),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function by(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}ot.paste=(n,e)=>{let t=e;if(n.composing&&!dn)return;let r=mo?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&go(n,by(r),r.getData("text/html"),i,t)?t.preventDefault():dk(n,t)};class wy{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const hk=Rt?"altKey":"ctrlKey";function vy(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[hk]}it.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(Ia(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof j?i.to-1:i.to))){if(r&&r.mightDrag)s=j.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(s=j.create(n.state.doc,f.posBefore))}}let a=(s||n.state.selection).content(),{dom:l,text:c,slice:u}=Xu(n,a);(!t.dataTransfer.files.length||!qe||Gg>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(mo?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",mo||t.dataTransfer.setData("text/plain",c),n.dragging=new wy(u,vy(n,t),s)};it.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};ot.dragover=ot.dragenter=(n,e)=>e.preventDefault();ot.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(Ia(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n,!1)}):s=ly(n,by(t.dataTransfer),mo?null:t.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&vy(n,t));if(n.someProp("handleDrop",p=>p(n,t,s||D.empty,a))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?Dg(n.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=n.state.tr;if(a){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=c.doc;if(f?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(d))return;let h=c.doc.resolve(u);if(f&&j.isSelectable(s.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new j(h));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,b,x)=>p=x),c.setSelection(Yu(n,h,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};it.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&yn(n)},20))};it.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};it.beforeinput=(n,e)=>{if(qe&&dn&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,Xn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in ot)it[n]=ot[n];function yo(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Ks{constructor(e,t){this.toDOM=e,this.spec=t||hr,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new Ge(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Ks&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&yo(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Nn{constructor(e,t){this.attrs=e,this.spec=t||hr}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Ge(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Nn&&yo(this.attrs,e.attrs)&&yo(this.spec,e.spec)}static is(e){return e.type instanceof Nn}destroy(){}}let pk=class xy{constructor(e,t){this.attrs=e,this.spec=t||hr}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Ge(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof xy&&yo(this.attrs,e.attrs)&&yo(this.spec,e.spec)}destroy(){}};class Ge{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Ge(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Ge(e,e,new Ks(t,r))}static inline(e,t,r,i){return new Ge(e,t,new Nn(r,i))}static node(e,t,r,i){return new Ge(e,t,new pk(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Nn}get widget(){return this.type instanceof Ks}}const Jr=[],hr={};class ge{constructor(e,t){this.local=e.length?e:Jr,this.children=t.length?t:Jr}static create(e,t){return t.length?Ys(t,e,0,hr):Ve}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,i+a,o)}}map(e,t,r){return this==Ve||e.maps.length==0?this:this.mapInner(e,t,0,0,r||hr)}mapInner(e,t,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?mk(this.children,s||[],e,t,r,i,o):s?new ge(s.sort(pr),Jr):Ve}add(e,t){return t.length?this==Ve?ge.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=Cy(t,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,u,c+1):i.splice(o,0,l,l+a.nodeSize,Ys(u,a,c+1,hr)),o+=3}});let s=Sy(o?ky(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new ge(s.length?this.local.concat(s).sort(pr):this.local,i||this.children)}remove(e){return e.length==0||this==Ve?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+t,l=r[o+1]+t;for(let u=0,f;u<e.length;u++)(f=e[u])&&f.from>a&&f.to<l&&(e[u]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=Ve?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new ge(i,r):Ve}forChild(e,t){if(this==Ve)return this;if(t.isLeaf)return ge.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Nn){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new ge(i.sort(pr),Jr);return r?new En([a,r]):a}return r||Ve}eq(e){if(this==e)return!0;if(!(e instanceof ge)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return tf(this.localsInner(e))}localsInner(e){if(this==Ve)return Jr;if(e.inlineContent||!this.local.some(Nn.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Nn||t.push(this.local[r]);return t}forEachSet(e){e(this)}}ge.empty=new ge([],[]);ge.removeOverlap=tf;const Ve=ge.empty;class En{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,hr));return En.from(r)}forChild(e,t){if(t.isLeaf)return ge.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Ve&&(o instanceof En?r=r.concat(o.members):r.push(o))}return En.from(r)}eq(e){if(!(e instanceof En)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?tf(r?t:t.sort(pr)):Jr}static from(e){switch(e.length){case 0:return Ve;case 1:return e[0];default:return new En(e.every(t=>t instanceof ge)?e:e.reduce((t,r)=>t.concat(r instanceof ge?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function mk(n,e,t,r,i,o,s){let a=n.slice();for(let c=0,u=o;c<t.maps.length;c++){let f=0;t.maps[c].forEach((d,h,p,m)=>{let g=m-p-(h-d);for(let b=0;b<a.length;b+=3){let x=a[b+1];if(x<0||d>x+u-f)continue;let w=a[b]+u-f;h>=w?a[b+1]=d<=w?-2:-1:d>=u&&g&&(a[b]+=g,a[b+1]+=g)}f+=g}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+o),f=u-i;if(f<0||f>=r.content.size){l=!0;continue}let d=t.map(n[c+1]+o,-1),h=d-i,{index:p,offset:m}=r.content.findIndex(f),g=r.maybeChild(p);if(g&&m==f&&m+g.nodeSize==h){let b=a[c+2].mapInner(t,g,u+1,n[c]+o+1,s);b!=Ve?(a[c]=f,a[c+1]=h,a[c+2]=b):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=gk(a,n,e,t,i,o,s),u=Ys(c,r,0,s);e=u.local;for(let f=0;f<a.length;f+=3)a[f+1]<0&&(a.splice(f,3),f-=3);for(let f=0,d=0;f<u.children.length;f+=3){let h=u.children[f];for(;d<a.length&&a[d]<h;)d+=3;a.splice(d,0,u.children[f],u.children[f+1],u.children[f+2])}}return new ge(e.sort(pr),a)}function Sy(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Ge(i.from+e,i.to+e,i.type))}return t}function gk(n,e,t,r,i,o,s){function a(l,c){for(let u=0;u<l.local.length;u++){let f=l.local[u].map(r,i,c);f?t.push(f):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+o+1);return t}function Cy(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function ky(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Ys(n,e,t,r){let i=[],o=!1;e.forEach((a,l)=>{let c=Cy(n,a,l+t);if(c){o=!0;let u=Ys(c,a,t+l+1,r);u!=Ve&&i.push(l,l+a.nodeSize,u)}});let s=Sy(o?ky(n):n,-t).sort(pr);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new ge(s,i):Ve}function pr(n,e){return n.from-e.from||n.to-e.to}function tf(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),lh(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),lh(e,i,r.copy(o.from,r.to)));break}}}return e}function lh(n,e,t){for(;e<n.length&&pr(t,n[e])>0;)e++;n.splice(e,0,t)}function Sl(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ve&&e.push(r)}),n.cursorWrapper&&e.push(ge.create(n.state.doc,[n.cursorWrapper.deco])),En.from(e)}const yk={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},bk=ct&&$n<=11;class wk{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class vk{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new wk,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);ct&&$n<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),bk&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,yk)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(eh(this.view)){if(this.suppressingSelectionUpdates)return yn(this.view);if(ct&&$n<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&xr(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=ui(o))t.add(o);for(let o=e.anchorNode;o;o=ui(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&eh(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let f=this.registerMutation(t[u],l);f&&(o=o<0?f.from:Math.min(f.from,o),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(a=!0))}if(Dt&&l.length){let u=l.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,d]=u;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of u){let h=d.parentNode;h&&h.nodeName=="LI"&&(!f||Ck(e,f)!=h)&&d.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Pa(r)&&(c=Ku(e))&&c.eq(B.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,yn(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),xk(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||yn(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let f=e.addedNodes[u];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(ct&&$n<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:f,nextSibling:d}=e.addedNodes[u];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d)}let s=i&&i.parentNode==e.target?Be(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?Be(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let ch=new WeakMap,uh=!1;function xk(n){if(!ch.has(n)&&(ch.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Dt,uh)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),uh=!0}}function fh(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return xr(s.node,s.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function Sk(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return fh(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?fh(n,t):null}function Ck(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function kk(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Pa(l)||c.push({node:l.focusNode,offset:l.focusOffset})),qe&&n.input.lastKeyCode===8)for(let g=o;g>i;g--){let b=r.childNodes[g-1],x=b.pmViewDesc;if(b.nodeName=="BR"&&!x){o=g;break}if(!x||x.size)break}let f=n.state.doc,d=n.someProp("domParser")||Qi.fromSchema(n.state.schema),h=f.resolve(s),p=null,m=d.parse(r,{topNode:h.parent,topMatch:h.parent.contentMatchAt(h.index()),topOpen:!0,from:i,to:o,preserveWhitespace:h.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:Ok,context:h});if(c&&c[0].pos!=null){let g=c[0].pos,b=c[1]&&c[1].pos;b==null&&(b=g),p={anchor:g+s,head:b+s}}return{doc:m,sel:p,from:s,to:a}}function Ok(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(rt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||rt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Mk=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Ek(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let O=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,M=Ku(n,O);if(M&&!n.state.selection.eq(M)){if(qe&&dn&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",T=>T(n,Xn(13,"Enter"))))return;let R=n.state.tr.setSelection(M);O=="pointer"?R.setMeta("pointer",!0):O=="key"&&R.scrollIntoView(),o&&R.setMeta("composition",o),n.dispatch(R)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=kk(n,e,t),u=n.state.doc,f=u.slice(c.from,c.to),d,h;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,h="end"):(d=n.state.selection.from,h="start"),n.input.lastKeyCode=null;let p=Ak(f.content,c.doc.content,c.from,d,h);if(p&&n.input.domChangeCount++,(fi&&n.input.lastIOSEnter>Date.now()-225||dn)&&i.some(O=>O.nodeType==1&&!Mk.test(O.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",O=>O(n,Xn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof F&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let O=dh(n,n.state.doc,c.sel);if(O&&!O.eq(n.state.selection)){let M=n.state.tr.setSelection(O);o&&M.setMeta("composition",o),n.dispatch(M)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof F&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),ct&&$n<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),g=c.doc.resolveNoCache(p.endB-c.from),b=u.resolve(p.start),x=m.sameParent(g)&&m.parent.inlineContent&&b.end()>=p.endA;if((fi&&n.input.lastIOSEnter>Date.now()-225&&(!x||i.some(O=>O.nodeName=="DIV"||O.nodeName=="P"))||!x&&m.pos<c.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&m.pos<g.pos&&!/\S/.test(c.doc.textBetween(m.pos,g.pos,"","")))&&n.someProp("handleKeyDown",O=>O(n,Xn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&Rk(u,p.start,p.endA,m,g)&&n.someProp("handleKeyDown",O=>O(n,Xn(8,"Backspace")))){dn&&qe&&n.domObserver.suppressSelectionUpdates();return}qe&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),dn&&!x&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,g=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(O){return O(n,Xn(13,"Enter"))})},20));let w=p.start,C=p.endA,S=O=>{let M=O||n.state.tr.replace(w,C,c.doc.slice(p.start-c.from,p.endB-c.from));if(c.sel){let R=dh(n,M.doc,c.sel);R&&!(qe&&n.composing&&R.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(R.head==w||R.head==M.mapping.map(C)-1)||ct&&R.empty&&R.head==w)&&M.setSelection(R)}return o&&M.setMeta("composition",o),M.scrollIntoView()},k;if(x)if(m.pos==g.pos){ct&&$n<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>yn(n),20));let O=S(n.state.tr.delete(w,C)),M=u.resolve(p.start).marksAcross(u.resolve(p.endA));M&&O.ensureMarks(M),n.dispatch(O)}else if(p.endA==p.endB&&(k=Tk(m.parent.content.cut(m.parentOffset,g.parentOffset),b.parent.content.cut(b.parentOffset,p.endA-b.start())))){let O=S(n.state.tr);k.type=="add"?O.addMark(w,C,k.mark):O.removeMark(w,C,k.mark),n.dispatch(O)}else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let O=m.parent.textBetween(m.parentOffset,g.parentOffset),M=()=>S(n.state.tr.insertText(O,w,C));n.someProp("handleTextInput",R=>R(n,w,C,O,M))||n.dispatch(M())}else n.dispatch(S());else n.dispatch(S())}function dh(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Yu(n,e.resolve(t.anchor),e.resolve(t.head))}function Tk(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)o=t[u].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(E.from(c).eq(n))return{mark:a,type:s}}function Rk(n,e,t,r,i){if(t-e<=i.pos-r.pos||Cl(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&t==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(Cl(o,!0,!0));return!s.parent.isTextblock||s.pos>t||Cl(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Cl(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function Ak(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&n.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&hh(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<n.size&&hh(n.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function hh(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class Oy{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new UC,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(bh),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=gh(this),mh(this),this.nodeViews=yh(this),this.docView=Ud(this.state.doc,ph(this),Sl(this),this.dom,this),this.domObserver=new vk(this,(r,i,o,s)=>Ek(this,r,i,o,s)),this.domObserver.start(),KC(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&_c(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(bh),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(yy(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=yh(this);$k(h,this.nodeViews)&&(this.nodeViews=h,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&_c(this),this.editable=gh(this),mh(this);let l=Sl(this),c=ph(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,c,l);(f||!e.selection.eq(i.selection))&&(s=!0);let d=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&cC(this);if(s){this.domObserver.stop();let h=f&&(ct||qe)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&Dk(i.selection,e.selection);if(f){let p=qe?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=lk(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=Ud(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&PC(this))?yn(this,h):(oy(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():d&&uC(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof j){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&Wd(this,t.getBoundingClientRect(),e)}else Wd(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new wy(e.slice,e.move,i<0?void 0:j.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=t?t(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(ct){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&fC(this.dom),yn(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return gC(this,e)}coordsAtPos(e,t=1){return Xg(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return xC(this,t||this.state,e)}pasteHTML(e,t){return go(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return go(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return Xu(this,e)}destroy(){this.docView&&(YC(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Sl(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Q1())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return QC(this,e)}domSelectionRange(){let e=this.domSelection();return e?rt&&this.root.nodeType===11&&rC(this.dom.ownerDocument)==this.dom&&Sk(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}Oy.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function ph(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Ge.node(0,n.state.doc.content.size,e)]}function mh(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Ge.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function gh(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Dk(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function yh(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function $k(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function bh(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const Pk=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Nk=typeof navigator<"u"&&/Win/.test(navigator.platform);function Ik(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Pk?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function zk(n){let e=Object.create(null);for(let t in n)e[Ik(t)]=n[t];return e}function kl(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function jk(n){return new Fe({props:{handleKeyDown:nf(n)}})}function nf(n){let e=zk(n);return function(t,r){let i=nw(r),o,s=e[kl(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[kl(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Nk&&r.ctrlKey&&r.altKey)&&(o=rw[r.keyCode])&&o!=i){let a=e[kl(o,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const rf=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function My(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Ey=(n,e,t)=>{let r=My(n,t);if(!r)return!1;let i=of(r);if(!i){let s=r.blockRange(),a=s&&Si(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(zy(n,i,e,-1))return!0;if(r.parent.content.size==0&&(di(o,"end")||j.isSelectable(o)))for(let s=r.depth;;s--){let a=$a(n.doc,r.before(s),r.after(s),D.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(di(o,"end")?B.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):j.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},Lk=(n,e,t)=>{let r=My(n,t);if(!r)return!1;let i=of(r);return i?Ty(n,i,e):!1},Bk=(n,e,t)=>{let r=Ay(n,t);if(!r)return!1;let i=sf(r);return i?Ty(n,i,e):!1};function Ty(n,e,t){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=$a(n.doc,o,l,D.empty);if(!c||c.from!=o||c instanceof Lt&&c.slice.size>=l-o)return!1;if(t){let u=n.tr.step(c);u.setSelection(F.create(u.doc,o)),t(u.scrollIntoView())}return!0}function di(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const Ry=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=of(r)}let s=o&&o.nodeBefore;return!s||!j.isSelectable(s)?!1:(e&&e(n.tr.setSelection(j.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function of(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Ay(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Dy=(n,e,t)=>{let r=Ay(n,t);if(!r)return!1;let i=sf(r);if(!i)return!1;let o=i.nodeAfter;if(zy(n,i,e,1))return!0;if(r.parent.content.size==0&&(di(o,"start")||j.isSelectable(o))){let s=$a(n.doc,r.before(),r.after(),D.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(di(o,"start")?B.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):j.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},$y=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=sf(r)}let s=o&&o.nodeAfter;return!s||!j.isSelectable(s)?!1:(e&&e(n.tr.setSelection(j.create(n.doc,o.pos)).scrollIntoView()),!0)};function sf(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Fk=(n,e)=>{let t=n.selection,r=t instanceof j,i;if(r){if(t.node.isTextblock||!_n(n.doc,t.from))return!1;i=t.from}else if(i=Da(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection(j.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},_k=(n,e)=>{let t=n.selection,r;if(t instanceof j){if(t.node.isTextblock||!_n(n.doc,t.to))return!1;r=t.to}else if(r=Da(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},Wk=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&Si(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},Py=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function af(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const Hk=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=af(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(B.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},Ny=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof gn||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=af(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(F.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},Iy=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(mn(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&Si(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function Vk(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof j&&e.selection.node.isBlock)return!r.parentOffset||!mn(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],s,a,l=!1,c=!1;for(let h=r.depth;;h--)if(r.node(h).isBlock){l=r.end(h)==r.pos+(r.depth-h),c=r.start(h)==r.pos-(r.depth-h),a=af(r.node(h-1).contentMatchAt(r.indexAfter(h-1))),o.unshift(l&&a?{type:a}:null),s=h;break}else{if(h==1)return!1;o.unshift(null)}let u=e.tr;(e.selection instanceof F||e.selection instanceof gn)&&u.deleteSelection();let f=u.mapping.map(r.pos),d=mn(u.doc,f,o.length,o);if(d||(o[0]=a?{type:a}:null,d=mn(u.doc,f,o.length,o)),!d)return!1;if(u.split(f,o.length,o),!l&&c&&r.node(s).type!=a){let h=u.mapping.map(r.before(s)),p=u.doc.resolve(h);a&&r.node(s-1).canReplaceWith(p.index(),p.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(s)),a)}return t&&t(u.scrollIntoView()),!0}}const qk=Vk(),Gk=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection(j.create(n.doc,i))),!0)};function Jk(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||_n(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function zy(n,e,t,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&Jk(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(t){let h=e.pos+o.nodeSize,p=E.empty;for(let b=s.length-1;b>=0;b--)p=E.from(s[b].create(null,p));p=E.from(i.copy(p));let m=n.tr.step(new ft(e.pos-1,h,e.pos,h,new D(p,1,0),s.length,!0)),g=m.doc.resolve(h+2*s.length);g.nodeAfter&&g.nodeAfter.type==i.type&&_n(m.doc,g.pos)&&m.join(g.pos),t(m.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:B.findFrom(e,1),f=u&&u.$from.blockRange(u.$to),d=f&&Si(f);if(d!=null&&d>=e.depth)return t&&t(n.tr.lift(f,d).scrollIntoView()),!0;if(c&&di(o,"start",!0)&&di(i,"end")){let h=i,p=[];for(;p.push(h),!h.isTextblock;)h=h.lastChild;let m=o,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(h.canReplace(h.childCount,h.childCount,m.content)){if(t){let b=E.empty;for(let w=p.length-1;w>=0;w--)b=E.from(p[w].copy(b));let x=n.tr.step(new ft(e.pos-p.length,e.pos+o.nodeSize,e.pos+g,e.pos+o.nodeSize-g,new D(b,p.length,0),0,!0));t(x.scrollIntoView())}return!0}}return!1}function jy(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(F.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const Uk=jy(-1),Kk=jy(1);function Yk(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=s&&Ju(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function wh(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),f=u.index();i=u.parent.canReplaceWith(f,f+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];o.setBlockType(a,l,n,e)}r(o.scrollIntoView())}return!0}}function lf(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}lf(rf,Ey,Ry);lf(rf,Dy,$y);lf(Py,Ny,Iy,qk);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function Xk(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o);if(!s)return!1;let a=r?t.tr:null;return Qk(a,s,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function Qk(n,e,t,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new Vs(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new Vs(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=Ju(o,t,r,e);return a?(n&&Zk(n,e,a,i,t),!0):!1}function Zk(n,e,t,r,i){let o=E.empty;for(let u=t.length-1;u>=0;u--)o=E.from(t[u].type.create(t[u].attrs,o));n.step(new ft(e.start-(r?2:0),e.end,e.start,e.end,new D(o,0,0),t.length,!0));let s=0;for(let u=0;u<t.length;u++)t[u].type==i&&(s=u+1);let a=t.length-s,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,d=!0;u<f;u++,d=!1)!d&&mn(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function eO(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?tO(e,t,n,o):nO(e,t,o):!0:!1}}function tO(n,e,t,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new ft(o-1,s,o,s,new D(E.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Vs(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=Si(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return _n(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function nO(n,e,t){let r=n.tr,i=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let o=r.doc.resolve(t.start),s=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?E.empty:E.from(i))))return!1;let f=o.pos,d=f+s.nodeSize;return r.step(new ft(f-(a?1:0),d+(l?1:0),f+1,d-1,new D((a?E.empty:E.from(i.copy(E.empty))).append(l?E.empty:E.from(i.copy(E.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function rO(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=E.from(c?n.create():null),f=new D(E.from(n.create(null,E.from(a.type.create(null,u)))),c?3:1,0),d=o.start,h=o.end;t(e.tr.step(new ft(d-(c?3:1),h,d,h,f,1,!0)).scrollIntoView())}return!0}}function za(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}let ja=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const f=l(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(d=>d===!0)),f={...Object.fromEntries(Object.entries(r).map(([d,h])=>[d,(...m)=>{const g=this.buildProps(c,t),b=h(...m)(g);return a.push(b),f}])),run:u};return f}createCan(e){const{rawCommands:t,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:za({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}};class iO{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}once(e,t){const r=(...i)=>{this.off(e,r),t.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function N(n,e,t){return n.config[e]===void 0&&n.parent?N(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?N(n.parent,e,t):null}):n.config[e]}function La(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Ly(n){const e=[],{nodeExtensions:t,markExtensions:r}=La(n),i=[...t,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=N(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(f=>{Object.entries(u.attributes).forEach(([d,h])=>{e.push({type:f,name:d,attribute:{...o,...h}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=N(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,f])=>{const d={...o,...f};typeof d?.default=="function"&&(d.default=d.default()),d?.isRequired&&d?.default===void 0&&delete d.default,e.push({type:s.name,name:u,attribute:d})})}),e}function Ie(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function Re(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[f,d]=u.split(":").map(h=>h.trim());c.set(f,d)}),a.forEach(u=>{const[f,d]=u.split(":").map(h=>h.trim());c.set(f,d)}),r[i]=Array.from(c.entries()).map(([u,f])=>`${u}: ${f}`).join("; ")}else r[i]=o}),r},{})}function Wc(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>Re(t,r),{})}function By(n){return typeof n=="function"}function G(n,e=void 0,...t){return By(n)?e?n.bind(e)(...t):n(...t):n}function oO(n={}){return Object.keys(n).length===0&&n.constructor===Object}function sO(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function vh(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):sO(t.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function xh(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&oO(t)?!1:t!=null))}function aO(n,e){var t;const r=Ly(n),{nodeExtensions:i,markExtensions:o}=La(n),s=(t=i.find(c=>N(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(b=>b.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},d=n.reduce((b,x)=>{const w=N(x,"extendNodeSchema",f);return{...b,...w?w(c):{}}},{}),h=xh({...d,content:G(N(c,"content",f)),marks:G(N(c,"marks",f)),group:G(N(c,"group",f)),inline:G(N(c,"inline",f)),atom:G(N(c,"atom",f)),selectable:G(N(c,"selectable",f)),draggable:G(N(c,"draggable",f)),code:G(N(c,"code",f)),whitespace:G(N(c,"whitespace",f)),linebreakReplacement:G(N(c,"linebreakReplacement",f)),defining:G(N(c,"defining",f)),isolating:G(N(c,"isolating",f)),attrs:Object.fromEntries(u.map(b=>{var x;return[b.name,{default:(x=b?.attribute)===null||x===void 0?void 0:x.default}]}))}),p=G(N(c,"parseHTML",f));p&&(h.parseDOM=p.map(b=>vh(b,u)));const m=N(c,"renderHTML",f);m&&(h.toDOM=b=>m({node:b,HTMLAttributes:Wc(b,u)}));const g=N(c,"renderText",f);return g&&(h.toText=g),[c.name,h]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(g=>g.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},d=n.reduce((g,b)=>{const x=N(b,"extendMarkSchema",f);return{...g,...x?x(c):{}}},{}),h=xh({...d,inclusive:G(N(c,"inclusive",f)),excludes:G(N(c,"excludes",f)),group:G(N(c,"group",f)),spanning:G(N(c,"spanning",f)),code:G(N(c,"code",f)),attrs:Object.fromEntries(u.map(g=>{var b;return[g.name,{default:(b=g?.attribute)===null||b===void 0?void 0:b.default}]}))}),p=G(N(c,"parseHTML",f));p&&(h.parseDOM=p.map(g=>vh(g,u)));const m=N(c,"renderHTML",f);return m&&(h.toDOM=g=>m({mark:g,HTMLAttributes:Wc(g,u)})),[c.name,h]}));return new vg({topNode:s,nodes:a,marks:l})}function Ol(n,e){return e.nodes[n]||e.marks[n]||null}function Sh(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function cf(n,e){const t=Tr.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}const lO=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),t};function uf(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Ba{constructor(e){this.find=e.find,this.handler=e.handler}}const cO=(n,e)=>{if(uf(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function es(n){var e;const{editor:t,from:r,to:i,text:o,rules:s,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(d=>d.type.spec.code))return!1;let u=!1;const f=lO(c)+o;return s.forEach(d=>{if(u)return;const h=cO(f,d.find);if(!h)return;const p=l.state.tr,m=za({state:l.state,transaction:p}),g={from:r-(h[0].length-o.length),to:i},{commands:b,chain:x,can:w}=new ja({editor:t,state:m});d.handler({state:m,range:g,match:h,commands:b,chain:x,can:w})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:i,text:o}),l.dispatch(p),u=!0)}),u}function uO(n){const{editor:e,rules:t}=n,r=new Fe({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=cf(E.from(u),s.schema);const{from:f}=l,d=f+u.length;es({editor:e,from:f,to:d,text:u,rules:t,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return es({editor:e,from:o,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&es({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?es({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function fO(n){return Object.prototype.toString.call(n).slice(8,-1)}function ts(n){return fO(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Fa(n,e){const t={...n};return ts(n)&&ts(e)&&Object.keys(e).forEach(r=>{ts(e[r])&&ts(n[r])?t[r]=Fa(n[r],e[r]):t[r]=e[r]}),t}let Lo=class Hc{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=G(N(this,"addOptions",{name:this.name}))),this.storage=G(N(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Hc(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Fa(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Hc(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=G(N(t,"addOptions",{name:t.name})),t.storage=G(N(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>c?.type.name===t.name))return!1;const l=s.find(c=>c?.type.name===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}};function dO(n){return typeof n=="number"}class hO{constructor(e){this.find=e.find,this.handler=e.handler}}const pO=(n,e,t)=>{if(uf(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=n,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function mO(n){const{editor:e,state:t,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=n,{commands:l,chain:c,can:u}=new ja({editor:e,state:t}),f=[];return t.doc.nodesBetween(r,i,(h,p)=>{if(!h.isTextblock||h.type.spec.code)return;const m=Math.max(r,p),g=Math.min(i,p+h.content.size),b=h.textBetween(m-p,g-p,void 0,"");pO(b,o.find,s).forEach(w=>{if(w.index===void 0)return;const C=m+w.index+1,S=C+w[0].length,k={from:t.tr.mapping.map(C),to:t.tr.mapping.map(S)},O=o.handler({state:t,range:k,match:w,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});f.push(O)})}),f.every(h=>h!==null)}let ns=null;const gO=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function yO(n){const{editor:e,rules:t}=n;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:f,to:d,rule:h,pasteEvt:p})=>{const m=u.tr,g=za({state:u,transaction:m});if(!(!mO({editor:e,state:g,from:Math.max(f-1,0),to:d.b-1,rule:h,pasteEvent:p,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return t.map(u=>new Fe({view(f){const d=p=>{var m;r=!((m=f.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?f.dom.parentElement:null,r&&(ns=e)},h=()=>{ns&&(ns=null)};return window.addEventListener("dragstart",d),window.addEventListener("dragend",h),{destroy(){window.removeEventListener("dragstart",d),window.removeEventListener("dragend",h)}}},props:{handleDOMEvents:{drop:(f,d)=>{if(o=r===f.dom.parentElement,a=d,!o){const h=ns;h?.isEditable&&setTimeout(()=>{const p=h.state.selection;p&&h.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(f,d)=>{var h;const p=(h=d.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return s=d,i=!!p?.includes("data-pm-slice"),!1}}},appendTransaction:(f,d,h)=>{const p=f[0],m=p.getMeta("uiEvent")==="paste"&&!i,g=p.getMeta("uiEvent")==="drop"&&!o,b=p.getMeta("applyPasteRules"),x=!!b;if(!m&&!g&&!x)return;if(x){let{text:S}=b;typeof S=="string"?S=S:S=cf(E.from(S),h.schema);const{from:k}=b,O=k+S.length,M=gO(S);return l({rule:u,state:h,from:k,to:{b:O},pasteEvt:M})}const w=d.doc.content.findDiffStart(h.doc.content),C=d.doc.content.findDiffEnd(h.doc.content);if(!(!dO(w)||!C||w===C.b))return l({rule:u,state:h,from:w,to:C,pasteEvt:s})}}))}function bO(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class Qr{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Qr.resolve(e),this.schema=aO(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Qr.sort(Qr.flatten(e)),r=bO(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=N(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=N(r,"priority")||100,s=N(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Ol(t.name,this.schema)},i=N(t,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=Qr.sort([...this.extensions].reverse()),r=[],i=[],o=t.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:Ol(s.name,this.schema)},l=[],c=N(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&N(s,"exitable",a)&&(u.ArrowRight=()=>Lo.handleExit({editor:e,mark:s})),c){const m=Object.fromEntries(Object.entries(c()).map(([g,b])=>[g,()=>b({editor:e})]));u={...u,...m}}const f=jk(u);l.push(f);const d=N(s,"addInputRules",a);Sh(s,e.options.enableInputRules)&&d&&r.push(...d());const h=N(s,"addPasteRules",a);Sh(s,e.options.enablePasteRules)&&h&&i.push(...h());const p=N(s,"addProseMirrorPlugins",a);if(p){const m=p();l.push(...m)}return l}).flat();return[uO({editor:e,rules:r}),...yO({editor:e,rules:i}),...o]}get attributes(){return Ly(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=La(this.extensions);return Object.fromEntries(t.filter(r=>!!N(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:Ie(r.name,this.schema)},s=N(r,"addNodeView",o);if(!s)return[];const a=(l,c,u,f,d)=>{const h=Wc(l,i);return s()({node:l,view:c,getPos:u,decorations:f,innerDecorations:d,editor:e,extension:r,HTMLAttributes:h})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Ol(e.name,this.schema)};e.type==="mark"&&(!((t=G(N(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const i=N(e,"onBeforeCreate",r),o=N(e,"onCreate",r),s=N(e,"onUpdate",r),a=N(e,"onSelectionUpdate",r),l=N(e,"onTransaction",r),c=N(e,"onFocus",r),u=N(e,"onBlur",r),f=N(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),f&&this.editor.on("destroy",f)})}}let kt=class Vc{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=G(N(this,"addOptions",{name:this.name}))),this.storage=G(N(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Vc(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Fa(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Vc({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=G(N(t,"addOptions",{name:t.name})),t.storage=G(N(t,"addStorage",{name:t.name,options:t.options})),t}};function Fy(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=t||{};let a="";return n.nodesBetween(r,i,(l,c,u,f)=>{var d;l.isBlock&&c>r&&(a+=o);const h=s?.[l.type.name];if(h)return u&&(a+=h({node:l,pos:c,parent:u,index:f,range:e})),!1;l.isText&&(a+=(d=l?.text)===null||d===void 0?void 0:d.slice(Math.max(r,c)-c,i-c))}),a}function _y(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const wO=kt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Fe({key:new dt("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=_y(t);return Fy(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),vO=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),xO=(n=!1)=>({commands:e})=>e.setContent("",n),SO=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(l)),d=c.resolve(u.map(l+a.nodeSize)),h=f.blockRange(d);if(!h)return;const p=Si(h);if(a.type.isTextblock){const{defaultType:m}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},CO=n=>e=>n(e),kO=()=>({state:n,dispatch:e})=>Ny(n,e),OO=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new F(r.doc.resolve(Math.max(s-1,0)))),!0},MO=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1},EO=n=>({tr:e,state:t,dispatch:r})=>{const i=Ie(n,t.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},TO=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},RO=()=>({state:n,dispatch:e})=>rf(n,e),AO=()=>({commands:n})=>n.keyboardShortcut("Enter"),DO=()=>({state:n,dispatch:e})=>Hk(n,e);function Xs(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:uf(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function Wy(n,e,t={}){return n.find(r=>r.type===e&&Xs(Object.fromEntries(Object.keys(t).map(i=>[i,r.attrs[i]])),t))}function Ch(n,e,t={}){return!!Wy(n,e,t)}function ff(n,e,t){var r;if(!n||!e)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(t=t||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!Wy([...i.node.marks],e,t)))return;let s=i.index,a=n.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&Ch([...n.parent.child(s-1).marks],e,t);)s-=1,a-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&Ch([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Hn(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const $O=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=Hn(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:c,to:u}=a;if(i){const f=ff(l,o,e);if(f&&f.from<=c&&f.to>=u){const d=F.create(s,f.from,f.to);t.setSelection(d)}}return!0},PO=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Hy(n){return n instanceof F}function or(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function Vy(n,e=null){if(!e)return null;const t=B.atStart(n),r=B.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?F.create(n,or(0,i,o),or(n.content.size,i,o)):F.create(n,or(e,i,o),or(e,i,o))}function NO(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function df(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const IO=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(df()||NO())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!Hy(t.state.selection))return s(),!0;const a=Vy(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},zO=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),jO=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),qy=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&qy(r)}return n};function rs(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return qy(t)}function bo(n,e,t){if(n instanceof Dn||n instanceof E)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return E.fromArray(n.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),bo("",e,t)}if(i){if(t.errorOnInvalidContent){let s=!1,a="";const l=new vg({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?Qi.fromSchema(l).parseSlice(rs(n),t.parseOptions):Qi.fromSchema(l).parse(rs(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=Qi.fromSchema(e);return t.slice?o.parseSlice(rs(n),t.parseOptions).content:o.parse(rs(n),t.parseOptions)}return bo("",e,t)}function LO(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof Lt||i instanceof ft))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),n.setSelection(B.near(n.doc.resolve(s),t))}const BO=n=>!("type"in n),FO=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=g=>{o.emit("contentError",{editor:o,error:g,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{bo(e,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(g){l(g)}try{a=bo(e,o.schema,{parseOptions:c,errorOnInvalidContent:(s=t.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(g){return l(g),!1}let{from:u,to:f}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},d=!0,h=!0;if((BO(a)?a:[a]).forEach(g=>{g.check(),d=d?g.isText&&g.marks.length===0:!1,h=h?g.isBlock:!1}),u===f&&h){const{parent:g}=r.doc.resolve(u);g.isTextblock&&!g.type.spec.code&&!g.childCount&&(u-=1,f+=1)}let m;if(d){if(Array.isArray(e))m=e.map(g=>g.text||"").join("");else if(e instanceof E){let g="";e.forEach(b=>{b.text&&(g+=b.text)}),m=g}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,u,f)}else m=a,r.replaceWith(u,f,m);t.updateSelection&&LO(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:m}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:m})}return!0},_O=()=>({state:n,dispatch:e})=>Fk(n,e),WO=()=>({state:n,dispatch:e})=>_k(n,e),HO=()=>({state:n,dispatch:e})=>Ey(n,e),VO=()=>({state:n,dispatch:e})=>Dy(n,e),qO=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Da(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},GO=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Da(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},JO=()=>({state:n,dispatch:e})=>Lk(n,e),UO=()=>({state:n,dispatch:e})=>Bk(n,e);function Gy(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function KO(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))df()||Gy()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const YO=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=KO(n).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l?.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function wo(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,s=e?Ie(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(f,d)=>{if(f.isText)return;const h=Math.max(r,d),p=Math.min(i,d+f.nodeSize);a.push({node:f,from:h,to:p})});const l=i-r,c=a.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>Xs(f.node.attrs,t,{strict:!1}));return o?!!c.length:c.reduce((f,d)=>f+d.to-d.from,0)>=l}const XO=(n,e={})=>({state:t,dispatch:r})=>{const i=Ie(n,t.schema);return wo(t,i,e)?Wk(t,r):!1},QO=()=>({state:n,dispatch:e})=>Iy(n,e),ZO=n=>({state:e,dispatch:t})=>{const r=Ie(n,e.schema);return eO(r)(e,t)},eM=()=>({state:n,dispatch:e})=>Py(n,e);function _a(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function kh(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const tM=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=_a(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Ie(n,r.schema)),a==="mark"&&(s=Hn(n,r.schema)),i&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&t.setNodeMarkup(u,void 0,kh(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(f=>{s===f.type&&t.addMark(u,u+c.nodeSize,s.create(kh(f.attrs,e)))})})}),!0):!1},nM=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),rM=()=>({tr:n,dispatch:e})=>{if(e){const t=new gn(n.doc);n.setSelection(t)}return!0},iM=()=>({state:n,dispatch:e})=>Ry(n,e),oM=()=>({state:n,dispatch:e})=>$y(n,e),sM=()=>({state:n,dispatch:e})=>Gk(n,e),aM=()=>({state:n,dispatch:e})=>Kk(n,e),lM=()=>({state:n,dispatch:e})=>Uk(n,e);function qc(n,e,t={},r={}){return bo(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const cM=(n,e=!1,t={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;const{doc:u}=o;if(t.preserveWhitespace!=="full"){const f=qc(n,i.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,f).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function Jy(n,e){const t=Hn(e,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function uM(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function Uy(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function hf(n){return e=>Uy(e.$from,n)}function fM(n,e){const t={from:0,to:n.content.size};return Fy(n,t,e)}function dM(n,e){const t=Ie(e,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function hM(n,e){const t=_a(typeof e=="string"?e:e.name,n.schema);return t==="node"?dM(n,e):t==="mark"?Jy(n,e):{}}function Ky(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const o=t.resolve(n),s=ff(o,i.type);s&&r.push({mark:i,...s})}):t.nodesBetween(n,e,(i,o)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function ks(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function Gc(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?Hn(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>Xs(f.attrs,t,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:f,$to:d})=>{const h=f.pos,p=d.pos;n.doc.nodesBetween(h,p,(m,g)=>{if(!m.isText&&!m.marks.length)return;const b=Math.max(h,g),x=Math.min(p,g+m.nodeSize),w=x-b;s+=w,a.push(...m.marks.map(C=>({mark:C,from:b,to:x})))})}),s===0)return!1;const l=a.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>Xs(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),c=a.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+c:l)>=s}function pM(n,e,t={}){if(!e)return wo(n,null,t)||Gc(n,null,t);const r=_a(e,n.schema);return r==="node"?wo(n,e,t):r==="mark"?Gc(n,e,t):!1}function Oh(n,e){const{nodeExtensions:t}=La(e),r=t.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=G(N(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Wa(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let i=!0;return n.content.forEach(o=>{i!==!1&&(Wa(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function mM(n){return n instanceof j}function gM(n,e,t){var r;const{selection:i}=e;let o=null;if(Hy(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,f,d)=>{if(c)return!1;if(u.isInline){const h=!d||d.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=h&&p}return!c}),c})}const yM=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:s,ranges:a}=o,l=Hn(n,r.schema);if(i)if(s){const c=Jy(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(u,f,(d,h)=>{const p=Math.max(h,u),m=Math.min(h+d.nodeSize,f);d.marks.find(b=>b.type===l)?d.marks.forEach(b=>{l===b.type&&t.addMark(p,m,l.create({...b.attrs,...e}))}):t.addMark(p,m,l.create(e))})});return gM(r,t,l)},bM=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),wM=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=Ie(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>wh(o,{...s,...e})(t)?!0:a.clearNodes()).command(({state:a})=>wh(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},vM=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=or(n,0,r.content.size),o=j.create(r,i);e.setSelection(o)}return!0},xM=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=F.atStart(r).from,a=F.atEnd(r).to,l=or(i,s,a),c=or(o,s,a),u=F.create(r,l,c);e.setSelection(u)}return!0},SM=n=>({state:e,dispatch:t})=>{const r=Ie(n,e.schema);return rO(r)(e,t)};function Mh(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e?.includes(i.type.name));n.tr.ensureMarks(r)}}const CM=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=ks(c,a.node().type.name,a.node().attrs);if(o instanceof j&&o.node.isBlock)return!a.parentOffset||!mn(s,a.pos)?!1:(r&&(n&&Mh(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,d=a.depth===0?void 0:uM(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=f&&d?[{type:d,attrs:u}]:void 0,p=mn(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!p&&mn(e.doc,e.mapping.map(a.pos),1,d?[{type:d}]:void 0)&&(p=!0,h=d?[{type:d,attrs:u}]:void 0),r){if(p&&(o instanceof F&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,h),d&&!f&&!a.parentOffset&&a.parent.type!==d)){const m=e.mapping.map(a.before()),g=e.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,d)&&e.setNodeMarkup(e.mapping.map(a.before()),d)}n&&Mh(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return p},kM=(n,e={})=>({tr:t,state:r,dispatch:i,editor:o})=>{var s;const a=Ie(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const f=l.node(-1);if(f.type!==a)return!1;const d=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let b=E.empty;const x=l.index(-1)?1:l.index(-2)?2:3;for(let M=l.depth-x;M>=l.depth-3;M-=1)b=E.from(l.node(M).copy(b));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,C={...ks(d,l.node().type.name,l.node().attrs),...e},S=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(C))||void 0;b=b.append(E.from(a.createAndFill(null,S)||void 0));const k=l.before(l.depth-(x-1));t.replace(k,l.after(-w),new D(b,4-x,0));let O=-1;t.doc.nodesBetween(k,t.doc.content.size,(M,R)=>{if(O>-1)return!1;M.isTextblock&&M.content.size===0&&(O=R+1)}),O>-1&&t.setSelection(F.near(t.doc.resolve(O))),t.scrollIntoView()}return!0}const h=c.pos===l.end()?f.contentMatchAt(0).defaultType:null,p={...ks(d,f.type.name,f.attrs),...e},m={...ks(d,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const g=h?[{type:a,attrs:p},{type:h,attrs:m}]:[{type:a,attrs:p}];if(!mn(t.doc,l.pos,2))return!1;if(i){const{selection:b,storedMarks:x}=r,{splittableMarks:w}=o.extensionManager,C=x||b.$to.parentOffset&&b.$from.marks();if(t.split(l.pos,2,g).scrollIntoView(),!C||!i)return!0;const S=C.filter(k=>w.includes(k.type.name));t.ensureMarks(S)}return!0},Ml=(n,e)=>{const t=hf(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&_n(n.doc,t.pos)&&n.join(t.pos),!0},El=(n,e)=>{const t=hf(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&_n(n.doc,r)&&n.join(r),!0},OM=(n,e,t,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:f,splittableMarks:d}=i.extensionManager,h=Ie(n,s.schema),p=Ie(e,s.schema),{selection:m,storedMarks:g}=s,{$from:b,$to:x}=m,w=b.blockRange(x),C=g||m.$to.parentOffset&&m.$from.marks();if(!w)return!1;const S=hf(k=>Oh(k.type.name,f))(m);if(w.depth>=1&&S&&w.depth-S.depth<=1){if(S.node.type===h)return c.liftListItem(p);if(Oh(S.node.type.name,f)&&h.validContent(S.node.content)&&a)return l().command(()=>(o.setNodeMarkup(S.pos,h),!0)).command(()=>Ml(o,h)).command(()=>El(o,h)).run()}return!t||!C||!a?l().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>Ml(o,h)).command(()=>El(o,h)).run():l().command(()=>{const k=u().wrapInList(h,r),O=C.filter(M=>d.includes(M.type.name));return o.ensureMarks(O),k?!0:c.clearNodes()}).wrapInList(h,r).command(()=>Ml(o,h)).command(()=>El(o,h)).run()},MM=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,s=Hn(n,r.schema);return Gc(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},EM=(n,e,t={})=>({state:r,commands:i})=>{const o=Ie(n,r.schema),s=Ie(e,r.schema),a=wo(r,o,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...t})},TM=(n,e={})=>({state:t,commands:r})=>{const i=Ie(n,t.schema);return wo(t,i,e)?r.lift(i):r.wrapIn(i,e)},RM=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const s=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},AM=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},DM=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=Hn(n,r.schema),{$from:c,empty:u,ranges:f}=a;if(!i)return!0;if(u&&s){let{from:d,to:h}=a;const p=(o=c.marks().find(g=>g.type===l))===null||o===void 0?void 0:o.attrs,m=ff(c,l,p);m&&(d=m.from,h=m.to),t.removeMark(d,h,l)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,l)});return t.removeStoredMark(l),!0},$M=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=_a(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Ie(n,r.schema)),a==="mark"&&(s=Hn(n,r.schema)),i&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let f,d,h,p;t.selection.empty?r.doc.nodesBetween(c,u,(m,g)=>{o&&o===m.type&&(h=Math.max(g,c),p=Math.min(g+m.nodeSize,u),f=g,d=m)}):r.doc.nodesBetween(c,u,(m,g)=>{g<c&&o&&o===m.type&&(h=Math.max(g,c),p=Math.min(g+m.nodeSize,u),f=g,d=m),g>=c&&g<=u&&(o&&o===m.type&&t.setNodeMarkup(g,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(b=>{if(s===b.type){const x=Math.max(g,c),w=Math.min(g+m.nodeSize,u);t.addMark(x,w,s.create({...b.attrs,...e}))}}))}),d&&(f!==void 0&&t.setNodeMarkup(f,void 0,{...d.attrs,...e}),s&&d.marks.length&&d.marks.forEach(m=>{s===m.type&&t.addMark(h,p,s.create({...m.attrs,...e}))}))}),!0):!1},PM=(n,e={})=>({state:t,dispatch:r})=>{const i=Ie(n,t.schema);return Yk(i,e)(t,r)},NM=(n,e={})=>({state:t,dispatch:r})=>{const i=Ie(n,t.schema);return Xk(i,e)(t,r)};var IM=Object.freeze({__proto__:null,blur:vO,clearContent:xO,clearNodes:SO,command:CO,createParagraphNear:kO,cut:OO,deleteCurrentNode:MO,deleteNode:EO,deleteRange:TO,deleteSelection:RO,enter:AO,exitCode:DO,extendMarkRange:$O,first:PO,focus:IO,forEach:zO,insertContent:jO,insertContentAt:FO,joinBackward:HO,joinDown:WO,joinForward:VO,joinItemBackward:qO,joinItemForward:GO,joinTextblockBackward:JO,joinTextblockForward:UO,joinUp:_O,keyboardShortcut:YO,lift:XO,liftEmptyBlock:QO,liftListItem:ZO,newlineInCode:eM,resetAttributes:tM,scrollIntoView:nM,selectAll:rM,selectNodeBackward:iM,selectNodeForward:oM,selectParentNode:sM,selectTextblockEnd:aM,selectTextblockStart:lM,setContent:cM,setMark:yM,setMeta:bM,setNode:wM,setNodeSelection:vM,setTextSelection:xM,sinkListItem:SM,splitBlock:CM,splitListItem:kM,toggleList:OM,toggleMark:MM,toggleNode:EM,toggleWrap:TM,undoInputRule:RM,unsetAllMarks:AM,unsetMark:DM,updateAttributes:$M,wrapIn:PM,wrapInList:NM});const zM=kt.create({name:"commands",addCommands(){return{...IM}}}),jM=kt.create({name:"drop",addProseMirrorPlugins(){return[new Fe({key:new dt("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),LM=kt.create({name:"editable",addProseMirrorPlugins(){return[new Fe({key:new dt("editable"),props:{editable:()=>this.editor.options.editable}})]}}),BM=new dt("focusEvents"),FM=kt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Fe({key:BM,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),_M=kt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:f}=l,{pos:d,parent:h}=f,p=f.parent.isTextblock&&d>0?a.doc.resolve(d-1):f,m=p.parent.type.spec.isolating,g=f.pos-f.parentOffset,b=m&&p.parent.childCount===1?g===f.pos:B.atStart(c).from===d;return!u||!h.type.isTextblock||h.textContent.length||!b||b&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return df()||Gy()?o:i},addProseMirrorPlugins(){return[new Fe({key:new dt("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!e.doc.eq(t.doc),i=n.some(m=>m.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=B.atStart(e.doc).from,c=B.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!Wa(t.doc))return;const d=t.tr,h=za({state:t,transaction:d}),{commands:p}=new ja({editor:this.editor,state:h});if(p.clearNodes(),!!d.steps.length)return d}})]}}),WM=kt.create({name:"paste",addProseMirrorPlugins(){return[new Fe({key:new dt("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),HM=kt.create({name:"tabindex",addProseMirrorPlugins(){return[new Fe({key:new dt("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Qn{get name(){return this.node.type.name}constructor(e,t,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Qn(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Qn(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Qn(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,s=this.pos+r+(o?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new Qn(a,this.editor,i,i?t:null);i&&(l.actualDepth=this.depth+1),e.push(new Qn(a,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(t).length>0){const o=i.node.attrs,s=Object.keys(t);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==t[l])break}}else r=i;i=i.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(t);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>t[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,t,r))))}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const VM=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function qM(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}class GM extends iO{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:i})=>this.options.onDrop(t,r,i)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=qM(VM,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=By(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=r.filter(a=>!a.key.startsWith(s))}),t.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,t;const i=[...this.options.enableCoreExtensions?[LM,wO.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),zM,FM,_M,HM,jM,WM].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o?.type));this.extensionManager=new Qr(i,this)}createCommandManager(){this.commandManager=new ja({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=qc(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=qc(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=Vy(t,this.options.autofocus);this.view=new Oy(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:Xr.create({doc:t,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return hM(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return pM(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return cf(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return fM(this.state.doc,{blockSeparator:t,textSerializers:{..._y(this.schema),...r}})}get isEmpty(){return Wa(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Qn(t,this)}get $doc(){return this.$pos(0)}}function hi(n){return new Ba({find:n.find,handler:({state:e,range:t,match:r})=>{const i=G(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=t.from+a.indexOf(s),u=c+s.length;if(Ky(t.from,t.to,e.doc).filter(h=>h.mark.type.excluded.find(m=>m===n.type&&m!==h.mark.type)).filter(h=>h.to>c).length)return null;u<t.to&&o.delete(u,t.to),c>t.from&&o.delete(t.from+l,c);const d=t.from+l+s.length;o.addMark(t.from+l,d,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function JM(n){return new Ba({find:n.find,handler:({state:e,range:t,match:r})=>{const i=G(n.getAttributes,void 0,r)||{},{tr:o}=e,s=t.from;let a=t.to;const l=n.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const f=r[0][r[0].length-1];o.insertText(f,s+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?s:s-1;o.insert(c,n.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})}function Jc(n){return new Ba({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),o=G(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)}})}function vo(n){return new Ba({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const o=G(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),c=l&&Ju(l,n.type,o);if(!c)return null;if(s.wrap(l,c),n.keepMarks&&n.editor){const{selection:f,storedMarks:d}=e,{splittableMarks:h}=n.editor.extensionManager,p=d||f.$to.parentOffset&&f.$from.marks();if(p){const m=p.filter(g=>h.includes(g.type.name));s.ensureMarks(m)}}if(n.keepAttributes){const f=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,o).run()}const u=s.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&_n(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&s.join(t.from-1)}})}let st=class Uc{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=G(N(this,"addOptions",{name:this.name}))),this.storage=G(N(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Uc(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Fa(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Uc(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=G(N(t,"addOptions",{name:t.name})),t.storage=G(N(t,"addStorage",{name:t.name,options:t.options})),t}};function pi(n){return new hO({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const o=G(n.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),f=t.from+l.indexOf(a),d=f+a.length;if(Ky(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(g=>g===n.type&&g!==p.mark.type)).filter(p=>p.to>f).length)return null;d<t.to&&s.delete(d,t.to),f>t.from&&s.delete(t.from+u,f),c=t.from+u+a.length,s.addMark(t.from+u,c,n.type.create(o||{})),s.removeStoredMark(n.type)}}})}function UM(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof j){const o=r.index();return r.parent.canReplaceWith(o,o+1,e)}let i=r.depth;for(;i>=0;){const o=r.index(i);if(r.node(i).contentMatchAt(o).matchType(e))return!0;i-=1}return!1}function KM(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Yy={exports:{}},Tl={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eh;function YM(){return Eh||(Eh=1,function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var n=tt,e=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function t(w){{for(var C=arguments.length,S=new Array(C>1?C-1:0),k=1;k<C;k++)S[k-1]=arguments[k];r("error",w,S)}}function r(w,C,S){{var k=e.ReactDebugCurrentFrame,O=k.getStackAddendum();O!==""&&(C+="%s",S=S.concat([O]));var M=S.map(function(R){return String(R)});M.unshift("Warning: "+C),Function.prototype.apply.call(console[w],console,M)}}function i(w,C){return w===C&&(w!==0||1/w===1/C)||w!==w&&C!==C}var o=typeof Object.is=="function"?Object.is:i,s=n.useState,a=n.useEffect,l=n.useLayoutEffect,c=n.useDebugValue,u=!1,f=!1;function d(w,C,S){u||n.startTransition!==void 0&&(u=!0,t("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var k=C();if(!f){var O=C();o(k,O)||(t("The result of getSnapshot should be cached to avoid an infinite loop"),f=!0)}var M=s({inst:{value:k,getSnapshot:C}}),R=M[0].inst,T=M[1];return l(function(){R.value=k,R.getSnapshot=C,h(R)&&T({inst:R})},[w,k,C]),a(function(){h(R)&&T({inst:R});var P=function(){h(R)&&T({inst:R})};return w(P)},[w]),c(k),k}function h(w){var C=w.getSnapshot,S=w.value;try{var k=C();return!o(S,k)}catch{return!0}}function p(w,C,S){return C()}var m=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",g=!m,b=g?p:d,x=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:b;Tl.useSyncExternalStore=x,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Tl}Yy.exports=YM();var pf=Yy.exports;const XM=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},QM=({contentComponent:n})=>{const e=pf.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return tt.createElement(tt.Fragment,null,Object.values(e))};function ZM(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:om.createPortal(r.reactElement,r.element,t)},n.forEach(i=>i())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(i=>i())}}}class eE extends tt.Component{constructor(e){var t;super(e),this.editorContentRef=tt.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=ZM(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return tt.createElement(tt.Fragment,null,tt.createElement("div",{ref:XM(t,this.editorContentRef),...r}),e?.contentComponent&&tt.createElement(QM,{contentComponent:e.contentComponent}))}}const tE=v.forwardRef((n,e)=>{const t=tt.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return tt.createElement(eE,{key:t,innerRef:e,...n})}),nE=tt.memo(tE);var rE=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(!n(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;for(i of e.entries())if(!n(i[1],t.get(i[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!n(e[s],t[s]))return!1}return!0}return e!==e&&t!==t},iE=KM(rE),Xy={exports:{}},Rl={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Th;function oE(){return Th||(Th=1,function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var n=tt,e=pf;function t(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,o=n.useRef,s=n.useEffect,a=n.useMemo,l=n.useDebugValue;function c(u,f,d,h,p){var m=o(null),g;m.current===null?(g={hasValue:!1,value:null},m.current=g):g=m.current;var b=a(function(){var S=!1,k,O,M=function(z){if(!S){S=!0,k=z;var U=h(z);if(p!==void 0&&g.hasValue){var H=g.value;if(p(H,U))return O=H,H}return O=U,U}var Se=k,J=O;if(r(Se,z))return J;var oe=h(z);return p!==void 0&&p(J,oe)?J:(k=z,O=oe,oe)},R=d===void 0?null:d,T=function(){return M(f())},P=R===null?void 0:function(){return M(R())};return[T,P]},[f,d,h,p]),x=b[0],w=b[1],C=i(u,x,w);return s(function(){g.hasValue=!0,g.value=C},[C]),l(C),C}Rl.useSyncExternalStoreWithSelector=c,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Rl}Xy.exports=oE();var sE=Xy.exports;const aE=typeof window<"u"?v.useLayoutEffect:v.useEffect;class lE{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}}function cE(n){var e;const[t]=v.useState(()=>new lE(n.editor)),r=sE.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!==null&&e!==void 0?e:iE);return aE(()=>t.watch(n.editor),[n.editor,t]),v.useDebugValue(r),r}const uE=!0,Kc=typeof window>"u",fE=Kc||!!(typeof window<"u"&&window.next);class mf{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return Kc||fE?(console.warn("Tiptap Error: SSR has been detected, please set `immediatelyRender` explicitly to `false` to avoid hydration mismatches."),null):this.createEditor();if(this.options.current.immediatelyRender&&Kc&&uE)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new GM(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=t.extensions)===null||s===void 0?void 0:s[o])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?mf.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function dE(n={},e=[]){const t=v.useRef(n);t.current=n;const[r]=v.useState(()=>new mf(t)),i=pf.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return v.useDebugValue(i),v.useEffect(r.onRender(e)),cE({editor:i,selector:({transactionNumber:o})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&o===0?0:o+1}),i}const hE=v.createContext({editor:null});hE.Consumer;const pE=v.createContext({onDragStart:void 0}),mE=()=>v.useContext(pE);tt.forwardRef((n,e)=>{const{onDragStart:t}=mE(),r=n.as||"div";return tt.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const gE=/^\s*>\s$/,yE=st.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[vo({find:gE,type:this.type})]}}),bE=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,wE=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,vE=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,xE=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Qy=Lo.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[hi({find:bE,type:this.type}),hi({find:vE,type:this.type})]},addPasteRules(){return[pi({find:wE,type:this.type}),pi({find:xE,type:this.type})]}}),SE="listItem",Rh="textStyle",Ah=/^\s*([-+*])\s$/,CE=st.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(SE,this.editor.getAttributes(Rh)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=vo({find:Ah,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=vo({find:Ah,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Rh),editor:this.editor})),[n]}}),kE=/(^|[^`])`([^`]+)`(?!`)/,OE=/(^|[^`])`([^`]+)`(?!`)/g,ME=Lo.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[hi({find:kE,type:this.type})]},addPasteRules(){return[pi({find:OE,type:this.type})]}}),EE=/^```([a-z]+)?[\s\n]$/,TE=/^~~~([a-z]+)?[\s\n]$/,RE=st.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",Re(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(B.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[Jc({find:EE,type:this.type,getAttributes:n=>({language:n[1]})}),Jc({find:TE,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Fe({key:new dt("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i?.mode;if(!t||!o)return!1;const{tr:s,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(F.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),AE=st.create({name:"doc",topNode:!0,content:"block+"});function DE(n={}){return new Fe({view(e){return new $E(e,n)}})}class $E{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,i=this.editorView.dom,o=i.getBoundingClientRect(),s=o.width/i.offsetWidth,a=o.height/i.offsetHeight;if(t){let f=e.nodeBefore,d=e.nodeAfter;if(f||d){let h=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(h){let p=h.getBoundingClientRect(),m=f?p.bottom:p.top;f&&d&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let g=this.width/2*a;r={left:p.left,right:p.right,top:m-g,bottom:m+g}}}}if(!r){let f=this.editorView.coordsAtPos(this.cursorPos),d=this.width/2*s;r={left:f.left-d,right:f.left+d,top:f.top,bottom:f.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let f=l.getBoundingClientRect(),d=f.width/l.offsetWidth,h=f.height/l.offsetHeight;c=f.left-l.scrollLeft*d,u=f.top-l.scrollTop*h}this.element.style.left=(r.left-c)/s+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Dg(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const PE=kt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[DE(this.options)]}});class we extends B{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return we.valid(r)?new we(r):B.near(r)}content(){return D.empty}eq(e){return e instanceof we&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new we(e.resolve(t.pos))}getBookmark(){return new gf(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!NE(e)||!IE(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&we.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let l=e.doc.resolve(i);if(we.valid(l))return l}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!j.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let a=e.doc.resolve(i);if(we.valid(a))return a}return null}}}we.prototype.visible=!1;we.findFrom=we.findGapCursorFrom;B.jsonID("gapcursor",we);class gf{constructor(e){this.pos=e}map(e){return new gf(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return we.valid(t)?new we(t):B.near(t)}}function Zy(n){return n.isAtom||n.spec.isolating||n.spec.createGapCursor}function NE(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||Zy(i.type))return!0;if(i.inlineContent)return!1}}return!0}function IE(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||Zy(i.type))return!0;if(i.inlineContent)return!1}}return!0}function zE(){return new Fe({props:{decorations:FE,createSelectionBetween(n,e,t){return e.pos==t.pos&&we.valid(t)?new we(t):null},handleClick:LE,handleKeyDown:jE,handleDOMEvents:{beforeinput:BE}}})}const jE=nf({ArrowLeft:is("horiz",-1),ArrowRight:is("horiz",1),ArrowUp:is("vert",-1),ArrowDown:is("vert",1)});function is(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof F){if(!o.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=we.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new we(c))),!0):!1}}function LE(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!we.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&j.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new we(r))),!0)}function BE(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof we))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=E.empty;for(let s=r.length-1;s>=0;s--)i=E.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new D(i,0,0));return o.setSelection(F.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function FE(n){if(!(n.selection instanceof we))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",ge.create(n.doc,[Ge.widget(n.selection.head,e,{key:"gapcursor"})])}const _E=kt.create({name:"gapCursor",addProseMirrorPlugins(){return[zE()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=G(N(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),WE=st.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Re(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const f=l.filter(d=>a.includes(d.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),e0=st.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Re(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Jc({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Qs=200,Ne=function(){};Ne.prototype.append=function(e){return e.length?(e=Ne.from(e),!this.length&&e||e.length<Qs&&this.leafAppend(e)||this.length<Qs&&e.leafPrepend(this)||this.appendInner(e)):this};Ne.prototype.prepend=function(e){return e.length?Ne.from(e).append(this):this};Ne.prototype.appendInner=function(e){return new HE(this,e)};Ne.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?Ne.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};Ne.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Ne.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};Ne.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},t,r),i};Ne.from=function(e){return e instanceof Ne?e:e&&e.length?new t0(e):Ne.empty};var t0=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Qs)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Qs)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(Ne);Ne.empty=new t0([]);var HE=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Ne);const VE=500;class It{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;t&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((f,d)=>{if(!f.step){i||(i=this.remapping(r,d+1),o=i.maps.length),o--,u.push(f);return}if(i){u.push(new Jt(f.map));let h=f.step.map(i.slice(o)),p;h&&s.maybeStep(h).doc&&(p=s.mapping.maps[s.mapping.maps.length-1],c.push(new Jt(p,void 0,void 0,c.length+u.length))),o--,p&&i.appendMap(p,o)}else s.maybeStep(f.step);if(f.selection)return a=i?f.selection.map(i.slice(o)):f.selection,l=new It(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,t,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),d=new Jt(e.mapping.maps[u],f,t),h;(h=l&&l.merge(d))&&(d=h,u?o.pop():a=a.slice(0,a.length-1)),o.push(d),t&&(s++,t=void 0),i||(l=d)}let c=s-r.depth;return c>GE&&(a=qE(a,c),s-=c),new It(a.append(o),s)}remapping(e,t){let r=new po;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new It(this.items.append(e.map(t=>new Jt(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(d=>{d.selection&&a--},i);let l=t;this.items.forEach(d=>{let h=o.getMirror(--l);if(h==null)return;s=Math.min(s,h);let p=o.maps[h];if(d.step){let m=e.steps[h].invert(e.docs[h]),g=d.selection&&d.selection.map(o.slice(l+1,h));g&&a++,r.push(new Jt(p,m,g))}else r.push(new Jt(p))},i);let c=[];for(let d=t;d<s;d++)c.push(new Jt(o.maps[d]));let u=this.items.slice(0,i).append(c).append(r),f=new It(u,a);return f.emptyItemCount()>VE&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=s.selection&&s.selection.map(t.slice(r));u&&o++;let f=new Jt(c.invert(),l,u),d,h=i.length-1;(d=i.length&&i[h].merge(f))?i[h]=d:i.push(f)}}else s.map&&r--},this.items.length,0),new It(Ne.from(i.reverse()),o)}}It.empty=new It(Ne.empty,0);function qE(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class Jt{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Jt(t.getMap().invert(),t,this.selection)}}}class Mn{constructor(e,t,r,i,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const GE=20;function JE(n,e,t,r){let i=t.getMeta(mr),o;if(i)return i.historyState;t.getMeta(YE)&&(n=new Mn(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(mr))return s.getMeta(mr).redo?new Mn(n.done.addTransform(t,void 0,r,Os(e)),n.undone,Dh(t.mapping.maps),n.prevTime,n.prevComposition):new Mn(n.done,n.undone.addTransform(t,void 0,r,Os(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!UE(t,n.prevRanges)),c=s?Al(n.prevRanges,t.mapping):Dh(t.mapping.maps);return new Mn(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Os(e)),It.empty,c,t.time,a??n.prevComposition)}else return(o=t.getMeta("rebased"))?new Mn(n.done.rebased(t,o),n.undone.rebased(t,o),Al(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Mn(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Al(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function UE(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function Dh(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,i,o,s)=>e.push(o,s));return e}function Al(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),o=e.map(n[r+1],-1);i<=o&&t.push(i,o)}return t}function KE(n,e,t){let r=Os(e),i=mr.get(e).spec.config,o=(t?n.undone:n.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(t?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new Mn(t?a:o.remaining,t?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(mr,{redo:t,historyState:l})}let Dl=!1,$h=null;function Os(n){let e=n.plugins;if($h!=e){Dl=!1,$h=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Dl=!0;break}}return Dl}const mr=new dt("history"),YE=new dt("closeHistory");function XE(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Fe({key:mr,state:{init(){return new Mn(It.empty,It.empty,null,0,-1)},apply(e,t,r){return JE(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?r0:r=="historyRedo"?i0:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function n0(n,e){return(t,r)=>{let i=mr.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let o=KE(i,t,n);o&&r(e?o.scrollIntoView():o)}return!0}}const r0=n0(!1,!0),i0=n0(!0,!0),QE=kt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>r0(n,e),redo:()=>({state:n,dispatch:e})=>i0(n,e)}},addProseMirrorPlugins(){return[XE(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),ZE=st.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Re(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!UM(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$from:r,$to:i}=t,o=n();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):mM(t)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(F.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(j.create(s.doc,c.pos)):s.setSelection(F.create(s.doc,c.pos));else{const f=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();f&&(s.insert(u,f),s.setSelection(F.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[JM({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),eT=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,tT=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,nT=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,rT=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,o0=Lo.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[hi({find:eT,type:this.type}),hi({find:nT,type:this.type})]},addPasteRules(){return[pi({find:tT,type:this.type}),pi({find:rT,type:this.type})]}}),iT=st.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Re(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),oT="listItem",Ph="textStyle",Nh=/^(\d+)\.\s$/,sT=st.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",Re(this.options.HTMLAttributes,t),0]:["ol",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(oT,this.editor.getAttributes(Ph)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=vo({find:Nh,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=vo({find:Nh,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Ph)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),s0=st.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),aT=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,lT=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,cT=Lo.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Re(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[hi({find:aT,type:this.type})]},addPasteRules(){return[pi({find:lT,type:this.type})]}}),uT=st.create({name:"text",group:"inline"}),fT=kt.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(Qy.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(yE.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(CE.configure(this.options.bulletList)),this.options.code!==!1&&n.push(ME.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(RE.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(AE.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(PE.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(_E.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(WE.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(e0.configure(this.options.heading)),this.options.history!==!1&&n.push(QE.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(ZE.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(o0.configure(this.options.italic)),this.options.listItem!==!1&&n.push(iT.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(sT.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(s0.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(cT.configure(this.options.strike)),this.options.text!==!1&&n.push(uT.configure(this.options.text)),n}}),dT=kt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Fe({key:new dt("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!t)return null;const o=this.editor.isEmpty;return n.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,c=!s.isLeaf&&Wa(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const f=Ge.node(a,a+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(f)}return this.options.includeChildren}),ge.create(n,i)}}})]}});var Yc,Xc;if(typeof WeakMap<"u"){let n=new WeakMap;Yc=e=>n.get(e),Xc=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Yc=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},Xc=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var ve=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let o=r+1,s=i+1;for(let a=1;o<this.width&&this.map[e+a]==t;a++)o++;for(let a=1;s<this.height&&this.map[e+this.width*a]==t;a++)s++;return{left:r,top:i,right:o,bottom:s}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:o,bottom:s}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[o*this.width+(t<0?r-1:i)]:(t<0?o==0:s==this.height)?null:this.map[r+this.width*(t<0?o-1:s)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:o}=this.findCell(n),{left:s,right:a,top:l,bottom:c}=this.findCell(e);return{left:Math.min(t,s),top:Math.min(i,l),right:Math.max(r,a),bottom:Math.max(o,c)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const o=r*this.width+i,s=this.map[o];t[s]||(t[s]=!0,!(i==n.left&&i&&this.map[o-1]==s||r==n.top&&r&&this.map[o-this.width]==s)&&e.push(s))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const o=i+t.child(r).nodeSize;if(r==n){let s=e+n*this.width;const a=(n+1)*this.width;for(;s<a&&this.map[s]<i;)s++;return s==a?o-1:this.map[s]}i=o}}static get(n){return Yc(n)||Xc(n,hT(n))}};function hT(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=pT(n),t=n.childCount,r=[];let i=0,o=null;const s=[];for(let c=0,u=e*t;c<u;c++)r[c]=0;for(let c=0,u=0;c<t;c++){const f=n.child(c);u++;for(let p=0;;p++){for(;i<r.length&&r[i]!=0;)i++;if(p==f.childCount)break;const m=f.child(p),{colspan:g,rowspan:b,colwidth:x}=m.attrs;for(let w=0;w<b;w++){if(w+c>=t){(o||(o=[])).push({type:"overlong_rowspan",pos:u,n:b-w});break}const C=i+w*e;for(let S=0;S<g;S++){r[C+S]==0?r[C+S]=u:(o||(o=[])).push({type:"collision",row:c,pos:u,n:g-S});const k=x&&x[S];if(k){const O=(C+S)%e*2,M=s[O];M==null||M!=k&&s[O+1]==1?(s[O]=k,s[O+1]=1):M==k&&s[O+1]++}}}i+=g,u+=m.nodeSize}const d=(c+1)*e;let h=0;for(;i<d;)r[i++]==0&&h++;h&&(o||(o=[])).push({type:"missing",row:c,n:h}),u++}(e===0||t===0)&&(o||(o=[])).push({type:"zero_sized"});const a=new ve(e,t,r,o);let l=!1;for(let c=0;!l&&c<s.length;c+=2)s[c]!=null&&s[c+1]<t&&(l=!0);return l&&mT(a,s,n),a}function pT(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let o=0;if(t)for(let s=0;s<r;s++){const a=n.child(s);for(let l=0;l<a.childCount;l++){const c=a.child(l);s+c.attrs.rowspan>r&&(o+=c.attrs.colspan)}}for(let s=0;s<i.childCount;s++){const a=i.child(s);o+=a.attrs.colspan,a.attrs.rowspan>1&&(t=!0)}e==-1?e=o:e!=o&&(e=Math.max(e,o))}return e}function mT(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const o=n.map[i];if(r[o])continue;r[o]=!0;const s=t.nodeAt(o);if(!s)throw new RangeError(`No cell with offset ${o} found`);let a=null;const l=s.attrs;for(let c=0;c<l.colspan;c++){const u=(i+c)%n.width,f=e[u*2];f!=null&&(!l.colwidth||l.colwidth[c]!=f)&&((a||(a=gT(l)))[c]=f)}a&&n.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:a})}}function gT(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function Je(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var Tn=new dt("selectingCells");function Ci(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function yT(n){for(let e=n.depth;e>0;e--){const t=n.node(e).type.spec.tableRole;if(t==="cell"||t==="header_cell")return n.node(e)}return null}function Ht(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function Ha(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=Ci(e.$head)||bT(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function bT(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Qc(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function wT(n){return n.node(0).resolve(n.pos+n.nodeAfter.nodeSize)}function yf(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function a0(n,e,t){const r=n.node(-1),i=ve.get(r),o=n.start(-1),s=i.nextCell(n.pos-o,e,t);return s==null?null:n.node(0).resolve(o+s)}function Cr(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function l0(n,e,t=1){const r={...n,colspan:n.colspan+t};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<t;i++)r.colwidth.splice(e,0,0)}return r}function vT(n,e,t){const r=Je(e.type.schema).header_cell;for(let i=0;i<n.height;i++)if(e.nodeAt(n.map[t+i*n.width]).type!=r)return!1;return!0}var ue=class an extends B{constructor(e,t=e){const r=e.node(-1),i=ve.get(r),o=e.start(-1),s=i.rectBetween(e.pos-o,t.pos-o),a=e.node(0),l=i.cellsInRect(s).filter(u=>u!=t.pos-o);l.unshift(t.pos-o);const c=l.map(u=>{const f=r.nodeAt(u);if(!f)throw RangeError(`No cell with offset ${u} found`);const d=o+u+1;return new Bg(a.resolve(d),a.resolve(d+f.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(Qc(r)&&Qc(i)&&yf(r,i)){const o=this.$anchorCell.node(-1)!=r.node(-1);return o&&this.isRowSelection()?an.rowSelection(r,i):o&&this.isColSelection()?an.colSelection(r,i):new an(r,i)}return F.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=ve.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},s=[];for(let l=i.top;l<i.bottom;l++){const c=[];for(let u=l*t.width+i.left,f=i.left;f<i.right;f++,u++){const d=t.map[u];if(o[d])continue;o[d]=!0;const h=t.findCell(d);let p=e.nodeAt(d);if(!p)throw RangeError(`No cell with offset ${d} found`);const m=i.left-h.left,g=h.right-i.right;if(m>0||g>0){let b=p.attrs;if(m>0&&(b=Cr(b,0,m)),g>0&&(b=Cr(b,b.colspan-g,g)),h.left<i.left){if(p=p.type.createAndFill(b),!p)throw RangeError(`Could not create cell with attrs ${JSON.stringify(b)}`)}else p=p.type.create(b,p.content)}if(h.top<i.top||h.bottom>i.bottom){const b={...p.attrs,rowspan:Math.min(h.bottom,i.bottom)-Math.max(h.top,i.top)};h.top<i.top?p=p.type.createAndFill(b):p=p.type.create(b,p.content)}c.push(p)}s.push(e.child(l).copy(E.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:s;return new D(E.from(a),1,1)}replace(e,t=D.empty){const r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){const{$from:a,$to:l}=i[s],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),s?D.empty:t)}const o=B.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new D(E.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=ve.get(t),i=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let s=0;s<o.length;s++)e(t.nodeAt(o[s]),i+o[s])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=ve.get(r),o=e.start(-1),s=i.findCell(e.pos-o),a=i.findCell(t.pos-o),l=e.node(0);return s.top<=a.top?(s.top>0&&(e=l.resolve(o+i.map[s.left])),a.bottom<i.height&&(t=l.resolve(o+i.map[i.width*(i.height-1)+a.right-1]))):(a.top>0&&(t=l.resolve(o+i.map[a.left])),s.bottom<i.height&&(e=l.resolve(o+i.map[i.width*(i.height-1)+s.right-1]))),new an(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=ve.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),o=t.colCount(this.$headCell.pos-r);if(Math.min(i,o)>0)return!1;const s=i+this.$anchorCell.nodeAfter.attrs.colspan,a=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,a)==t.width}eq(e){return e instanceof an&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=ve.get(r),o=e.start(-1),s=i.findCell(e.pos-o),a=i.findCell(t.pos-o),l=e.node(0);return s.left<=a.left?(s.left>0&&(e=l.resolve(o+i.map[s.top*i.width])),a.right<i.width&&(t=l.resolve(o+i.map[i.width*(a.top+1)-1]))):(a.left>0&&(t=l.resolve(o+i.map[a.top*i.width])),s.right<i.width&&(e=l.resolve(o+i.map[i.width*(s.top+1)-1]))),new an(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new an(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new an(e.resolve(t),e.resolve(r))}getBookmark(){return new xT(this.$anchorCell.pos,this.$headCell.pos)}};ue.prototype.visible=!1;B.jsonID("cell",ue);var xT=class c0{constructor(e,t){this.anchor=e,this.head=t}map(e){return new c0(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&yf(t,r)?new ue(t,r):B.near(r,1)}};function ST(n){if(!(n.selection instanceof ue))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Ge.node(r,r+t.nodeSize,{class:"selectedCell"}))}),ge.create(n.doc,e)}function CT({$from:n,$to:e}){if(n.pos==e.pos||n.pos<e.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let o=e.depth;o>=0&&!(e.before(o+1)>e.start(o));o--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function kT({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const o=n.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){t=o;break}}for(let i=e.depth;i>0;i--){const o=e.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}return t!==r&&e.parentOffset===0}function OT(n,e,t){const r=(e||n).selection,i=(e||n).doc;let o,s;if(r instanceof j&&(s=r.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")o=ue.create(i,r.from);else if(s=="row"){const a=i.resolve(r.from+1);o=ue.rowSelection(a,a)}else if(!t){const a=ve.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];o=ue.create(i,l+1,c)}}else r instanceof F&&CT(r)?o=F.create(i,r.from):r instanceof F&&kT(r)&&(o=F.create(i,r.$from.start(),r.$from.end()));return o&&(e||(e=n.tr)).setSelection(o),e}var MT=new dt("fix-tables");function u0(n,e,t,r){const i=n.childCount,o=e.childCount;e:for(let s=0,a=0;s<o;s++){const l=e.child(s);for(let c=a,u=Math.min(i,s+3);c<u;c++)if(n.child(c)==l){a=c+1,t+=l.nodeSize;continue e}r(l,t),a<i&&n.child(a).sameMarkup(l)?u0(n.child(a),l,t+1,r):l.nodesBetween(0,l.content.size,r,t+1),t+=l.nodeSize}}function f0(n,e){let t;const r=(i,o)=>{i.type.spec.tableRole=="table"&&(t=ET(n,i,o,t))};return e?e.doc!=n.doc&&u0(e.doc,n.doc,0,r):n.doc.descendants(r),t}function ET(n,e,t,r){const i=ve.get(e);if(!i.problems)return r;r||(r=n.tr);const o=[];for(let l=0;l<i.height;l++)o.push(0);for(let l=0;l<i.problems.length;l++){const c=i.problems[l];if(c.type=="collision"){const u=e.nodeAt(c.pos);if(!u)continue;const f=u.attrs;for(let d=0;d<f.rowspan;d++)o[c.row+d]+=c.n;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,Cr(f,f.colspan-c.n,c.n))}else if(c.type=="missing")o[c.row]+=c.n;else if(c.type=="overlong_rowspan"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,rowspan:u.attrs.rowspan-c.n})}else if(c.type=="colwidth mismatch"){const u=e.nodeAt(c.pos);if(!u)continue;r.setNodeMarkup(r.mapping.map(t+1+c.pos),null,{...u.attrs,colwidth:c.colwidth})}else if(c.type=="zero_sized"){const u=r.mapping.map(t);r.delete(u,u+e.nodeSize)}}let s,a;for(let l=0;l<o.length;l++)o[l]&&(s==null&&(s=l),a=l);for(let l=0,c=t+1;l<i.height;l++){const u=e.child(l),f=c+u.nodeSize,d=o[l];if(d>0){let h="cell";u.firstChild&&(h=u.firstChild.type.spec.tableRole);const p=[];for(let g=0;g<d;g++){const b=Je(n.schema)[h].createAndFill();b&&p.push(b)}const m=(l==0||s==l-1)&&a==l?c+1:f-1;r.insert(r.mapping.map(m),p)}c=f}return r.setMeta(MT,{fixTables:!0})}function rn(n){const e=n.selection,t=Ha(n),r=t.node(-1),i=t.start(-1),o=ve.get(r);return{...e instanceof ue?o.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o.findCell(t.pos-i),tableStart:i,map:o,table:r}}function d0(n,{map:e,tableStart:t,table:r},i){let o=i>0?-1:0;vT(e,r,i+o)&&(o=i==0||i==e.width?null:0);for(let s=0;s<e.height;s++){const a=s*e.width+i;if(i>0&&i<e.width&&e.map[a-1]==e.map[a]){const l=e.map[a],c=r.nodeAt(l);n.setNodeMarkup(n.mapping.map(t+l),null,l0(c.attrs,i-e.colCount(l))),s+=c.attrs.rowspan-1}else{const l=o==null?Je(r.type.schema).cell:r.nodeAt(e.map[a+o]).type,c=e.positionAt(s,i,r);n.insert(n.mapping.map(t+c),l.createAndFill())}}return n}function TT(n,e){if(!Ht(n))return!1;if(e){const t=rn(n);e(d0(n.tr,t,t.left))}return!0}function RT(n,e){if(!Ht(n))return!1;if(e){const t=rn(n);e(d0(n.tr,t,t.right))}return!0}function AT(n,{map:e,table:t,tableStart:r},i){const o=n.mapping.maps.length;for(let s=0;s<e.height;){const a=s*e.width+i,l=e.map[a],c=t.nodeAt(l),u=c.attrs;if(i>0&&e.map[a-1]==l||i<e.width-1&&e.map[a+1]==l)n.setNodeMarkup(n.mapping.slice(o).map(r+l),null,Cr(u,i-e.colCount(l)));else{const f=n.mapping.slice(o).map(r+l);n.delete(f,f+c.nodeSize)}s+=u.rowspan}}function DT(n,e){if(!Ht(n))return!1;if(e){const t=rn(n),r=n.tr;if(t.left==0&&t.right==t.map.width)return!1;for(let i=t.right-1;AT(r,t,i),i!=t.left;i--){const o=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!o)throw RangeError("No table found");t.table=o,t.map=ve.get(o)}e(r)}return!0}function $T(n,e,t){var r;const i=Je(e.type.schema).header_cell;for(let o=0;o<n.width;o++)if(((r=e.nodeAt(n.map[o+t*n.width]))==null?void 0:r.type)!=i)return!1;return!0}function h0(n,{map:e,tableStart:t,table:r},i){var o;let s=t;for(let c=0;c<i;c++)s+=r.child(c).nodeSize;const a=[];let l=i>0?-1:0;$T(e,r,i+l)&&(l=i==0||i==e.height?null:0);for(let c=0,u=e.width*i;c<e.width;c++,u++)if(i>0&&i<e.height&&e.map[u]==e.map[u-e.width]){const f=e.map[u],d=r.nodeAt(f).attrs;n.setNodeMarkup(t+f,null,{...d,rowspan:d.rowspan+1}),c+=d.colspan-1}else{const f=l==null?Je(r.type.schema).cell:(o=r.nodeAt(e.map[u+l*e.width]))==null?void 0:o.type,d=f?.createAndFill();d&&a.push(d)}return n.insert(s,Je(r.type.schema).row.create(null,a)),n}function PT(n,e){if(!Ht(n))return!1;if(e){const t=rn(n);e(h0(n.tr,t,t.top))}return!0}function NT(n,e){if(!Ht(n))return!1;if(e){const t=rn(n);e(h0(n.tr,t,t.bottom))}return!0}function IT(n,{map:e,table:t,tableStart:r},i){let o=0;for(let c=0;c<i;c++)o+=t.child(c).nodeSize;const s=o+t.child(i).nodeSize,a=n.mapping.maps.length;n.delete(o+r,s+r);const l=new Set;for(let c=0,u=i*e.width;c<e.width;c++,u++){const f=e.map[u];if(!l.has(f)){if(l.add(f),i>0&&f==e.map[u-e.width]){const d=t.nodeAt(f).attrs;n.setNodeMarkup(n.mapping.slice(a).map(f+r),null,{...d,rowspan:d.rowspan-1}),c+=d.colspan-1}else if(i<e.height&&f==e.map[u+e.width]){const d=t.nodeAt(f),h=d.attrs,p=d.type.create({...h,rowspan:d.attrs.rowspan-1},d.content),m=e.positionAt(i+1,c,t);n.insert(n.mapping.slice(a).map(r+m),p),c+=h.colspan-1}}}}function zT(n,e){if(!Ht(n))return!1;if(e){const t=rn(n),r=n.tr;if(t.top==0&&t.bottom==t.map.height)return!1;for(let i=t.bottom-1;IT(r,t,i),i!=t.top;i--){const o=t.tableStart?r.doc.nodeAt(t.tableStart-1):r.doc;if(!o)throw RangeError("No table found");t.table=o,t.map=ve.get(t.table)}e(r)}return!0}function Ih(n){const e=n.content;return e.childCount==1&&e.child(0).isTextblock&&e.child(0).childCount==0}function jT({width:n,height:e,map:t},r){let i=r.top*n+r.left,o=i,s=(r.bottom-1)*n+r.left,a=i+(r.right-r.left-1);for(let l=r.top;l<r.bottom;l++){if(r.left>0&&t[o]==t[o-1]||r.right<n&&t[a]==t[a+1])return!0;o+=n,a+=n}for(let l=r.left;l<r.right;l++){if(r.top>0&&t[i]==t[i-n]||r.bottom<e&&t[s]==t[s+n])return!0;i++,s++}return!1}function zh(n,e){const t=n.selection;if(!(t instanceof ue)||t.$anchorCell.pos==t.$headCell.pos)return!1;const r=rn(n),{map:i}=r;if(jT(i,r))return!1;if(e){const o=n.tr,s={};let a=E.empty,l,c;for(let u=r.top;u<r.bottom;u++)for(let f=r.left;f<r.right;f++){const d=i.map[u*i.width+f],h=r.table.nodeAt(d);if(!(s[d]||!h))if(s[d]=!0,l==null)l=d,c=h;else{Ih(h)||(a=a.append(h.content));const p=o.mapping.map(d+r.tableStart);o.delete(p,p+h.nodeSize)}}if(l==null||c==null)return!0;if(o.setNodeMarkup(l+r.tableStart,null,{...l0(c.attrs,c.attrs.colspan,r.right-r.left-c.attrs.colspan),rowspan:r.bottom-r.top}),a.size){const u=l+1+c.content.size,f=Ih(c)?l+1:u;o.replaceWith(f+r.tableStart,u+r.tableStart,a)}o.setSelection(new ue(o.doc.resolve(l+r.tableStart))),e(o)}return!0}function jh(n,e){const t=Je(n.schema);return LT(({node:r})=>t[r.type.spec.tableRole])(n,e)}function LT(n){return(e,t)=>{var r;const i=e.selection;let o,s;if(i instanceof ue){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;o=i.$anchorCell.nodeAfter,s=i.$anchorCell.pos}else{if(o=yT(i.$from),!o)return!1;s=(r=Ci(i.$from))==null?void 0:r.pos}if(o==null||s==null||o.attrs.colspan==1&&o.attrs.rowspan==1)return!1;if(t){let a=o.attrs;const l=[],c=a.colwidth;a.rowspan>1&&(a={...a,rowspan:1}),a.colspan>1&&(a={...a,colspan:1});const u=rn(e),f=e.tr;for(let h=0;h<u.right-u.left;h++)l.push(c?{...a,colwidth:c&&c[h]?[c[h]]:null}:a);let d;for(let h=u.top;h<u.bottom;h++){let p=u.map.positionAt(h,u.left,u.table);h==u.top&&(p+=o.nodeSize);for(let m=u.left,g=0;m<u.right;m++,g++)m==u.left&&h==u.top||f.insert(d=f.mapping.map(p+u.tableStart,1),n({node:o,row:h,col:m}).createAndFill(l[g]))}f.setNodeMarkup(s,n({node:o,row:u.top,col:u.left}),l[0]),i instanceof ue&&f.setSelection(new ue(f.doc.resolve(i.$anchorCell.pos),d?f.doc.resolve(d):void 0)),t(f)}return!0}}function BT(n,e){return function(t,r){if(!Ht(t))return!1;const i=Ha(t);if(i.nodeAfter.attrs[n]===e)return!1;if(r){const o=t.tr;t.selection instanceof ue?t.selection.forEachCell((s,a)=>{s.attrs[n]!==e&&o.setNodeMarkup(a,null,{...s.attrs,[n]:e})}):o.setNodeMarkup(i.pos,null,{...i.nodeAfter.attrs,[n]:e}),r(o)}return!0}}function FT(n){return function(e,t){if(!Ht(e))return!1;if(t){const r=Je(e.schema),i=rn(e),o=e.tr,s=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),a=s.map(l=>i.table.nodeAt(l));for(let l=0;l<s.length;l++)a[l].type==r.header_cell&&o.setNodeMarkup(i.tableStart+s[l],r.cell,a[l].attrs);if(o.steps.length==0)for(let l=0;l<s.length;l++)o.setNodeMarkup(i.tableStart+s[l],r.header_cell,a[l].attrs);t(o)}return!0}}function Lh(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const o=e.table.nodeAt(r[i]);if(o&&o.type!==t.header_cell)return!1}return!0}function xo(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?FT(n):function(t,r){if(!Ht(t))return!1;if(r){const i=Je(t.schema),o=rn(t),s=t.tr,a=Lh("row",o,i),l=Lh("column",o,i),u=(n==="column"?a:n==="row"?l:!1)?1:0,f=n=="column"?{left:0,top:u,right:1,bottom:o.map.height}:n=="row"?{left:u,top:0,right:o.map.width,bottom:1}:o,d=n=="column"?l?i.cell:i.header_cell:n=="row"?a?i.cell:i.header_cell:i.cell;o.map.cellsInRect(f).forEach(h=>{const p=h+o.tableStart,m=s.doc.nodeAt(p);m&&s.setNodeMarkup(p,d,m.attrs)}),r(s)}return!0}}xo("row",{useDeprecatedLogic:!0});xo("column",{useDeprecatedLogic:!0});var _T=xo("cell",{useDeprecatedLogic:!0});function WT(n,e){if(e<0){const t=n.nodeBefore;if(t)return n.pos-t.nodeSize;for(let r=n.index(-1)-1,i=n.before();r>=0;r--){const o=n.node(-1).child(r),s=o.lastChild;if(s)return i-1-s.nodeSize;i-=o.nodeSize}}else{if(n.index()<n.parent.childCount-1)return n.pos+n.nodeAfter.nodeSize;const t=n.node(-1);for(let r=n.indexAfter(-1),i=n.after();r<t.childCount;r++){const o=t.child(r);if(o.childCount)return i+1;i+=o.nodeSize}}return null}function Bh(n){return function(e,t){if(!Ht(e))return!1;const r=WT(Ha(e),n);if(r==null)return!1;if(t){const i=e.doc.resolve(r);t(e.tr.setSelection(F.between(i,wT(i))).scrollIntoView())}return!0}}function HT(n,e){const t=n.selection.$anchor;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="table")return e&&e(n.tr.delete(t.before(r),t.after(r)).scrollIntoView()),!0;return!1}function ss(n,e){const t=n.selection;if(!(t instanceof ue))return!1;if(e){const r=n.tr,i=Je(n.schema).cell.createAndFill().content;t.forEachCell((o,s)=>{o.content.eq(i)||r.replace(r.mapping.map(s+1),r.mapping.map(s+o.nodeSize-1),new D(i,0,0))}),r.docChanged&&e(r)}return!0}function VT(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),o=i.type.spec.tableRole,s=i.type.schema,a=[];if(o=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content;const u=l?0:Math.max(0,t-1),f=l<e.childCount-1?0:Math.max(0,r-1);(u||f)&&(c=Zc(Je(s).row,new D(c,u,f)).content),a.push(c)}else if(o=="cell"||o=="header_cell")a.push(t||r?Zc(Je(s).row,new D(e,t,r)).content:e);else return null;return qT(s,a)}function qT(n,e){const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(let s=o.childCount-1;s>=0;s--){const{rowspan:a,colspan:l}=o.child(s).attrs;for(let c=i;c<i+a;c++)t[c]=(t[c]||0)+l}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(E.empty),t[i]<r){const o=Je(n).cell.createAndFill(),s=[];for(let a=t[i];a<r;a++)s.push(o);e[i]=e[i].append(E.from(s))}return{height:e.length,width:r,rows:e}}function Zc(n,e){const t=n.createAndFill();return new Lg(t).replace(0,t.content.size,e).doc}function GT({width:n,height:e,rows:t},r,i){if(n!=r){const o=[],s=[];for(let a=0;a<t.length;a++){const l=t[a],c=[];for(let u=o[a]||0,f=0;u<r;f++){let d=l.child(f%l.childCount);u+d.attrs.colspan>r&&(d=d.type.createChecked(Cr(d.attrs,d.attrs.colspan,u+d.attrs.colspan-r),d.content)),c.push(d),u+=d.attrs.colspan;for(let h=1;h<d.attrs.rowspan;h++)o[a+h]=(o[a+h]||0)+d.attrs.colspan}s.push(E.from(c))}t=s,n=r}if(e!=i){const o=[];for(let s=0,a=0;s<i;s++,a++){const l=[],c=t[a%e];for(let u=0;u<c.childCount;u++){let f=c.child(u);s+f.attrs.rowspan>i&&(f=f.type.create({...f.attrs,rowspan:Math.max(1,i-f.attrs.rowspan)},f.content)),l.push(f)}o.push(E.from(l))}t=o,e=i}return{width:n,height:e,rows:t}}function JT(n,e,t,r,i,o,s){const a=n.doc.type.schema,l=Je(a);let c,u;if(i>e.width)for(let f=0,d=0;f<e.height;f++){const h=t.child(f);d+=h.nodeSize;const p=[];let m;h.lastChild==null||h.lastChild.type==l.cell?m=c||(c=l.cell.createAndFill()):m=u||(u=l.header_cell.createAndFill());for(let g=e.width;g<i;g++)p.push(m);n.insert(n.mapping.slice(s).map(d-1+r),p)}if(o>e.height){const f=[];for(let p=0,m=(e.height-1)*e.width;p<Math.max(e.width,i);p++){const g=p>=e.width?!1:t.nodeAt(e.map[m+p]).type==l.header_cell;f.push(g?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}const d=l.row.create(null,E.from(f)),h=[];for(let p=e.height;p<o;p++)h.push(d);n.insert(n.mapping.slice(s).map(r+t.nodeSize-2),h)}return!!(c||u)}function Fh(n,e,t,r,i,o,s,a){if(s==0||s==e.height)return!1;let l=!1;for(let c=i;c<o;c++){const u=s*e.width+c,f=e.map[u];if(e.map[u-e.width]==f){l=!0;const d=t.nodeAt(f),{top:h,left:p}=e.findCell(f);n.setNodeMarkup(n.mapping.slice(a).map(f+r),null,{...d.attrs,rowspan:s-h}),n.insert(n.mapping.slice(a).map(e.positionAt(s,p,t)),d.type.createAndFill({...d.attrs,rowspan:h+d.attrs.rowspan-s})),c+=d.attrs.colspan-1}}return l}function _h(n,e,t,r,i,o,s,a){if(s==0||s==e.width)return!1;let l=!1;for(let c=i;c<o;c++){const u=c*e.width+s,f=e.map[u];if(e.map[u-1]==f){l=!0;const d=t.nodeAt(f),h=e.colCount(f),p=n.mapping.slice(a).map(f+r);n.setNodeMarkup(p,null,Cr(d.attrs,s-h,d.attrs.colspan-(s-h))),n.insert(p+d.nodeSize,d.type.createAndFill(Cr(d.attrs,0,s-h))),c+=d.attrs.rowspan-1}}return l}function Wh(n,e,t,r,i){let o=t?n.doc.nodeAt(t-1):n.doc;if(!o)throw new Error("No table found");let s=ve.get(o);const{top:a,left:l}=r,c=l+i.width,u=a+i.height,f=n.tr;let d=0;function h(){if(o=t?f.doc.nodeAt(t-1):f.doc,!o)throw new Error("No table found");s=ve.get(o),d=f.mapping.maps.length}JT(f,s,o,t,c,u,d)&&h(),Fh(f,s,o,t,l,c,a,d)&&h(),Fh(f,s,o,t,l,c,u,d)&&h(),_h(f,s,o,t,a,u,l,d)&&h(),_h(f,s,o,t,a,u,c,d)&&h();for(let p=a;p<u;p++){const m=s.positionAt(p,l,o),g=s.positionAt(p,c,o);f.replace(f.mapping.slice(d).map(m+t),f.mapping.slice(d).map(g+t),new D(i.rows[p-a],0,0))}h(),f.setSelection(new ue(f.doc.resolve(t+s.positionAt(a,l,o)),f.doc.resolve(t+s.positionAt(u-1,c-1,o)))),e(f)}var UT=nf({ArrowLeft:as("horiz",-1),ArrowRight:as("horiz",1),ArrowUp:as("vert",-1),ArrowDown:as("vert",1),"Shift-ArrowLeft":ls("horiz",-1),"Shift-ArrowRight":ls("horiz",1),"Shift-ArrowUp":ls("vert",-1),"Shift-ArrowDown":ls("vert",1),Backspace:ss,"Mod-Backspace":ss,Delete:ss,"Mod-Delete":ss});function Ms(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function as(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;if(o instanceof ue)return Ms(t,r,B.near(o.$headCell,e));if(n!="horiz"&&!o.empty)return!1;const s=p0(i,n,e);if(s==null)return!1;if(n=="horiz")return Ms(t,r,B.near(t.doc.resolve(o.head+e),e));{const a=t.doc.resolve(s),l=a0(a,n,e);let c;return l?c=B.near(l,1):e<0?c=B.near(t.doc.resolve(a.before(-1)),-1):c=B.near(t.doc.resolve(a.after(-1)),1),Ms(t,r,c)}}}function ls(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;let s;if(o instanceof ue)s=o;else{const l=p0(i,n,e);if(l==null)return!1;s=new ue(t.doc.resolve(l))}const a=a0(s.$headCell,n,e);return a?Ms(t,r,new ue(s.$anchorCell,a)):!1}}function KT(n,e){const t=n.state.doc,r=Ci(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new ue(r))),!0):!1}function YT(n,e,t){if(!Ht(n.state))return!1;let r=VT(t);const i=n.state.selection;if(i instanceof ue){r||(r={width:1,height:1,rows:[E.from(Zc(Je(n.state.schema).cell,t))]});const o=i.$anchorCell.node(-1),s=i.$anchorCell.start(-1),a=ve.get(o).rectBetween(i.$anchorCell.pos-s,i.$headCell.pos-s);return r=GT(r,a.right-a.left,a.bottom-a.top),Wh(n.state,n.dispatch,s,a,r),!0}else if(r){const o=Ha(n.state),s=o.start(-1);return Wh(n.state,n.dispatch,s,ve.get(o.node(-1)).findCell(o.pos-s),r),!0}else return!1}function XT(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=Hh(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof ue)o(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=Ci(n.state.selection.$anchor))!=null&&((t=$l(n,e))==null?void 0:t.pos)!=i.pos)o(i,e),e.preventDefault();else if(!r)return;function o(l,c){let u=$l(n,c);const f=Tn.getState(n.state)==null;if(!u||!yf(l,u))if(f)u=l;else return;const d=new ue(l,u);if(f||!n.state.selection.eq(d)){const h=n.state.tr.setSelection(d);f&&h.setMeta(Tn,l.pos),n.dispatch(h)}}function s(){n.root.removeEventListener("mouseup",s),n.root.removeEventListener("dragstart",s),n.root.removeEventListener("mousemove",a),Tn.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(Tn,-1))}function a(l){const c=l,u=Tn.getState(n.state);let f;if(u!=null)f=n.state.doc.resolve(u);else if(Hh(n,c.target)!=r&&(f=$l(n,e),!f))return s();f&&o(f,c)}n.root.addEventListener("mouseup",s),n.root.addEventListener("dragstart",s),n.root.addEventListener("mousemove",a)}function p0(n,e,t){if(!(n.state.selection instanceof F))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const o=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const a=r.before(i),l=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(l)?a:null}}return null}function Hh(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function $l(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?Ci(n.state.doc.resolve(t.pos)):null}var QT=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),eu(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,eu(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function eu(n,e,t,r,i,o){var s;let a=0,l=!0,c=e.firstChild;const u=n.firstChild;if(u){for(let f=0,d=0;f<u.childCount;f++){const{colspan:h,colwidth:p}=u.child(f).attrs;for(let m=0;m<h;m++,d++){const g=i==d?o:p&&p[m],b=g?g+"px":"";if(a+=g||r,g||(l=!1),c)c.style.width!=b&&(c.style.width=b),c=c.nextSibling;else{const x=document.createElement("col");x.style.width=b,e.appendChild(x)}}}for(;c;){const f=c.nextSibling;(s=c.parentNode)==null||s.removeChild(c),c=f}l?(t.style.width=a+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=a+"px")}}var yt=new dt("tableColumnResizing");function ZT({handleWidth:n=5,cellMinWidth:e=25,defaultCellMinWidth:t=100,View:r=QT,lastColumnResizable:i=!0}={}){const o=new Fe({key:yt,state:{init(s,a){var l,c;const u=(c=(l=o.spec)==null?void 0:l.props)==null?void 0:c.nodeViews,f=Je(a.schema).table.name;return r&&u&&(u[f]=(d,h)=>new r(d,t,h)),new eR(-1,!1)},apply(s,a){return a.apply(s)}},props:{attributes:s=>{const a=yt.getState(s);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(s,a)=>{tR(s,a,n,i)},mouseleave:s=>{nR(s)},mousedown:(s,a)=>{rR(s,a,e,t)}},decorations:s=>{const a=yt.getState(s);if(a&&a.activeHandle>-1)return lR(s,a.activeHandle)},nodeViews:{}}});return o}var eR=class Es{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(yt);if(r&&r.setHandle!=null)return new Es(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new Es(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return Qc(e.doc.resolve(i))||(i=-1),new Es(i,t.dragging)}return t}};function tR(n,e,t,r){if(!n.editable)return;const i=yt.getState(n.state);if(i&&!i.dragging){const o=oR(e.target);let s=-1;if(o){const{left:a,right:l}=o.getBoundingClientRect();e.clientX-a<=t?s=Vh(n,e,"left",t):l-e.clientX<=t&&(s=Vh(n,e,"right",t))}if(s!=i.activeHandle){if(!r&&s!==-1){const a=n.state.doc.resolve(s),l=a.node(-1),c=ve.get(l),u=a.start(-1);if(c.colCount(a.pos-u)+a.nodeAfter.attrs.colspan-1==c.width-1)return}m0(n,s)}}}function nR(n){if(!n.editable)return;const e=yt.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&m0(n,-1)}function rR(n,e,t,r){var i;if(!n.editable)return!1;const o=(i=n.dom.ownerDocument.defaultView)!=null?i:window,s=yt.getState(n.state);if(!s||s.activeHandle==-1||s.dragging)return!1;const a=n.state.doc.nodeAt(s.activeHandle),l=iR(n,s.activeHandle,a.attrs);n.dispatch(n.state.tr.setMeta(yt,{setDragging:{startX:e.clientX,startWidth:l}}));function c(f){o.removeEventListener("mouseup",c),o.removeEventListener("mousemove",u);const d=yt.getState(n.state);d?.dragging&&(sR(n,d.activeHandle,qh(d.dragging,f,t)),n.dispatch(n.state.tr.setMeta(yt,{setDragging:null})))}function u(f){if(!f.which)return c(f);const d=yt.getState(n.state);if(d&&d.dragging){const h=qh(d.dragging,f,t);Gh(n,d.activeHandle,h,r)}}return Gh(n,s.activeHandle,l,r),o.addEventListener("mouseup",c),o.addEventListener("mousemove",u),e.preventDefault(),!0}function iR(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const o=n.domAtPos(e);let a=o.node.childNodes[o.offset].offsetWidth,l=t;if(r)for(let c=0;c<t;c++)r[c]&&(a-=r[c],l--);return a/l}function oR(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function Vh(n,e,t,r){const i=t=="right"?-r:r,o=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!o)return-1;const{pos:s}=o,a=Ci(n.state.doc.resolve(s));if(!a)return-1;if(t=="right")return a.pos;const l=ve.get(a.node(-1)),c=a.start(-1),u=l.map.indexOf(a.pos-c);return u%l.width==0?-1:c+l.map[u-1]}function qh(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function m0(n,e){n.dispatch(n.state.tr.setMeta(yt,{setHandle:e}))}function sR(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),o=ve.get(i),s=r.start(-1),a=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,l=n.state.tr;for(let c=0;c<o.height;c++){const u=c*o.width+a;if(c&&o.map[u]==o.map[u-o.width])continue;const f=o.map[u],d=i.nodeAt(f).attrs,h=d.colspan==1?0:a-o.colCount(f);if(d.colwidth&&d.colwidth[h]==t)continue;const p=d.colwidth?d.colwidth.slice():aR(d.colspan);p[h]=t,l.setNodeMarkup(s+f,null,{...d,colwidth:p})}l.docChanged&&n.dispatch(l)}function Gh(n,e,t,r){const i=n.state.doc.resolve(e),o=i.node(-1),s=i.start(-1),a=ve.get(o).colCount(i.pos-s)+i.nodeAfter.attrs.colspan-1;let l=n.domAtPos(i.start(-1)).node;for(;l&&l.nodeName!="TABLE";)l=l.parentNode;l&&eu(o,l.firstChild,l,r,a,t)}function aR(n){return Array(n).fill(0)}function lR(n,e){var t;const r=[],i=n.doc.resolve(e),o=i.node(-1);if(!o)return ge.empty;const s=ve.get(o),a=i.start(-1),l=s.colCount(i.pos-a)+i.nodeAfter.attrs.colspan-1;for(let c=0;c<s.height;c++){const u=l+c*s.width;if((l==s.width-1||s.map[u]!=s.map[u+1])&&(c==0||s.map[u]!=s.map[u-s.width])){const f=s.map[u],d=a+f+o.nodeAt(f).nodeSize-1,h=document.createElement("div");h.className="column-resize-handle",(t=yt.getState(n))!=null&&t.dragging&&r.push(Ge.node(a+f,a+f+o.nodeAt(f).nodeSize,{class:"column-resize-dragging"})),r.push(Ge.widget(d,h))}}return ge.create(n.doc,r)}function cR({allowTableNodeSelection:n=!1}={}){return new Fe({key:Tn,state:{init(){return null},apply(e,t){const r=e.getMeta(Tn);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:o}=e.mapping.mapResult(t);return i?null:o}},props:{decorations:ST,handleDOMEvents:{mousedown:XT},createSelectionBetween(e){return Tn.getState(e.state)!=null?e.state.selection:null},handleTripleClick:KT,handleKeyDown:UT,handlePaste:YT},appendTransaction(e,t,r){return OT(r,f0(r,t),n)}})}function tu(n,e){return e?["width",`${Math.max(e,n)}px`]:["min-width",`${n}px`]}function Jh(n,e,t,r,i,o){var s;let a=0,l=!0,c=e.firstChild;const u=n.firstChild;if(u!==null)for(let f=0,d=0;f<u.childCount;f+=1){const{colspan:h,colwidth:p}=u.child(f).attrs;for(let m=0;m<h;m+=1,d+=1){const g=i===d?o:p&&p[m],b=g?`${g}px`:"";if(a+=g||r,g||(l=!1),c){if(c.style.width!==b){const[x,w]=tu(r,g);c.style.setProperty(x,w)}c=c.nextSibling}else{const x=document.createElement("col"),[w,C]=tu(r,g);x.style.setProperty(w,C),e.appendChild(x)}}}for(;c;){const f=c.nextSibling;(s=c.parentNode)===null||s===void 0||s.removeChild(c),c=f}l?(t.style.width=`${a}px`,t.style.minWidth=""):(t.style.width="",t.style.minWidth=`${a}px`)}class uR{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Jh(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,Jh(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type==="attributes"&&(e.target===this.table||this.colgroup.contains(e.target))}}function fR(n,e,t,r){let i=0,o=!0;const s=[],a=n.firstChild;if(!a)return{};for(let f=0,d=0;f<a.childCount;f+=1){const{colspan:h,colwidth:p}=a.child(f).attrs;for(let m=0;m<h;m+=1,d+=1){const g=t===d?r:p&&p[m];i+=g||e,g||(o=!1);const[b,x]=tu(e,g);s.push(["col",{style:`${b}: ${x}`}])}}const l=o?`${i}px`:"",c=o?"":`${i}px`;return{colgroup:["colgroup",{},...s],tableWidth:l,tableMinWidth:c}}function Uh(n,e){return n.createAndFill()}function dR(n){if(n.cached.tableNodeTypes)return n.cached.tableNodeTypes;const e={};return Object.keys(n.nodes).forEach(t=>{const r=n.nodes[t];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),n.cached.tableNodeTypes=e,e}function hR(n,e,t,r,i){const o=dR(n),s=[],a=[];for(let c=0;c<t;c+=1){const u=Uh(o.cell);if(u&&a.push(u),r){const f=Uh(o.header_cell);f&&s.push(f)}}const l=[];for(let c=0;c<e;c+=1)l.push(o.row.createChecked(null,r&&c===0?s:a));return o.table.createChecked(null,l)}function pR(n){return n instanceof ue}const cs=({editor:n})=>{const{selection:e}=n.state;if(!pR(e))return!1;let t=0;const r=Uy(e.ranges[0].$from,o=>o.type.name==="table");return r?.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(t+=1)}),t===e.ranges.length?(n.commands.deleteTable(),!0):!1},mR=st.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:uR,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:n,HTMLAttributes:e}){const{colgroup:t,tableWidth:r,tableMinWidth:i}=fR(n,this.options.cellMinWidth);return["table",Re(this.options.HTMLAttributes,e,{style:r?`width: ${r}`:`min-width: ${i}`}),t,["tbody",0]]},addCommands(){return{insertTable:({rows:n=3,cols:e=3,withHeaderRow:t=!0}={})=>({tr:r,dispatch:i,editor:o})=>{const s=hR(o.schema,n,e,t);if(i){const a=r.selection.from+1;r.replaceSelectionWith(s).scrollIntoView().setSelection(F.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:n,dispatch:e})=>TT(n,e),addColumnAfter:()=>({state:n,dispatch:e})=>RT(n,e),deleteColumn:()=>({state:n,dispatch:e})=>DT(n,e),addRowBefore:()=>({state:n,dispatch:e})=>PT(n,e),addRowAfter:()=>({state:n,dispatch:e})=>NT(n,e),deleteRow:()=>({state:n,dispatch:e})=>zT(n,e),deleteTable:()=>({state:n,dispatch:e})=>HT(n,e),mergeCells:()=>({state:n,dispatch:e})=>zh(n,e),splitCell:()=>({state:n,dispatch:e})=>jh(n,e),toggleHeaderColumn:()=>({state:n,dispatch:e})=>xo("column")(n,e),toggleHeaderRow:()=>({state:n,dispatch:e})=>xo("row")(n,e),toggleHeaderCell:()=>({state:n,dispatch:e})=>_T(n,e),mergeOrSplit:()=>({state:n,dispatch:e})=>zh(n,e)?!0:jh(n,e),setCellAttribute:(n,e)=>({state:t,dispatch:r})=>BT(n,e)(t,r),goToNextCell:()=>({state:n,dispatch:e})=>Bh(1)(n,e),goToPreviousCell:()=>({state:n,dispatch:e})=>Bh(-1)(n,e),fixTables:()=>({state:n,dispatch:e})=>(e&&f0(n),!0),setCellSelection:n=>({tr:e,dispatch:t})=>{if(t){const r=ue.create(e.doc,n.anchorCell,n.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:cs,"Mod-Backspace":cs,Delete:cs,"Mod-Delete":cs}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[ZT({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,defaultCellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],cR({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(n){const e={name:n.name,options:n.options,storage:n.storage};return{tableRole:G(N(n,"tableRole",e))}}}),gR=st.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:n}){return["td",Re(this.options.HTMLAttributes,n),0]}}),yR=st.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:n=>{const e=n.getAttribute("colwidth");return e?e.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:n}){return["th",Re(this.options.HTMLAttributes,n),0]}}),bR=st.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:n}){return["tr",Re(this.options.HTMLAttributes,n),0]}}),wR=(n,e,t)=>{const r=u=>{let f=0,d=0;return u.map(h=>(d+h.w>12&&(f+=1,d=0),h.x=d,h.y=f,d+=h.w,h))};return{addBlock:(u,f)=>{},resizeBlock:u=>{const f=n[t]?.map(d=>{if(d.i===u){const h=[4,6,8,12],p=h[(h.indexOf(d.w)+1)%h.length];return{...d,w:p}}return d});e({...n,[t]:r(f)})},moveBlock:(u,f)=>{const d=Object.fromEntries(Object.entries(n).map(([h,p])=>{const m=[...p].sort((b,x)=>b.y===x.y?b.x-x.x:b.y-x.y),g=m.findIndex(b=>b.i===u);if(f==="next"&&g<m.length-1){const b=m[g];m[g]=m[g+1],m[g+1]=b}else if(f==="prev"&&g>0){const b=m[g];m[g]=m[g-1],m[g-1]=b}return[h,r(m)]}));e(d)},removeBlock:u=>{const f=Object.fromEntries(Object.entries(n).map(([d,h])=>[d,r(h.filter(p=>p.i!==u))]));e(f)},addFieldToBlock:(u,f)=>{const d=Object.fromEntries(Object.entries(n).map(([h,p])=>[h,p.map(m=>m.i===u?{...m,field:f}:m)]));e(d)},removeFieldFromBlock:(u,f)=>{const d=Object.fromEntries(Object.entries(n).map(([h,p])=>[h,p.map(m=>m.i===u?{...m,field:{}}:m)]));e(d)}}},vR=(n,e)=>{const t=`field-${Date.now()}`;switch(e.type){case"EDIT_FORM":return{...n,...e.payload};case"ADD_STEP":return{...n,steps:[...n.steps,{id:n.steps.length+1,layouts:{}}]};case"UPDATE_LAYOUT":return{...n,steps:n.steps.map(r=>r.id===e.payload.currentStep?{...r,layouts:e.payload.newLayouts}:r)};case"ADD_FIELD":return{...n,steps:n.steps.map(r=>r.id===e.payload.currentStep?{...r,layouts:Object.keys(r.layouts).reduce((i,o)=>{const s=r.layouts[o]||[],a=12;let l=0,c=0;for(let u=0;;u++){const d=s.filter(h=>h.y===u).reduce((h,p)=>h+p.w,0);if(d+12<=a){l=d,c=u;break}}return i[o]=[...s,{i:t,field:e.payload.field,w:12,h:1,minW:3,maxW:12,x:l,y:c}],i},{})}:r)};case"EDIT_FIELD":return{...n,steps:n.steps.map(r=>{if(r.id!==e.payload.currentStep)return r;const i=Object.keys(r.layouts).reduce((o,s)=>(o[s]=r.layouts[s]?.map(a=>a.i===e.payload.field.blockId?{...a,field:e.payload.field}:a)||[],o),{});return{...r,layouts:i}})};default:return n}},bf={steps:[{id:1,layouts:{lg:[],md:[],sm:[]}}],currentStep:1,active:!0},g0=v.createContext({state:bf,dispatch:()=>{},removeState:()=>{},steps:[],currentStep:1,setCurrentStep:()=>{},addStep:()=>{},addBlock:()=>{},removeBlock:()=>{},resizeBlock:()=>{},moveBlock:()=>{},currentLayouts:{lg:[],md:[],sm:[]},updateLayouts:()=>{},currentBreakpoint:"lg",setCurrentBreakpoint:()=>{}}),xR=()=>{const n=localStorage.getItem("formState");return n?JSON.parse(n):bf},SR=()=>(localStorage.removeItem("formState"),bf),y0=({children:n})=>{const[e,t]=v.useReducer(vR,xR()),[r,i]=v.useState("lg"),s=(e.steps.find(f=>f.id===e.currentStep)||{layouts:{}}).layouts,a=f=>{t({type:"SET_CURRENT_STEP",payload:f})},l=f=>{t({type:"UPDATE_LAYOUT",payload:{currentStep:e.currentStep,newLayouts:f}})},c=()=>{t({type:"ADD_STEP",payload:{id:e.steps.length+1,layouts:{}}})},u=wR(s,l,r);return y.jsx(g0.Provider,{value:{state:e,dispatch:t,removeState:SR,steps:e.steps,currentStep:e.currentStep,currentLayouts:s,updateLayouts:l,setCurrentStep:a,addStep:c,currentBreakpoint:r,setCurrentBreakpoint:i,...u},children:n})},ki=()=>{const n=v.useContext(g0);if(!n)throw new Error("useFormContext must be used within a FormProvider");return n};function Ae(){return Ae=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ae.apply(null,arguments)}function un(n,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(n?.(i),t===!1||!i.defaultPrevented)return e?.(i)}}function CR(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function b0(...n){return e=>n.forEach(t=>CR(t,e))}function Oi(...n){return v.useCallback(b0(...n),n)}function w0(n,e=[]){let t=[];function r(o,s){const a=v.createContext(s),l=t.length;t=[...t,s];function c(f){const{scope:d,children:h,...p}=f,m=d?.[n][l]||a,g=v.useMemo(()=>p,Object.values(p));return v.createElement(m.Provider,{value:g},h)}function u(f,d){const h=d?.[n][l]||a,p=v.useContext(h);if(p)return p;if(s!==void 0)return s;throw new Error(`\`${f}\` must be used within \`${o}\``)}return c.displayName=o+"Provider",[c,u]}const i=()=>{const o=t.map(s=>v.createContext(s));return function(a){const l=a?.[n]||o;return v.useMemo(()=>({[`__scope${n}`]:{...a,[n]:l}}),[a,l])}};return i.scopeName=n,[r,kR(i,...e)]}function kR(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const s=r.reduce((a,{useScope:l,scopeName:c})=>{const f=l(o)[`__scope${c}`];return{...a,...f}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:s}),[s])}};return t.scopeName=e.scopeName,t}const v0=v.forwardRef((n,e)=>{const{children:t,...r}=n,i=v.Children.toArray(t),o=i.find(OR);if(o){const s=o.props.children,a=i.map(l=>l===o?v.Children.count(s)>1?v.Children.only(null):v.isValidElement(s)?s.props.children:null:l);return v.createElement(nu,Ae({},r,{ref:e}),v.isValidElement(s)?v.cloneElement(s,void 0,a):null)}return v.createElement(nu,Ae({},r,{ref:e}),t)});v0.displayName="Slot";const nu=v.forwardRef((n,e)=>{const{children:t,...r}=n;return v.isValidElement(t)?v.cloneElement(t,{...MR(r,t.props),ref:e?b0(e,t.ref):t.ref}):v.Children.count(t)>1?v.Children.only(null):null});nu.displayName="SlotClone";const x0=({children:n})=>v.createElement(v.Fragment,null,n);function OR(n){return v.isValidElement(n)&&n.type===x0}function MR(n,e){const t={...e};for(const r in e){const i=n[r],o=e[r];/^on[A-Z]/.test(r)?i&&o?t[r]=(...a)=>{o(...a),i(...a)}:i&&(t[r]=i):r==="style"?t[r]={...i,...o}:r==="className"&&(t[r]=[i,o].filter(Boolean).join(" "))}return{...n,...t}}const ER=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Rr=ER.reduce((n,e)=>{const t=v.forwardRef((r,i)=>{const{asChild:o,...s}=r,a=o?v0:e;return v.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),v.createElement(a,Ae({},s,{ref:i}))});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function TR(n,e){n&&xi.flushSync(()=>n.dispatchEvent(e))}function Mi(n){const e=v.useRef(n);return v.useEffect(()=>{e.current=n}),v.useMemo(()=>(...t)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...t)},[])}function RR(n,e=globalThis?.document){const t=Mi(n);v.useEffect(()=>{const r=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[t,e])}const ru="dismissableLayer.update",AR="dismissableLayer.pointerDownOutside",DR="dismissableLayer.focusOutside";let Kh;const $R=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),PR=v.forwardRef((n,e)=>{var t;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:s,onInteractOutside:a,onDismiss:l,...c}=n,u=v.useContext($R),[f,d]=v.useState(null),h=(t=f?.ownerDocument)!==null&&t!==void 0?t:globalThis?.document,[,p]=v.useState({}),m=Oi(e,M=>d(M)),g=Array.from(u.layers),[b]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(b),w=f?g.indexOf(f):-1,C=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=x,k=NR(M=>{const R=M.target,T=[...u.branches].some(P=>P.contains(R));!S||T||(o?.(M),a?.(M),M.defaultPrevented||l?.())},h),O=IR(M=>{const R=M.target;[...u.branches].some(P=>P.contains(R))||(s?.(M),a?.(M),M.defaultPrevented||l?.())},h);return RR(M=>{w===u.layers.size-1&&(i?.(M),!M.defaultPrevented&&l&&(M.preventDefault(),l()))},h),v.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Kh=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Yh(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Kh)}},[f,h,r,u]),v.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Yh())},[f,u]),v.useEffect(()=>{const M=()=>p({});return document.addEventListener(ru,M),()=>document.removeEventListener(ru,M)},[]),v.createElement(Rr.div,Ae({},c,{ref:m,style:{pointerEvents:C?S?"auto":"none":void 0,...n.style},onFocusCapture:un(n.onFocusCapture,O.onFocusCapture),onBlurCapture:un(n.onBlurCapture,O.onBlurCapture),onPointerDownCapture:un(n.onPointerDownCapture,k.onPointerDownCapture)}))});function NR(n,e=globalThis?.document){const t=Mi(n),r=v.useRef(!1),i=v.useRef(()=>{});return v.useEffect(()=>{const o=a=>{if(a.target&&!r.current){let l=function(){S0(AR,t,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},s=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(s),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>r.current=!0}}function IR(n,e=globalThis?.document){const t=Mi(n),r=v.useRef(!1);return v.useEffect(()=>{const i=o=>{o.target&&!r.current&&S0(DR,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Yh(){const n=new CustomEvent(ru);document.dispatchEvent(n)}function S0(n,e,t,{discrete:r}){const i=t.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(n,e,{once:!0}),r?TR(i,o):i.dispatchEvent(o)}const mi=globalThis?.document?v.useLayoutEffect:()=>{},zR=Ow.useId||(()=>{});let jR=0;function LR(n){const[e,t]=v.useState(zR());return mi(()=>{t(r=>r??String(jR++))},[n]),e?`radix-${e}`:""}const BR=["top","right","bottom","left"],jn=Math.min,pt=Math.max,Zs=Math.round,us=Math.floor,Yt=n=>({x:n,y:n}),FR={left:"right",right:"left",bottom:"top",top:"bottom"},_R={start:"end",end:"start"};function iu(n,e,t){return pt(n,jn(e,t))}function bn(n,e){return typeof n=="function"?n(e):n}function wn(n){return n.split("-")[0]}function Ei(n){return n.split("-")[1]}function wf(n){return n==="x"?"y":"x"}function vf(n){return n==="y"?"height":"width"}function Ln(n){return["top","bottom"].includes(wn(n))?"y":"x"}function xf(n){return wf(Ln(n))}function WR(n,e,t){t===void 0&&(t=!1);const r=Ei(n),i=xf(n),o=vf(i);let s=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=ea(s)),[s,ea(s)]}function HR(n){const e=ea(n);return[ou(n),e,ou(e)]}function ou(n){return n.replace(/start|end/g,e=>_R[e])}function VR(n,e,t){const r=["left","right"],i=["right","left"],o=["top","bottom"],s=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?o:s;default:return[]}}function qR(n,e,t,r){const i=Ei(n);let o=VR(wn(n),t==="start",r);return i&&(o=o.map(s=>s+"-"+i),e&&(o=o.concat(o.map(ou)))),o}function ea(n){return n.replace(/left|right|bottom|top/g,e=>FR[e])}function GR(n){return{top:0,right:0,bottom:0,left:0,...n}}function C0(n){return typeof n!="number"?GR(n):{top:n,right:n,bottom:n,left:n}}function ta(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function Xh(n,e,t){let{reference:r,floating:i}=n;const o=Ln(e),s=xf(e),a=vf(s),l=wn(e),c=o==="y",u=r.x+r.width/2-i.width/2,f=r.y+r.height/2-i.height/2,d=r[a]/2-i[a]/2;let h;switch(l){case"top":h={x:u,y:r.y-i.height};break;case"bottom":h={x:u,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:f};break;case"left":h={x:r.x-i.width,y:f};break;default:h={x:r.x,y:r.y}}switch(Ei(e)){case"start":h[s]-=d*(t&&c?-1:1);break;case"end":h[s]+=d*(t&&c?-1:1);break}return h}const JR=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:s}=t,a=o.filter(Boolean),l=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:n,floating:e,strategy:i}),{x:u,y:f}=Xh(c,r,l),d=r,h={},p=0;for(let m=0;m<a.length;m++){const{name:g,fn:b}=a[m],{x,y:w,data:C,reset:S}=await b({x:u,y:f,initialPlacement:r,placement:d,strategy:i,middlewareData:h,rects:c,platform:s,elements:{reference:n,floating:e}});u=x??u,f=w??f,h={...h,[g]:{...h[g],...C}},S&&p<=50&&(p++,typeof S=="object"&&(S.placement&&(d=S.placement),S.rects&&(c=S.rects===!0?await s.getElementRects({reference:n,floating:e,strategy:i}):S.rects),{x:u,y:f}=Xh(c,d,l)),m=-1)}return{x:u,y:f,placement:d,strategy:i,middlewareData:h}};async function So(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:s,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:d=!1,padding:h=0}=bn(e,n),p=C0(h),g=a[d?f==="floating"?"reference":"floating":f],b=ta(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(g)))==null||t?g:g.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),x=f==="floating"?{x:r,y:i,width:s.floating.width,height:s.floating.height}:s.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(a.floating)),C=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},S=ta(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:x,offsetParent:w,strategy:l}):x);return{top:(b.top-S.top+p.top)/C.y,bottom:(S.bottom-b.bottom+p.bottom)/C.y,left:(b.left-S.left+p.left)/C.x,right:(S.right-b.right+p.right)/C.x}}const UR=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:i,rects:o,platform:s,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=bn(n,e)||{};if(c==null)return{};const f=C0(u),d={x:t,y:r},h=xf(i),p=vf(h),m=await s.getDimensions(c),g=h==="y",b=g?"top":"left",x=g?"bottom":"right",w=g?"clientHeight":"clientWidth",C=o.reference[p]+o.reference[h]-d[h]-o.floating[p],S=d[h]-o.reference[h],k=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let O=k?k[w]:0;(!O||!await(s.isElement==null?void 0:s.isElement(k)))&&(O=a.floating[w]||o.floating[p]);const M=C/2-S/2,R=O/2-m[p]/2-1,T=jn(f[b],R),P=jn(f[x],R),z=T,U=O-m[p]-P,H=O/2-m[p]/2+M,Se=iu(z,H,U),J=!l.arrow&&Ei(i)!=null&&H!==Se&&o.reference[p]/2-(H<z?T:P)-m[p]/2<0,oe=J?H<z?H-z:H-U:0;return{[h]:d[h]+oe,data:{[h]:Se,centerOffset:H-Se-oe,...J&&{alignmentOffset:oe}},reset:J}}}),KR=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=bn(n,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const b=wn(i),x=Ln(a),w=wn(a)===a,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),S=d||(w||!m?[ea(a)]:HR(a)),k=p!=="none";!d&&k&&S.push(...qR(a,m,p,C));const O=[a,...S],M=await So(e,g),R=[];let T=((r=o.flip)==null?void 0:r.overflows)||[];if(u&&R.push(M[b]),f){const H=WR(i,s,C);R.push(M[H[0]],M[H[1]])}if(T=[...T,{placement:i,overflows:R}],!R.every(H=>H<=0)){var P,z;const H=(((P=o.flip)==null?void 0:P.index)||0)+1,Se=O[H];if(Se)return{data:{index:H,overflows:T},reset:{placement:Se}};let J=(z=T.filter(oe=>oe.overflows[0]<=0).sort((oe,ee)=>oe.overflows[1]-ee.overflows[1])[0])==null?void 0:z.placement;if(!J)switch(h){case"bestFit":{var U;const oe=(U=T.filter(ee=>{if(k){const Ce=Ln(ee.placement);return Ce===x||Ce==="y"}return!0}).map(ee=>[ee.placement,ee.overflows.filter(Ce=>Ce>0).reduce((Ce,Ot)=>Ce+Ot,0)]).sort((ee,Ce)=>ee[1]-Ce[1])[0])==null?void 0:U[0];oe&&(J=oe);break}case"initialPlacement":J=a;break}if(i!==J)return{reset:{placement:J}}}return{}}}};function Qh(n,e){return{top:n.top-e.height,right:n.right-e.width,bottom:n.bottom-e.height,left:n.left-e.width}}function Zh(n){return BR.some(e=>n[e]>=0)}const YR=function(n){return n===void 0&&(n={}),{name:"hide",options:n,async fn(e){const{rects:t}=e,{strategy:r="referenceHidden",...i}=bn(n,e);switch(r){case"referenceHidden":{const o=await So(e,{...i,elementContext:"reference"}),s=Qh(o,t.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:Zh(s)}}}case"escaped":{const o=await So(e,{...i,altBoundary:!0}),s=Qh(o,t.floating);return{data:{escapedOffsets:s,escaped:Zh(s)}}}default:return{}}}}};async function XR(n,e){const{placement:t,platform:r,elements:i}=n,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),s=wn(t),a=Ei(t),l=Ln(t)==="y",c=["left","top"].includes(s)?-1:1,u=o&&l?-1:1,f=bn(e,n);let{mainAxis:d,crossAxis:h,alignmentAxis:p}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return a&&typeof p=="number"&&(h=a==="end"?p*-1:p),l?{x:h*u,y:d*c}:{x:d*c,y:h*u}}const QR=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:o,placement:s,middlewareData:a}=e,l=await XR(e,n);return s===((t=a.offset)==null?void 0:t.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:o+l.y,data:{...l,placement:s}}}}},ZR=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:g=>{let{x:b,y:x}=g;return{x:b,y:x}}},...l}=bn(n,e),c={x:t,y:r},u=await So(e,l),f=Ln(wn(i)),d=wf(f);let h=c[d],p=c[f];if(o){const g=d==="y"?"top":"left",b=d==="y"?"bottom":"right",x=h+u[g],w=h-u[b];h=iu(x,h,w)}if(s){const g=f==="y"?"top":"left",b=f==="y"?"bottom":"right",x=p+u[g],w=p-u[b];p=iu(x,p,w)}const m=a.fn({...e,[d]:h,[f]:p});return{...m,data:{x:m.x-t,y:m.y-r,enabled:{[d]:o,[f]:s}}}}}},eA=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:i,rects:o,middlewareData:s}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=bn(n,e),u={x:t,y:r},f=Ln(i),d=wf(f);let h=u[d],p=u[f];const m=bn(a,e),g=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=d==="y"?"height":"width",C=o.reference[d]-o.floating[w]+g.mainAxis,S=o.reference[d]+o.reference[w]-g.mainAxis;h<C?h=C:h>S&&(h=S)}if(c){var b,x;const w=d==="y"?"width":"height",C=["top","left"].includes(wn(i)),S=o.reference[f]-o.floating[w]+(C&&((b=s.offset)==null?void 0:b[f])||0)+(C?0:g.crossAxis),k=o.reference[f]+o.reference[w]+(C?0:((x=s.offset)==null?void 0:x[f])||0)-(C?g.crossAxis:0);p<S?p=S:p>k&&(p=k)}return{[d]:h,[f]:p}}}},tA=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:i,rects:o,platform:s,elements:a}=e,{apply:l=()=>{},...c}=bn(n,e),u=await So(e,c),f=wn(i),d=Ei(i),h=Ln(i)==="y",{width:p,height:m}=o.floating;let g,b;f==="top"||f==="bottom"?(g=f,b=d===(await(s.isRTL==null?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(b=f,g=d==="end"?"top":"bottom");const x=m-u.top-u.bottom,w=p-u.left-u.right,C=jn(m-u[g],x),S=jn(p-u[b],w),k=!e.middlewareData.shift;let O=C,M=S;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(M=w),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(O=x),k&&!d){const T=pt(u.left,0),P=pt(u.right,0),z=pt(u.top,0),U=pt(u.bottom,0);h?M=p-2*(T!==0||P!==0?T+P:pt(u.left,u.right)):O=m-2*(z!==0||U!==0?z+U:pt(u.top,u.bottom))}await l({...e,availableWidth:M,availableHeight:O});const R=await s.getDimensions(a.floating);return p!==R.width||m!==R.height?{reset:{rects:!0}}:{}}}};function Va(){return typeof window<"u"}function Ti(n){return k0(n)?(n.nodeName||"").toLowerCase():"#document"}function St(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function on(n){var e;return(e=(k0(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function k0(n){return Va()?n instanceof Node||n instanceof St(n).Node:!1}function Bt(n){return Va()?n instanceof Element||n instanceof St(n).Element:!1}function Zt(n){return Va()?n instanceof HTMLElement||n instanceof St(n).HTMLElement:!1}function ep(n){return!Va()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof St(n).ShadowRoot}function Bo(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=Ft(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function nA(n){return["table","td","th"].includes(Ti(n))}function qa(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function Sf(n){const e=Cf(),t=Bt(n)?Ft(n):n;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function rA(n){let e=Bn(n);for(;Zt(e)&&!gi(e);){if(Sf(e))return e;if(qa(e))return null;e=Bn(e)}return null}function Cf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function gi(n){return["html","body","#document"].includes(Ti(n))}function Ft(n){return St(n).getComputedStyle(n)}function Ga(n){return Bt(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function Bn(n){if(Ti(n)==="html")return n;const e=n.assignedSlot||n.parentNode||ep(n)&&n.host||on(n);return ep(e)?e.host:e}function O0(n){const e=Bn(n);return gi(e)?n.ownerDocument?n.ownerDocument.body:n.body:Zt(e)&&Bo(e)?e:O0(e)}function Co(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=O0(n),o=i===((r=n.ownerDocument)==null?void 0:r.body),s=St(i);if(o){const a=su(s);return e.concat(s,s.visualViewport||[],Bo(i)?i:[],a&&t?Co(a):[])}return e.concat(i,Co(i,[],t))}function su(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function M0(n){const e=Ft(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Zt(n),o=i?n.offsetWidth:t,s=i?n.offsetHeight:r,a=Zs(t)!==o||Zs(r)!==s;return a&&(t=o,r=s),{width:t,height:r,$:a}}function kf(n){return Bt(n)?n:n.contextElement}function ni(n){const e=kf(n);if(!Zt(e))return Yt(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:o}=M0(e);let s=(o?Zs(t.width):t.width)/r,a=(o?Zs(t.height):t.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!a||!Number.isFinite(a))&&(a=1),{x:s,y:a}}const iA=Yt(0);function E0(n){const e=St(n);return!Cf()||!e.visualViewport?iA:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function oA(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==St(n)?!1:e}function kr(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),o=kf(n);let s=Yt(1);e&&(r?Bt(r)&&(s=ni(r)):s=ni(n));const a=oA(o,t,r)?E0(o):Yt(0);let l=(i.left+a.x)/s.x,c=(i.top+a.y)/s.y,u=i.width/s.x,f=i.height/s.y;if(o){const d=St(o),h=r&&Bt(r)?St(r):r;let p=d,m=su(p);for(;m&&r&&h!==p;){const g=ni(m),b=m.getBoundingClientRect(),x=Ft(m),w=b.left+(m.clientLeft+parseFloat(x.paddingLeft))*g.x,C=b.top+(m.clientTop+parseFloat(x.paddingTop))*g.y;l*=g.x,c*=g.y,u*=g.x,f*=g.y,l+=w,c+=C,p=St(m),m=su(p)}}return ta({width:u,height:f,x:l,y:c})}function Of(n,e){const t=Ga(n).scrollLeft;return e?e.left+t:kr(on(n)).left+t}function T0(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:Of(n,r)),o=r.top+e.scrollTop;return{x:i,y:o}}function sA(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const o=i==="fixed",s=on(r),a=e?qa(e.floating):!1;if(r===s||a&&o)return t;let l={scrollLeft:0,scrollTop:0},c=Yt(1);const u=Yt(0),f=Zt(r);if((f||!f&&!o)&&((Ti(r)!=="body"||Bo(s))&&(l=Ga(r)),Zt(r))){const h=kr(r);c=ni(r),u.x=h.x+r.clientLeft,u.y=h.y+r.clientTop}const d=s&&!f&&!o?T0(s,l,!0):Yt(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:t.y*c.y-l.scrollTop*c.y+u.y+d.y}}function aA(n){return Array.from(n.getClientRects())}function lA(n){const e=on(n),t=Ga(n),r=n.ownerDocument.body,i=pt(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=pt(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let s=-t.scrollLeft+Of(n);const a=-t.scrollTop;return Ft(r).direction==="rtl"&&(s+=pt(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:s,y:a}}function cA(n,e){const t=St(n),r=on(n),i=t.visualViewport;let o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;const c=Cf();(!c||c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a,y:l}}function uA(n,e){const t=kr(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,o=Zt(n)?ni(n):Yt(1),s=n.clientWidth*o.x,a=n.clientHeight*o.y,l=i*o.x,c=r*o.y;return{width:s,height:a,x:l,y:c}}function tp(n,e,t){let r;if(e==="viewport")r=cA(n,t);else if(e==="document")r=lA(on(n));else if(Bt(e))r=uA(e,t);else{const i=E0(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return ta(r)}function R0(n,e){const t=Bn(n);return t===e||!Bt(t)||gi(t)?!1:Ft(t).position==="fixed"||R0(t,e)}function fA(n,e){const t=e.get(n);if(t)return t;let r=Co(n,[],!1).filter(a=>Bt(a)&&Ti(a)!=="body"),i=null;const o=Ft(n).position==="fixed";let s=o?Bn(n):n;for(;Bt(s)&&!gi(s);){const a=Ft(s),l=Sf(s);!l&&a.position==="fixed"&&(i=null),(o?!l&&!i:!l&&a.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Bo(s)&&!l&&R0(n,s))?r=r.filter(u=>u!==s):i=a,s=Bn(s)}return e.set(n,r),r}function dA(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const s=[...t==="clippingAncestors"?qa(e)?[]:fA(e,this._c):[].concat(t),r],a=s[0],l=s.reduce((c,u)=>{const f=tp(e,u,i);return c.top=pt(f.top,c.top),c.right=jn(f.right,c.right),c.bottom=jn(f.bottom,c.bottom),c.left=pt(f.left,c.left),c},tp(e,a,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function hA(n){const{width:e,height:t}=M0(n);return{width:e,height:t}}function pA(n,e,t){const r=Zt(e),i=on(e),o=t==="fixed",s=kr(n,!0,o,e);let a={scrollLeft:0,scrollTop:0};const l=Yt(0);if(r||!r&&!o)if((Ti(e)!=="body"||Bo(i))&&(a=Ga(e)),r){const d=kr(e,!0,o,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else i&&(l.x=Of(i));const c=i&&!r&&!o?T0(i,a):Yt(0),u=s.left+a.scrollLeft-l.x-c.x,f=s.top+a.scrollTop-l.y-c.y;return{x:u,y:f,width:s.width,height:s.height}}function Pl(n){return Ft(n).position==="static"}function np(n,e){if(!Zt(n)||Ft(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return on(n)===t&&(t=t.ownerDocument.body),t}function A0(n,e){const t=St(n);if(qa(n))return t;if(!Zt(n)){let i=Bn(n);for(;i&&!gi(i);){if(Bt(i)&&!Pl(i))return i;i=Bn(i)}return t}let r=np(n,e);for(;r&&nA(r)&&Pl(r);)r=np(r,e);return r&&gi(r)&&Pl(r)&&!Sf(r)?t:r||rA(n)||t}const mA=async function(n){const e=this.getOffsetParent||A0,t=this.getDimensions,r=await t(n.floating);return{reference:pA(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function gA(n){return Ft(n).direction==="rtl"}const yA={convertOffsetParentRelativeRectToViewportRelativeRect:sA,getDocumentElement:on,getClippingRect:dA,getOffsetParent:A0,getElementRects:mA,getClientRects:aA,getDimensions:hA,getScale:ni,isElement:Bt,isRTL:gA};function bA(n,e){let t=null,r;const i=on(n);function o(){var a;clearTimeout(r),(a=t)==null||a.disconnect(),t=null}function s(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),o();const{left:c,top:u,width:f,height:d}=n.getBoundingClientRect();if(a||e(),!f||!d)return;const h=us(u),p=us(i.clientWidth-(c+f)),m=us(i.clientHeight-(u+d)),g=us(c),x={rootMargin:-h+"px "+-p+"px "+-m+"px "+-g+"px",threshold:pt(0,jn(1,l))||1};let w=!0;function C(S){const k=S[0].intersectionRatio;if(k!==l){if(!w)return s();k?s(!1,k):r=setTimeout(()=>{s(!1,1e-7)},1e3)}w=!1}try{t=new IntersectionObserver(C,{...x,root:i.ownerDocument})}catch{t=new IntersectionObserver(C,x)}t.observe(n)}return s(!0),o}function wA(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=kf(n),u=i||o?[...c?Co(c):[],...Co(e)]:[];u.forEach(b=>{i&&b.addEventListener("scroll",t,{passive:!0}),o&&b.addEventListener("resize",t)});const f=c&&a?bA(c,t):null;let d=-1,h=null;s&&(h=new ResizeObserver(b=>{let[x]=b;x&&x.target===c&&h&&(h.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var w;(w=h)==null||w.observe(e)})),t()}),c&&!l&&h.observe(c),h.observe(e));let p,m=l?kr(n):null;l&&g();function g(){const b=kr(n);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&t(),m=b,p=requestAnimationFrame(g)}return t(),()=>{var b;u.forEach(x=>{i&&x.removeEventListener("scroll",t),o&&x.removeEventListener("resize",t)}),f?.(),(b=h)==null||b.disconnect(),h=null,l&&cancelAnimationFrame(p)}}const vA=QR,xA=ZR,SA=KR,CA=tA,kA=YR,rp=UR,OA=eA,MA=(n,e,t)=>{const r=new Map,i={platform:yA,...t},o={...i.platform,_c:r};return JR(n,e,{...i,platform:o})};var Ts=typeof document<"u"?v.useLayoutEffect:v.useEffect;function na(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,i;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!na(n[r],e[r]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=t;r--!==0;){const o=i[r];if(!(o==="_owner"&&n.$$typeof)&&!na(n[o],e[o]))return!1}return!0}return n!==n&&e!==e}function D0(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function ip(n,e){const t=D0(n);return Math.round(e*t)/t}function Nl(n){const e=v.useRef(n);return Ts(()=>{e.current=n}),e}function EA(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:i,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=n,[u,f]=v.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[d,h]=v.useState(r);na(d,r)||h(r);const[p,m]=v.useState(null),[g,b]=v.useState(null),x=v.useCallback(ee=>{ee!==k.current&&(k.current=ee,m(ee))},[]),w=v.useCallback(ee=>{ee!==O.current&&(O.current=ee,b(ee))},[]),C=o||p,S=s||g,k=v.useRef(null),O=v.useRef(null),M=v.useRef(u),R=l!=null,T=Nl(l),P=Nl(i),z=Nl(c),U=v.useCallback(()=>{if(!k.current||!O.current)return;const ee={placement:e,strategy:t,middleware:d};P.current&&(ee.platform=P.current),MA(k.current,O.current,ee).then(Ce=>{const Ot={...Ce,isPositioned:z.current!==!1};H.current&&!na(M.current,Ot)&&(M.current=Ot,xi.flushSync(()=>{f(Ot)}))})},[d,e,t,P,z]);Ts(()=>{c===!1&&M.current.isPositioned&&(M.current.isPositioned=!1,f(ee=>({...ee,isPositioned:!1})))},[c]);const H=v.useRef(!1);Ts(()=>(H.current=!0,()=>{H.current=!1}),[]),Ts(()=>{if(C&&(k.current=C),S&&(O.current=S),C&&S){if(T.current)return T.current(C,S,U);U()}},[C,S,U,T,R]);const Se=v.useMemo(()=>({reference:k,floating:O,setReference:x,setFloating:w}),[x,w]),J=v.useMemo(()=>({reference:C,floating:S}),[C,S]),oe=v.useMemo(()=>{const ee={position:t,left:0,top:0};if(!J.floating)return ee;const Ce=ip(J.floating,u.x),Ot=ip(J.floating,u.y);return a?{...ee,transform:"translate("+Ce+"px, "+Ot+"px)",...D0(J.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:Ce,top:Ot}},[t,a,J.floating,u.x,u.y]);return v.useMemo(()=>({...u,update:U,refs:Se,elements:J,floatingStyles:oe}),[u,U,Se,J,oe])}const TA=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:i}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?rp({element:r.current,padding:i}).fn(t):{}:r?rp({element:r,padding:i}).fn(t):{}}}},RA=(n,e)=>({...vA(n),options:[n,e]}),AA=(n,e)=>({...xA(n),options:[n,e]}),DA=(n,e)=>({...OA(n),options:[n,e]}),$A=(n,e)=>({...SA(n),options:[n,e]}),PA=(n,e)=>({...CA(n),options:[n,e]}),NA=(n,e)=>({...kA(n),options:[n,e]}),IA=(n,e)=>({...TA(n),options:[n,e]}),zA=v.forwardRef((n,e)=>{const{children:t,width:r=10,height:i=5,...o}=n;return v.createElement(Rr.svg,Ae({},o,{ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),n.asChild?t:v.createElement("polygon",{points:"0,0 30,0 15,10"}))}),jA=zA;function LA(n){const[e,t]=v.useState(void 0);return mi(()=>{if(n){t({width:n.offsetWidth,height:n.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let s,a;if("borderBoxSize"in o){const l=o.borderBoxSize,c=Array.isArray(l)?l[0]:l;s=c.inlineSize,a=c.blockSize}else s=n.offsetWidth,a=n.offsetHeight;t({width:s,height:a})});return r.observe(n,{box:"border-box"}),()=>r.unobserve(n)}else t(void 0)},[n]),e}const $0="Popper",[P0,N0]=w0($0),[BA,I0]=P0($0),FA=n=>{const{__scopePopper:e,children:t}=n,[r,i]=v.useState(null);return v.createElement(BA,{scope:e,anchor:r,onAnchorChange:i},t)},_A="PopperAnchor",WA=v.forwardRef((n,e)=>{const{__scopePopper:t,virtualRef:r,...i}=n,o=I0(_A,t),s=v.useRef(null),a=Oi(e,s);return v.useEffect(()=>{o.onAnchorChange(r?.current||s.current)}),r?null:v.createElement(Rr.div,Ae({},i,{ref:a}))}),z0="PopperContent",[HA,VA]=P0(z0),qA=v.forwardRef((n,e)=>{var t,r,i,o,s,a,l,c;const{__scopePopper:u,side:f="bottom",sideOffset:d=0,align:h="center",alignOffset:p=0,arrowPadding:m=0,avoidCollisions:g=!0,collisionBoundary:b=[],collisionPadding:x=0,sticky:w="partial",hideWhenDetached:C=!1,updatePositionStrategy:S="optimized",onPlaced:k,...O}=n,M=I0(z0,u),[R,T]=v.useState(null),P=Oi(e,De=>T(De)),[z,U]=v.useState(null),H=LA(z),Se=(t=H?.width)!==null&&t!==void 0?t:0,J=(r=H?.height)!==null&&r!==void 0?r:0,oe=f+(h!=="center"?"-"+h:""),ee=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},Ce=Array.isArray(b)?b:[b],Ot=Ce.length>0,Pr={padding:ee,boundary:Ce.filter(KA),altBoundary:Ot},{refs:tl,floatingStyles:qo,placement:nl,isPositioned:Nr,middlewareData:vn}=EA({strategy:"fixed",placement:oe,whileElementsMounted:(...De)=>wA(...De,{animationFrame:S==="always"}),elements:{reference:M.anchor},middleware:[RA({mainAxis:d+J,alignmentAxis:p}),g&&AA({mainAxis:!0,crossAxis:!1,limiter:w==="partial"?DA():void 0,...Pr}),g&&$A({...Pr}),PA({...Pr,apply:({elements:De,rects:de,availableWidth:Mt,availableHeight:le})=>{const{width:me,height:Et}=de.reference,Gn=De.floating.style;Gn.setProperty("--radix-popper-available-width",`${Mt}px`),Gn.setProperty("--radix-popper-available-height",`${le}px`),Gn.setProperty("--radix-popper-anchor-width",`${me}px`),Gn.setProperty("--radix-popper-anchor-height",`${Et}px`)}}),z&&IA({element:z,padding:m}),YA({arrowWidth:Se,arrowHeight:J}),C&&NA({strategy:"referenceHidden",...Pr})]}),[Go,I]=j0(nl),L=Mi(k);mi(()=>{Nr&&L?.()},[Nr,L]);const ne=(i=vn.arrow)===null||i===void 0?void 0:i.x,Q=(o=vn.arrow)===null||o===void 0?void 0:o.y,Z=((s=vn.arrow)===null||s===void 0?void 0:s.centerOffset)!==0,[pe,ke]=v.useState();return mi(()=>{R&&ke(window.getComputedStyle(R).zIndex)},[R]),v.createElement("div",{ref:tl.setFloating,"data-radix-popper-content-wrapper":"",style:{...qo,transform:Nr?qo.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:pe,"--radix-popper-transform-origin":[(a=vn.transformOrigin)===null||a===void 0?void 0:a.x,(l=vn.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:n.dir},v.createElement(HA,{scope:u,placedSide:Go,onArrowChange:U,arrowX:ne,arrowY:Q,shouldHideArrow:Z},v.createElement(Rr.div,Ae({"data-side":Go,"data-align":I},O,{ref:P,style:{...O.style,animation:Nr?void 0:"none",opacity:(c=vn.hide)!==null&&c!==void 0&&c.referenceHidden?0:void 0}}))))}),GA="PopperArrow",JA={top:"bottom",right:"left",bottom:"top",left:"right"},UA=v.forwardRef(function(e,t){const{__scopePopper:r,...i}=e,o=VA(GA,r),s=JA[o.placedSide];return v.createElement("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[s]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0}},v.createElement(jA,Ae({},i,{ref:t,style:{...i.style,display:"block"}})))});function KA(n){return n!==null}const YA=n=>({name:"transformOrigin",options:n,fn(e){var t,r,i,o,s;const{placement:a,rects:l,middlewareData:c}=e,f=((t=c.arrow)===null||t===void 0?void 0:t.centerOffset)!==0,d=f?0:n.arrowWidth,h=f?0:n.arrowHeight,[p,m]=j0(a),g={start:"0%",center:"50%",end:"100%"}[m],b=((r=(i=c.arrow)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0)+d/2,x=((o=(s=c.arrow)===null||s===void 0?void 0:s.y)!==null&&o!==void 0?o:0)+h/2;let w="",C="";return p==="bottom"?(w=f?g:`${b}px`,C=`${-h}px`):p==="top"?(w=f?g:`${b}px`,C=`${l.floating.height+h}px`):p==="right"?(w=`${-h}px`,C=f?g:`${x}px`):p==="left"&&(w=`${l.floating.width+h}px`,C=f?g:`${x}px`),{data:{x:w,y:C}}}});function j0(n){const[e,t="center"]=n.split("-");return[e,t]}const XA=FA,QA=WA,ZA=qA,eD=UA,tD=v.forwardRef((n,e)=>{var t;const{container:r=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...i}=n;return r?om.createPortal(v.createElement(Rr.div,Ae({},i,{ref:e})),r):null});function nD(n,e){return v.useReducer((t,r)=>{const i=e[t][r];return i??t},n)}const Mf=n=>{const{present:e,children:t}=n,r=rD(e),i=typeof t=="function"?t({present:r.isPresent}):v.Children.only(t),o=Oi(r.ref,i.ref);return typeof t=="function"||r.isPresent?v.cloneElement(i,{ref:o}):null};Mf.displayName="Presence";function rD(n){const[e,t]=v.useState(),r=v.useRef({}),i=v.useRef(n),o=v.useRef("none"),s=n?"mounted":"unmounted",[a,l]=nD(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return v.useEffect(()=>{const c=fs(r.current);o.current=a==="mounted"?c:"none"},[a]),mi(()=>{const c=r.current,u=i.current;if(u!==n){const d=o.current,h=fs(c);n?l("MOUNT"):h==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==h?"ANIMATION_OUT":"UNMOUNT"),i.current=n}},[n,l]),mi(()=>{if(e){const c=f=>{const h=fs(r.current).includes(f.animationName);f.target===e&&h&&xi.flushSync(()=>l("ANIMATION_END"))},u=f=>{f.target===e&&(o.current=fs(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:v.useCallback(c=>{c&&(r.current=getComputedStyle(c)),t(c)},[])}}function fs(n){return n?.animationName||"none"}function iD({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,i]=oD({defaultProp:e,onChange:t}),o=n!==void 0,s=o?n:r,a=Mi(t),l=v.useCallback(c=>{if(o){const f=typeof c=="function"?c(n):c;f!==n&&a(f)}else i(c)},[o,n,i,a]);return[s,l]}function oD({defaultProp:n,onChange:e}){const t=v.useState(n),[r]=t,i=v.useRef(r),o=Mi(e);return v.useEffect(()=>{i.current!==r&&(o(r),i.current=r)},[r,i,o]),t}const sD=v.forwardRef((n,e)=>v.createElement(Rr.span,Ae({},n,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...n.style}}))),aD=sD,[Ja]=w0("Tooltip",[N0]),Ua=N0(),lD="TooltipProvider",cD=700,au="tooltip.open",[uD,Ef]=Ja(lD),fD=n=>{const{__scopeTooltip:e,delayDuration:t=cD,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:o}=n,[s,a]=v.useState(!0),l=v.useRef(!1),c=v.useRef(0);return v.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),v.createElement(uD,{scope:e,isOpenDelayed:s,delayDuration:t,onOpen:v.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:v.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:v.useCallback(u=>{l.current=u},[]),disableHoverableContent:i},o)},Tf="Tooltip",[dD,Fo]=Ja(Tf),hD=n=>{const{__scopeTooltip:e,children:t,open:r,defaultOpen:i=!1,onOpenChange:o,disableHoverableContent:s,delayDuration:a}=n,l=Ef(Tf,n.__scopeTooltip),c=Ua(e),[u,f]=v.useState(null),d=LR(),h=v.useRef(0),p=s??l.disableHoverableContent,m=a??l.delayDuration,g=v.useRef(!1),[b=!1,x]=iD({prop:r,defaultProp:i,onChange:O=>{O?(l.onOpen(),document.dispatchEvent(new CustomEvent(au))):l.onClose(),o?.(O)}}),w=v.useMemo(()=>b?g.current?"delayed-open":"instant-open":"closed",[b]),C=v.useCallback(()=>{window.clearTimeout(h.current),g.current=!1,x(!0)},[x]),S=v.useCallback(()=>{window.clearTimeout(h.current),x(!1)},[x]),k=v.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{g.current=!0,x(!0)},m)},[m,x]);return v.useEffect(()=>()=>window.clearTimeout(h.current),[]),v.createElement(XA,c,v.createElement(dD,{scope:e,contentId:d,open:b,stateAttribute:w,trigger:u,onTriggerChange:f,onTriggerEnter:v.useCallback(()=>{l.isOpenDelayed?k():C()},[l.isOpenDelayed,k,C]),onTriggerLeave:v.useCallback(()=>{p?S():window.clearTimeout(h.current)},[S,p]),onOpen:C,onClose:S,disableHoverableContent:p},t))},op="TooltipTrigger",pD=v.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,i=Fo(op,t),o=Ef(op,t),s=Ua(t),a=v.useRef(null),l=Oi(e,a,i.onTriggerChange),c=v.useRef(!1),u=v.useRef(!1),f=v.useCallback(()=>c.current=!1,[]);return v.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),v.createElement(QA,Ae({asChild:!0},s),v.createElement(Rr.button,Ae({"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute},r,{ref:l,onPointerMove:un(n.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!o.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:un(n.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:un(n.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:un(n.onFocus,()=>{c.current||i.onOpen()}),onBlur:un(n.onBlur,i.onClose),onClick:un(n.onClick,i.onClose)})))}),L0="TooltipPortal",[mD,gD]=Ja(L0,{forceMount:void 0}),yD=n=>{const{__scopeTooltip:e,forceMount:t,children:r,container:i}=n,o=Fo(L0,e);return v.createElement(mD,{scope:e,forceMount:t},v.createElement(Mf,{present:t||o.open},v.createElement(tD,{asChild:!0,container:i},r)))},ko="TooltipContent",bD=v.forwardRef((n,e)=>{const t=gD(ko,n.__scopeTooltip),{forceMount:r=t.forceMount,side:i="top",...o}=n,s=Fo(ko,n.__scopeTooltip);return v.createElement(Mf,{present:r||s.open},s.disableHoverableContent?v.createElement(B0,Ae({side:i},o,{ref:e})):v.createElement(wD,Ae({side:i},o,{ref:e})))}),wD=v.forwardRef((n,e)=>{const t=Fo(ko,n.__scopeTooltip),r=Ef(ko,n.__scopeTooltip),i=v.useRef(null),o=Oi(e,i),[s,a]=v.useState(null),{trigger:l,onClose:c}=t,u=i.current,{onPointerInTransitChange:f}=r,d=v.useCallback(()=>{a(null),f(!1)},[f]),h=v.useCallback((p,m)=>{const g=p.currentTarget,b={x:p.clientX,y:p.clientY},x=kD(b,g.getBoundingClientRect()),w=OD(b,x),C=MD(m.getBoundingClientRect()),S=TD([...w,...C]);a(S),f(!0)},[f]);return v.useEffect(()=>()=>d(),[d]),v.useEffect(()=>{if(l&&u){const p=g=>h(g,u),m=g=>h(g,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",m)}}},[l,u,h,d]),v.useEffect(()=>{if(s){const p=m=>{const g=m.target,b={x:m.clientX,y:m.clientY},x=l?.contains(g)||u?.contains(g),w=!ED(b,s);x?d():w&&(d(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,s,c,d]),v.createElement(B0,Ae({},n,{ref:o}))}),[vD,xD]=Ja(Tf,{isInside:!1}),B0=v.forwardRef((n,e)=>{const{__scopeTooltip:t,children:r,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:s,...a}=n,l=Fo(ko,t),c=Ua(t),{onClose:u}=l;return v.useEffect(()=>(document.addEventListener(au,u),()=>document.removeEventListener(au,u)),[u]),v.useEffect(()=>{if(l.trigger){const f=d=>{const h=d.target;h!=null&&h.contains(l.trigger)&&u()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,u]),v.createElement(PR,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:s,onFocusOutside:f=>f.preventDefault(),onDismiss:u},v.createElement(ZA,Ae({"data-state":l.stateAttribute},c,a,{ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),v.createElement(x0,null,r),v.createElement(vD,{scope:t,isInside:!0},v.createElement(aD,{id:l.contentId,role:"tooltip"},i||r))))}),SD="TooltipArrow",CD=v.forwardRef((n,e)=>{const{__scopeTooltip:t,...r}=n,i=Ua(t);return xD(SD,t).isInside?null:v.createElement(eD,Ae({},i,r,{ref:e}))});function kD(n,e){const t=Math.abs(e.top-n.y),r=Math.abs(e.bottom-n.y),i=Math.abs(e.right-n.x),o=Math.abs(e.left-n.x);switch(Math.min(t,r,i,o)){case o:return"left";case i:return"right";case t:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function OD(n,e,t=5){const r=[];switch(e){case"top":r.push({x:n.x-t,y:n.y+t},{x:n.x+t,y:n.y+t});break;case"bottom":r.push({x:n.x-t,y:n.y-t},{x:n.x+t,y:n.y-t});break;case"left":r.push({x:n.x+t,y:n.y-t},{x:n.x+t,y:n.y+t});break;case"right":r.push({x:n.x-t,y:n.y-t},{x:n.x-t,y:n.y+t});break}return r}function MD(n){const{top:e,right:t,bottom:r,left:i}=n;return[{x:i,y:e},{x:t,y:e},{x:t,y:r},{x:i,y:r}]}function ED(n,e){const{x:t,y:r}=n;let i=!1;for(let o=0,s=e.length-1;o<e.length;s=o++){const a=e[o].x,l=e[o].y,c=e[s].x,u=e[s].y;l>r!=u>r&&t<(c-a)*(r-l)/(u-l)+a&&(i=!i)}return i}function TD(n){const e=n.slice();return e.sort((t,r)=>t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0),RD(e)}function RD(n){if(n.length<=1)return n.slice();const e=[];for(let r=0;r<n.length;r++){const i=n[r];for(;e.length>=2;){const o=e[e.length-1],s=e[e.length-2];if((o.x-s.x)*(i.y-s.y)>=(o.y-s.y)*(i.x-s.x))e.pop();else break}e.push(i)}e.pop();const t=[];for(let r=n.length-1;r>=0;r--){const i=n[r];for(;t.length>=2;){const o=t[t.length-1],s=t[t.length-2];if((o.x-s.x)*(i.y-s.y)>=(o.y-s.y)*(i.x-s.x))t.pop();else break}t.push(i)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}const AD=fD,DD=hD,$D=pD,PD=yD,ND=bD,sp=CD,zi=({children:n,label:e,variant:t,onClick:r,disabled:i,className:o,showBorder:s=!1})=>{if(!e)return y.jsx(Kf,{className:o,variant:t,onClick:r,disabled:i,withTooltip:!1,children:n});const a=s?y.jsxs(vt,{padding:4,margin:2,background:"neutral0",hasRadius:!0,shadow:"filterShadow",className:o,style:{width:"100%"},children:[y.jsx(Me,{style:{fontSize:"10px"},children:e}),y.jsx(sp,{})]}):y.jsxs(y.Fragment,{children:[y.jsx(Me,{style:{fontSize:"10px"},children:e}),y.jsx(sp,{})]});return y.jsx(AD,{children:y.jsxs(DD,{children:[y.jsx($D,{asChild:!0,children:y.jsx(Kf,{variant:t,onClick:r,disabled:i,withTooltip:!1,className:o,style:{width:"100%"},justifyContent:"flex-start",children:n})}),y.jsx(PD,{children:y.jsx(ND,{style:{background:"#000",color:"#fff",padding:"4px",fontSize:"10px",borderRadius:"4px"},sideOffset:5,children:a})})]})})},A=n=>`${wt}.${n}`,F0=({...n})=>y.jsx(dm,{...n,children:n.label}),ID=({...n})=>n.options?y.jsx(y.Fragment,{children:n.options.map((e,t)=>y.jsx(F0,{...e,disabled:!0},t))}):y.jsx(y.Fragment,{}),zD=({...n})=>n.options?y.jsx(Yf.Group,{children:n.options.map(e=>y.jsx(Yf.Item,{checked:!1,disabled:!0,children:e.label}))}):y.jsx(y.Fragment,{}),jD=({...n})=>y.jsx(ga,{...n,children:n.options.map((e,t)=>y.jsx(co,{value:e.label,children:e.label},t))}),LD=new Map([["text",n=>y.jsx(er,{...n})],["email",n=>y.jsx(er,{...n})],["number",n=>y.jsx(er,{...n})],["textarea",n=>y.jsx(lo,{...n})],["checkbox",n=>y.jsx(F0,{...n})],["checkboxgroup",n=>y.jsx(ID,{...n})],["radio",n=>y.jsx(zD,{...n})],["select",n=>y.jsx(jD,{...n})],["file",n=>y.jsx(er,{...n})]]),BD=({field:n})=>{const e=LD.get(n.type);return e?y.jsxs(X.Root,{required:n.config?.required??!1,style:{width:"100%"},children:[n.type!=="checkbox"&&y.jsx(X.Label,{children:n.label}),y.jsx(e,{disabled:!0,style:{width:"100%"},...n})]}):null},FD=({...n})=>y.jsxs("svg",{fill:"currentColor",height:n.width??200,width:n.height??2e3,viewBox:"0 0 201.377 201.377",children:[y.jsx("g",{id:"SVGRepo_bgCarrier",strokeWidth:"0"}),y.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"}),y.jsxs("g",{id:"SVGRepo_iconCarrier",children:[y.jsx("path",{d:"M157.511,63.77l43.866,36.918l-43.865,36.92l0-24.421h-25.813v41.752h-25v-108.5h25v41.748h25.813L157.511,63.77z M43.866,113.19h25.813v41.748h25v-108.5h-25V88.19H43.866l0-24.421L0,100.689l43.866,36.918L43.866,113.19z"})," "]})]});function _D(n){switch(n){case 12:return"100%";case 8:return"66%";case 6:return"50%";case 4:return"33%";default:return n}}const WD=({handleEditField:n,block:e,field:t,index:r})=>{const{formatMessage:i}=Ct(),{currentLayouts:o,currentBreakpoint:s,resizeBlock:a,removeBlock:l,moveBlock:c}=ki(),u=d=>n(d),f=()=>y.jsxs(xw,{children:[y.jsx(zi,{label:"Previous",onClick:()=>c(e.i,"prev"),disabled:r===0,variant:"secondary",children:y.jsx(Sw,{})}),y.jsx(zi,{label:"Next",onClick:()=>c(e.i,"next"),disabled:r===o[s].length-1,variant:"secondary",children:y.jsx(Cw,{})})]});return y.jsx(ww,{background:"neutral100",hasRadius:!0,children:y.jsxs(vw,{alignItems:"flex-start",gap:4,children:[y.jsxs(ye,{gap:1,alignItems:"flex-start",direction:"column",style:{minWidth:"150px"},children:[y.jsx(zi,{label:"Resize",onClick:()=>u(e),variant:"secondary",disabled:!1,children:y.jsxs(ye,{gap:1,alignItems:"center",children:[y.jsx(Ns,{style:{width:"12px"}}),y.jsx(Me,{variant:"sigma",lineHeight:"16px",children:i({id:A(`forms.fields.types.${t.type}`)})})]})}),y.jsx(zi,{label:"Remove",onClick:()=>l(e.i),disabled:!1,variant:"danger-light",children:y.jsxs(ye,{gap:1,alignItems:"center",children:[y.jsx(cm,{style:{width:"12px"}}),y.jsx(Me,{variant:"sigma",lineHeight:"16px",children:i({id:A("actions.delete")})})]})})]}),y.jsx(ye,{gap:2,alignItems:"center",justifyContent:"space-between",style:{width:"100%"},children:y.jsx(BD,{field:t})}),y.jsxs(ye,{direction:"column",alignItems:"flex-end",gap:1,style:{marginLeft:"auto",minWidth:"64px"},children:[f(),y.jsx(zi,{label:"Resize",onClick:()=>a(e.i),variant:"secondary",disabled:!1,children:y.jsxs(ye,{gap:1,alignItems:"center",justifyContent:"space-between",style:{width:"100%"},children:[y.jsx(FD,{width:15,height:15}),y.jsx(Me,{variant:"sigma",lineHeight:"16px",children:_D(e.w)})]})})]})]})},e.i)};var _o=(n=>(n.Notification="notification",n.Confirmation="confirmation",n))(_o||{}),ri=(n=>(n.Text="text",n.Checkbox="checkbox",n.CheckboxGroup="checkboxgroup",n.Radio="radio",n.Textarea="textarea",n.Email="email",n.Number="number",n.Select="select",n.File="file",n))(ri||{}),ii=(n=>(n.Add="add",n.Edit="edit",n))(ii||{});const HD=({field:n,config:e,setConfig:t})=>{const{formatMessage:r}=Ct(),i=(o,s)=>{t({...e,validation:{...e.validation,[s]:o}})};return y.jsx(y.Fragment,{children:n===ri.File&&y.jsx(y.Fragment,{children:y.jsxs(ga,{value:e.validation?.allowedTypes,onChange:o=>i(o,"allowedTypes"),name:"allowedTypes",label:r({id:A("forms.fields.extra_props.file_exts")}),children:[y.jsx(co,{value:"images",children:"Image (JPG, PNG, GIF)"}),y.jsx(co,{value:"files",children:"File (PDF, CSV, EXCEL, DOCX)"})]})})})},VD=({field:n,config:e,setConfig:t,options:r,setOptions:i})=>{const[o,s]=v.useState(r),[a,l]=v.useState(e?.required),{formatMessage:c}=Ct(),u=d=>{l(d),t({...e,required:d})},f=d=>{s(d),i(d)};return y.jsxs(ye,{direction:"column",gap:3,style:{width:"100%"},alignItems:"flex-start",children:[n===ri.Select||n===ri.Radio||n===ri.CheckboxGroup?y.jsxs(y.Fragment,{children:[y.jsx(vt,{style:{width:"100%"},children:y.jsx(lo,{style:{width:"100%"},onChange:d=>f(d.currentTarget.value),label:c({id:A("forms.fields.extra_props.children")}),name:"children",placeholder:c({id:A("forms.fields.extra_props.children_placeholder")}),children:o})}),y.jsx(Is,{style:{width:"100%"}})]}):null,y.jsx(Me,{variant:"omega",fontWeight:"bold",children:c({id:A("forms.fields.extra_props.validation")})}),y.jsx(dm,{name:"isRequired",checked:a,onCheckedChange:d=>u(d),children:c({id:A("forms.fields.extra_props.required")})}),y.jsx(HD,{config:e,setConfig:t,field:n})]})},qD=n=>kw.camelCase(n.replace(/\s+/g,"")),GD=({action:n,isVisible:e,setIsVisible:t,currentField:r,setCurrentField:i})=>{const{state:o,dispatch:s}=ki(),{formatMessage:a}=Ct(),[l,c]=v.useState(!1),[u,f]=v.useState(a({id:A("required")})),[d,h]=v.useState(r?.label||""),[p,m]=v.useState(r?.placeholder||""),[g,b]=v.useState(r?.type||null),[x,w]=v.useState(r?.config||{}),[C,S]=v.useState(r?.options||[]),k=()=>d&&g,O=P=>{S(P.split(`
`).map(z=>({value:z,label:z})))},M=()=>{const P=o.steps.find(z=>z.id===o.currentStep)?.layouts.lg.flatMap(z=>z.field)||[];return!P.length&&!r?.label?!1:P.some(z=>z&&z.label!==r?.label&&z.label.toLowerCase()===d.toLowerCase())},R=()=>{if(c(!1),!k()||M()){f(a({id:A(M()?"exists":"required")})),c(!0);return}const P={label:d,placeholder:p,name:qD(d),type:g,config:x,options:C};if(n===ii.Add){const z={i:`field-${Date.now()}`,...P};s({type:"ADD_FIELD",payload:{currentStep:o.currentStep,field:z}})}else if(n===ii.Edit){const z={...r,...P};s({type:"EDIT_FIELD",payload:{currentStep:o.currentStep,blockId:r.blockId,field:z}})}T()},T=()=>{t(!1),i(null)};return y.jsx(Oe.Root,{open:e,onOpenChange:T,children:y.jsxs(Oe.Content,{children:[y.jsx(Oe.Header,{children:y.jsx(Oe.Title,{children:a({id:n===ii.Add?A("forms.fields.add"):A("forms.fields.edit")})})}),y.jsx(Oe.Body,{children:y.jsxs(ye,{direction:"column",gap:4,alignItems:"stretch",width:"100%",children:[y.jsxs(X.Root,{name:"type",id:"type",error:l?u:"",children:[y.jsx(X.Label,{children:a({id:A("forms.fields.type")})}),y.jsx(ga,{value:g,onChange:P=>b(P),placeholder:a({id:A("forms.fields.type.placeholder")}),children:Object.keys(ri).map(P=>y.jsx(co,{value:P.toLowerCase(),children:a({id:A(`forms.fields.types.${P.toLowerCase()}`)})},P))}),y.jsx(X.Error,{})]}),y.jsxs(X.Root,{name:"label",id:"label",error:l?u:"",children:[y.jsx(X.Label,{children:a({id:A("forms.fields.label")})}),y.jsx(X.Input,{id:"field-label",value:d,onChange:P=>h(P.target.value)}),y.jsx(X.Error,{})]}),y.jsxs(X.Root,{name:"placeholder",id:"placeholder",children:[y.jsx(X.Label,{children:a({id:A("forms.fields.placeholder")})}),y.jsx(X.Input,{id:"field-placeholder",name:"placeholder",value:p,onChange:P=>m(P.target.value)})]}),g&&y.jsxs(y.Fragment,{children:[y.jsx(Is,{}),y.jsx(VD,{field:g,config:x,setConfig:w,options:C.map(P=>P.value).join(`
`),setOptions:O})]})]})}),y.jsxs(Oe.Footer,{children:[y.jsx(Oe.Close,{children:y.jsx(he,{variant:"tertiary",children:a({id:A("cancel")})})}),y.jsx(he,{onClick:R,children:a({id:A("save")})})]})]})})},JD=({...n})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n.width??48,height:n.height??48,viewBox:"0 -960 960 960",children:y.jsx("path",{fill:"currentColor",d:"M336-120v-35l84-85H140q-24 0-42-18t-18-42v-480q0-24 18-42t42-18h680q24 0 42 18t18 42v480q0 24-18 42t-42 18H540l84 85v35H336ZM140-396h680v-384H140v384Zm0 0v-384 384Z"})}),ap=({...n})=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:n.width??48,height:n.height??48,viewBox:"0 -960 960 960",style:n.style,children:y.jsx("path",{fill:"currentColor",d:"M100-160q-24.75 0-42.37-17.63Q40-195.25 40-220v-520q0-24.75 17.63-42.38Q75.25-800 100-800h760q24.75 0 42.38 17.62Q920-764.75 920-740v520q0 24.75-17.62 42.37Q884.75-160 860-160H100Zm30-580h-30v520h30v-520Zm60 520h580v-520H190v520Zm640-520v520h30v-520h-30Zm0 0h30-30Zm-700 0h-30 30Z"})}),UD=8,KD=()=>{const{currentLayouts:n,currentBreakpoint:e,setCurrentBreakpoint:t}=ki(),[r,i]=v.useState(!1),[o,s]=v.useState(null),[a,l]=v.useState(1200),c=v.useRef(null);v.useEffect(()=>{const h=()=>{c.current&&l(c.current.offsetWidth)},p=new ResizeObserver(()=>h());return c.current&&p.observe(c.current),window.addEventListener("resize",h),h(),()=>{p.disconnect(),window.removeEventListener("resize",h)}},[]);const u=()=>{s(null),i(!0)},f=h=>{const p=h.field?{...h.field,blockId:h.i}:{};s(p),i(!0)},d=h=>{t(h)};return v.useEffect(()=>{(()=>{const p={},m={},g={};n[e].forEach(x=>{const w=document.getElementById(`card-${x.i}`);w&&(w.style.height="auto",w.style.transform="none",p[x.y]||(p[x.y]=[]),p[x.y].push(w))}),Object.keys(p).forEach(x=>{const w=parseInt(x,10);m[w]=Math.max(...p[w].map(C=>C.offsetHeight))});let b=0;Object.keys(m).sort((x,w)=>parseInt(x,10)-parseInt(w,10)).forEach(x=>{const w=parseInt(x,10);g[w]=b,b+=m[w]+UD}),n[e].map(x=>{const w=document.getElementById(`card-${x.i}`);if(!w)return x;const C=x.y,S=m[C]||0,k=g[C]||0,O=x.x*(a/12);return w.style.height=`${S}px`,w.style.transform=`translate(${O}px, ${k}px)`,{...x,h:Math.ceil(S/S)}})})()},[n,e,a]),y.jsxs(y.Fragment,{children:[y.jsx(vt,{background:"white",padding:4,hasRadius:!0,marginBottom:4,shadow:"filterShadow",children:y.jsxs(ye,{direction:"row",gap:3,style:{width:"100%"},alignItems:"flex-start",children:[y.jsx(he,{onClick:u,startIcon:y.jsx(lc,{}),children:"Add Field"}),y.jsx(he,{variant:e==="lg"?"primary":"secondary",onClick:()=>d("lg"),style:{paddingTop:"4px"},children:y.jsx(JD,{width:20,height:20})}),y.jsx(he,{variant:e==="md"?"primary":"secondary",onClick:()=>d("md"),style:{paddingTop:"4px"},children:y.jsx(ap,{width:20,height:20})}),y.jsx(he,{variant:e==="sm"?"primary":"secondary",onClick:()=>d("sm"),style:{paddingTop:"4px"},children:y.jsx(ap,{width:20,height:20,style:{rotate:"90deg"}})})]})}),y.jsx(vt,{background:"white",padding:4,hasRadius:!0,shadow:"filterShadow",children:y.jsx("div",{id:"grid-container",ref:c,children:y.jsx(Kx,{className:"layout",layout:n[e],width:a,compactType:null,preventCollision:!0,isResizable:!1,isDraggable:!1,containerPadding:[0,0],children:n[e].map((h,p)=>{const m=h.field??{};return y.jsx("div",{className:"grid-item",id:`card-${h.i}`,children:y.jsx(WD,{handleEditField:f,block:h,field:m,index:p})},h.i)})})})}),r&&y.jsx(GD,{action:o?ii.Edit:ii.Add,isVisible:r,setIsVisible:i,currentField:o,setCurrentField:s})]})},_0=({variant:n,message:e,toggleAlert:t})=>{const{formatMessage:r}=Ct();return y.jsx(vt,{style:{position:"absolute",top:0,right:0,zIndex:9999,left:0},children:y.jsx(fm,{onClose:()=>t(!1),title:r({id:A(`alert.${n}`)}),variant:n,children:e??r({id:A(`alert.description.${n}`)})})})};_0.defaultProps={variant:"success"};const lt=async(n,e,t,r,i,o)=>{const s=`${o?"/":"/api/"}`;try{return fetch(`${s}${wt}/${n}${r?`?${new URLSearchParams({...r})}`:""}`,{method:t,mode:"cors",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:i&&JSON.stringify({data:i})})}catch(a){throw console.error(a),new Error}};var lp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function YD(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var Ri=TypeError;const XD={},QD=Object.freeze(Object.defineProperty({__proto__:null,default:XD},Symbol.toStringTag,{value:"Module"})),ZD=YD(QD);var Rf=typeof Map=="function"&&Map.prototype,Il=Object.getOwnPropertyDescriptor&&Rf?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,ra=Rf&&Il&&typeof Il.get=="function"?Il.get:null,cp=Rf&&Map.prototype.forEach,Af=typeof Set=="function"&&Set.prototype,zl=Object.getOwnPropertyDescriptor&&Af?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ia=Af&&zl&&typeof zl.get=="function"?zl.get:null,up=Af&&Set.prototype.forEach,e$=typeof WeakMap=="function"&&WeakMap.prototype,no=e$?WeakMap.prototype.has:null,t$=typeof WeakSet=="function"&&WeakSet.prototype,ro=t$?WeakSet.prototype.has:null,n$=typeof WeakRef=="function"&&WeakRef.prototype,fp=n$?WeakRef.prototype.deref:null,r$=Boolean.prototype.valueOf,i$=Object.prototype.toString,o$=Function.prototype.toString,s$=String.prototype.match,Df=String.prototype.slice,An=String.prototype.replace,a$=String.prototype.toUpperCase,dp=String.prototype.toLowerCase,W0=RegExp.prototype.test,hp=Array.prototype.concat,Ut=Array.prototype.join,l$=Array.prototype.slice,pp=Math.floor,lu=typeof BigInt=="function"?BigInt.prototype.valueOf:null,jl=Object.getOwnPropertySymbols,cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,yi=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ue=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===yi||!0)?Symbol.toStringTag:null,H0=Object.prototype.propertyIsEnumerable,mp=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function gp(n,e){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||W0.call(/e/,e))return e;var t=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var r=n<0?-pp(-n):pp(n);if(r!==n){var i=String(r),o=Df.call(e,i.length+1);return An.call(i,t,"$&_")+"."+An.call(An.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return An.call(e,t,"$&_")}var uu=ZD,yp=uu.custom,bp=G0(yp)?yp:null,V0={__proto__:null,double:'"',single:"'"},c$={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},Ka=function n(e,t,r,i){var o=t||{};if(cn(o,"quoteStyle")&&!cn(V0,o.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(cn(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var s=cn(o,"customInspect")?o.customInspect:!0;if(typeof s!="boolean"&&s!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(cn(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(cn(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=o.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return U0(e,o);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?gp(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return a?gp(e,c):c}var u=typeof o.depth>"u"?5:o.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof e=="object")return fu(e)?"[Array]":"[Object]";var f=E$(o,r);if(typeof i>"u")i=[];else if(J0(i,e)>=0)return"[Circular]";function d(U,H,Se){if(H&&(i=l$.call(i),i.push(H)),Se){var J={depth:o.depth};return cn(o,"quoteStyle")&&(J.quoteStyle=o.quoteStyle),n(U,J,r+1,i)}return n(U,o,r+1,i)}if(typeof e=="function"&&!wp(e)){var h=b$(e),p=ds(e,d);return"[Function"+(h?": "+h:" (anonymous)")+"]"+(p.length>0?" { "+Ut.call(p,", ")+" }":"")}if(G0(e)){var m=yi?An.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):cu.call(e);return typeof e=="object"&&!yi?ji(m):m}if(k$(e)){for(var g="<"+dp.call(String(e.nodeName)),b=e.attributes||[],x=0;x<b.length;x++)g+=" "+b[x].name+"="+q0(u$(b[x].value),"double",o);return g+=">",e.childNodes&&e.childNodes.length&&(g+="..."),g+="</"+dp.call(String(e.nodeName))+">",g}if(fu(e)){if(e.length===0)return"[]";var w=ds(e,d);return f&&!M$(w)?"["+du(w,f)+"]":"[ "+Ut.call(w,", ")+" ]"}if(d$(e)){var C=ds(e,d);return!("cause"in Error.prototype)&&"cause"in e&&!H0.call(e,"cause")?"{ ["+String(e)+"] "+Ut.call(hp.call("[cause]: "+d(e.cause),C),", ")+" }":C.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+Ut.call(C,", ")+" }"}if(typeof e=="object"&&s){if(bp&&typeof e[bp]=="function"&&uu)return uu(e,{depth:u-r});if(s!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(w$(e)){var S=[];return cp&&cp.call(e,function(U,H){S.push(d(H,e,!0)+" => "+d(U,e))}),vp("Map",ra.call(e),S,f)}if(S$(e)){var k=[];return up&&up.call(e,function(U){k.push(d(U,e))}),vp("Set",ia.call(e),k,f)}if(v$(e))return Ll("WeakMap");if(C$(e))return Ll("WeakSet");if(x$(e))return Ll("WeakRef");if(p$(e))return ji(d(Number(e)));if(g$(e))return ji(d(lu.call(e)));if(m$(e))return ji(r$.call(e));if(h$(e))return ji(d(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(typeof globalThis<"u"&&e===globalThis||typeof lp<"u"&&e===lp)return"{ [object globalThis] }";if(!f$(e)&&!wp(e)){var O=ds(e,d),M=mp?mp(e)===Object.prototype:e instanceof Object||e.constructor===Object,R=e instanceof Object?"":"null prototype",T=!M&&Ue&&Object(e)===e&&Ue in e?Df.call(Vn(e),8,-1):R?"Object":"",P=M||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",z=P+(T||R?"["+Ut.call(hp.call([],T||[],R||[]),": ")+"] ":"");return O.length===0?z+"{}":f?z+"{"+du(O,f)+"}":z+"{ "+Ut.call(O,", ")+" }"}return String(e)};function q0(n,e,t){var r=t.quoteStyle||e,i=V0[r];return i+n+i}function u$(n){return An.call(String(n),/"/g,"&quot;")}function fu(n){return Vn(n)==="[object Array]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function f$(n){return Vn(n)==="[object Date]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function wp(n){return Vn(n)==="[object RegExp]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function d$(n){return Vn(n)==="[object Error]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function h$(n){return Vn(n)==="[object String]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function p$(n){return Vn(n)==="[object Number]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function m$(n){return Vn(n)==="[object Boolean]"&&(!Ue||!(typeof n=="object"&&Ue in n))}function G0(n){if(yi)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!cu)return!1;try{return cu.call(n),!0}catch{}return!1}function g$(n){if(!n||typeof n!="object"||!lu)return!1;try{return lu.call(n),!0}catch{}return!1}var y$=Object.prototype.hasOwnProperty||function(n){return n in this};function cn(n,e){return y$.call(n,e)}function Vn(n){return i$.call(n)}function b$(n){if(n.name)return n.name;var e=s$.call(o$.call(n),/^function\s*([\w$]+)/);return e?e[1]:null}function J0(n,e){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t;return-1}function w$(n){if(!ra||!n||typeof n!="object")return!1;try{ra.call(n);try{ia.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function v$(n){if(!no||!n||typeof n!="object")return!1;try{no.call(n,no);try{ro.call(n,ro)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function x$(n){if(!fp||!n||typeof n!="object")return!1;try{return fp.call(n),!0}catch{}return!1}function S$(n){if(!ia||!n||typeof n!="object")return!1;try{ia.call(n);try{ra.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function C$(n){if(!ro||!n||typeof n!="object")return!1;try{ro.call(n,ro);try{no.call(n,no)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function k$(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function U0(n,e){if(n.length>e.maxStringLength){var t=n.length-e.maxStringLength,r="... "+t+" more character"+(t>1?"s":"");return U0(Df.call(n,0,e.maxStringLength),e)+r}var i=c$[e.quoteStyle||"single"];i.lastIndex=0;var o=An.call(An.call(n,i,"\\$1"),/[\x00-\x1f]/g,O$);return q0(o,"single",e)}function O$(n){var e=n.charCodeAt(0),t={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return t?"\\"+t:"\\x"+(e<16?"0":"")+a$.call(e.toString(16))}function ji(n){return"Object("+n+")"}function Ll(n){return n+" { ? }"}function vp(n,e,t,r){var i=r?du(t,r):Ut.call(t,", ");return n+" ("+e+") {"+i+"}"}function M$(n){for(var e=0;e<n.length;e++)if(J0(n[e],`
`)>=0)return!1;return!0}function E$(n,e){var t;if(n.indent==="	")t="	";else if(typeof n.indent=="number"&&n.indent>0)t=Ut.call(Array(n.indent+1)," ");else return null;return{base:t,prev:Ut.call(Array(e+1),t)}}function du(n,e){if(n.length===0)return"";var t=`
`+e.prev+e.base;return t+Ut.call(n,","+t)+`
`+e.prev}function ds(n,e){var t=fu(n),r=[];if(t){r.length=n.length;for(var i=0;i<n.length;i++)r[i]=cn(n,i)?e(n[i],n):""}var o=typeof jl=="function"?jl(n):[],s;if(yi){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var l in n)cn(n,l)&&(t&&String(Number(l))===l&&l<n.length||yi&&s["$"+l]instanceof Symbol||(W0.call(/[^\w$]/,l)?r.push(e(l,n)+": "+e(n[l],n)):r.push(l+": "+e(n[l],n))));if(typeof jl=="function")for(var c=0;c<o.length;c++)H0.call(n,o[c])&&r.push("["+e(o[c])+"]: "+e(n[o[c]],n));return r}var T$=Ka,R$=Ri,Ya=function(n,e,t){for(var r=n,i;(i=r.next)!=null;r=i)if(i.key===e)return r.next=i.next,t||(i.next=n.next,n.next=i),i},A$=function(n,e){if(n){var t=Ya(n,e);return t&&t.value}},D$=function(n,e,t){var r=Ya(n,e);r?r.value=t:n.next={key:e,next:n.next,value:t}},$$=function(n,e){return n?!!Ya(n,e):!1},P$=function(n,e){if(n)return Ya(n,e,!0)},N$=function(){var e,t={assert:function(r){if(!t.has(r))throw new R$("Side channel does not contain "+T$(r))},delete:function(r){var i=e&&e.next,o=P$(e,r);return o&&i&&i===o&&(e=void 0),!!o},get:function(r){return A$(e,r)},has:function(r){return $$(e,r)},set:function(r,i){e||(e={next:void 0}),D$(e,r,i)}};return t},K0=Object,I$=Error,z$=EvalError,j$=RangeError,L$=ReferenceError,B$=SyntaxError,F$=URIError,_$=Math.abs,W$=Math.floor,H$=Math.max,V$=Math.min,q$=Math.pow,G$=Math.round,J$=Number.isNaN||function(e){return e!==e},U$=J$,K$=function(e){return U$(e)||e===0?e:e<0?-1:1},Y$=Object.getOwnPropertyDescriptor,Rs=Y$;if(Rs)try{Rs([],"length")}catch{Rs=null}var Y0=Rs,As=Object.defineProperty||!1;if(As)try{As({},"a",{value:1})}catch{As=!1}var X$=As,Bl,xp;function Q$(){return xp||(xp=1,Bl=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var o in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==i||a.enumerable!==!0)return!1}return!0}),Bl}var Fl,Sp;function Z$(){if(Sp)return Fl;Sp=1;var n=typeof Symbol<"u"&&Symbol,e=Q$();return Fl=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Fl}var _l,Cp;function X0(){return Cp||(Cp=1,_l=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),_l}var Wl,kp;function Q0(){if(kp)return Wl;kp=1;var n=K0;return Wl=n.getPrototypeOf||null,Wl}var eP="Function.prototype.bind called on incompatible ",tP=Object.prototype.toString,nP=Math.max,rP="[object Function]",Op=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var o=0;o<t.length;o+=1)r[o+e.length]=t[o];return r},iP=function(e,t){for(var r=[],i=t,o=0;i<e.length;i+=1,o+=1)r[o]=e[i];return r},oP=function(n,e){for(var t="",r=0;r<n.length;r+=1)t+=n[r],r+1<n.length&&(t+=e);return t},sP=function(e){var t=this;if(typeof t!="function"||tP.apply(t)!==rP)throw new TypeError(eP+t);for(var r=iP(arguments,1),i,o=function(){if(this instanceof i){var u=t.apply(this,Op(r,arguments));return Object(u)===u?u:this}return t.apply(e,Op(r,arguments))},s=nP(0,t.length-r.length),a=[],l=0;l<s;l++)a[l]="$"+l;if(i=Function("binder","return function ("+oP(a,",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var c=function(){};c.prototype=t.prototype,i.prototype=new c,c.prototype=null}return i},aP=sP,Xa=Function.prototype.bind||aP,$f=Function.prototype.call,Hl,Mp;function Z0(){return Mp||(Mp=1,Hl=Function.prototype.apply),Hl}var lP=typeof Reflect<"u"&&Reflect&&Reflect.apply,cP=Xa,uP=Z0(),fP=$f,dP=lP,hP=dP||cP.call(fP,uP),pP=Xa,mP=Ri,gP=$f,yP=hP,eb=function(e){if(e.length<1||typeof e[0]!="function")throw new mP("a function is required");return yP(pP,gP,e)},Vl,Ep;function bP(){if(Ep)return Vl;Ep=1;var n=eb,e=Y0,t;try{t=[].__proto__===Array.prototype}catch(s){if(!s||typeof s!="object"||!("code"in s)||s.code!=="ERR_PROTO_ACCESS")throw s}var r=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,o=i.getPrototypeOf;return Vl=r&&typeof r.get=="function"?n([r.get]):typeof o=="function"?function(a){return o(a==null?a:i(a))}:!1,Vl}var ql,Tp;function wP(){if(Tp)return ql;Tp=1;var n=X0(),e=Q0(),t=bP();return ql=n?function(i){return n(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,ql}var Gl,Rp;function vP(){if(Rp)return Gl;Rp=1;var n=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Xa;return Gl=t.call(n,e),Gl}var Y,xP=K0,SP=I$,CP=z$,kP=j$,OP=L$,bi=B$,oi=Ri,MP=F$,EP=_$,TP=W$,RP=H$,AP=V$,DP=q$,$P=G$,PP=K$,tb=Function,Jl=function(n){try{return tb('"use strict"; return ('+n+").constructor;")()}catch{}},Oo=Y0,NP=X$,Ul=function(){throw new oi},IP=Oo?function(){try{return arguments.callee,Ul}catch{try{return Oo(arguments,"callee").get}catch{return Ul}}}():Ul,Wr=Z$()(),Pe=wP(),zP=Q0(),jP=X0(),nb=Z0(),Wo=$f,Ur={},LP=typeof Uint8Array>"u"||!Pe?Y:Pe(Uint8Array),gr={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Y:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Y:ArrayBuffer,"%ArrayIteratorPrototype%":Wr&&Pe?Pe([][Symbol.iterator]()):Y,"%AsyncFromSyncIteratorPrototype%":Y,"%AsyncFunction%":Ur,"%AsyncGenerator%":Ur,"%AsyncGeneratorFunction%":Ur,"%AsyncIteratorPrototype%":Ur,"%Atomics%":typeof Atomics>"u"?Y:Atomics,"%BigInt%":typeof BigInt>"u"?Y:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Y:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Y:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Y:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":SP,"%eval%":eval,"%EvalError%":CP,"%Float32Array%":typeof Float32Array>"u"?Y:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Y:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Y:FinalizationRegistry,"%Function%":tb,"%GeneratorFunction%":Ur,"%Int8Array%":typeof Int8Array>"u"?Y:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Y:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Y:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Wr&&Pe?Pe(Pe([][Symbol.iterator]())):Y,"%JSON%":typeof JSON=="object"?JSON:Y,"%Map%":typeof Map>"u"?Y:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Wr||!Pe?Y:Pe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":xP,"%Object.getOwnPropertyDescriptor%":Oo,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Y:Promise,"%Proxy%":typeof Proxy>"u"?Y:Proxy,"%RangeError%":kP,"%ReferenceError%":OP,"%Reflect%":typeof Reflect>"u"?Y:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Y:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Wr||!Pe?Y:Pe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Y:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Wr&&Pe?Pe(""[Symbol.iterator]()):Y,"%Symbol%":Wr?Symbol:Y,"%SyntaxError%":bi,"%ThrowTypeError%":IP,"%TypedArray%":LP,"%TypeError%":oi,"%Uint8Array%":typeof Uint8Array>"u"?Y:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Y:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Y:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Y:Uint32Array,"%URIError%":MP,"%WeakMap%":typeof WeakMap>"u"?Y:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Y:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Y:WeakSet,"%Function.prototype.call%":Wo,"%Function.prototype.apply%":nb,"%Object.defineProperty%":NP,"%Object.getPrototypeOf%":zP,"%Math.abs%":EP,"%Math.floor%":TP,"%Math.max%":RP,"%Math.min%":AP,"%Math.pow%":DP,"%Math.round%":$P,"%Math.sign%":PP,"%Reflect.getPrototypeOf%":jP};if(Pe)try{null.error}catch(n){var BP=Pe(Pe(n));gr["%Error.prototype%"]=BP}var FP=function n(e){var t;if(e==="%AsyncFunction%")t=Jl("async function () {}");else if(e==="%GeneratorFunction%")t=Jl("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=Jl("async function* () {}");else if(e==="%AsyncGenerator%"){var r=n("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=n("%AsyncGenerator%");i&&Pe&&(t=Pe(i.prototype))}return gr[e]=t,t},Ap={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ho=Xa,oa=vP(),_P=Ho.call(Wo,Array.prototype.concat),WP=Ho.call(nb,Array.prototype.splice),Dp=Ho.call(Wo,String.prototype.replace),sa=Ho.call(Wo,String.prototype.slice),HP=Ho.call(Wo,RegExp.prototype.exec),VP=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,qP=/\\(\\)?/g,GP=function(e){var t=sa(e,0,1),r=sa(e,-1);if(t==="%"&&r!=="%")throw new bi("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&t!=="%")throw new bi("invalid intrinsic syntax, expected opening `%`");var i=[];return Dp(e,VP,function(o,s,a,l){i[i.length]=a?Dp(l,qP,"$1"):s||o}),i},JP=function(e,t){var r=e,i;if(oa(Ap,r)&&(i=Ap[r],r="%"+i[0]+"%"),oa(gr,r)){var o=gr[r];if(o===Ur&&(o=FP(r)),typeof o>"u"&&!t)throw new oi("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:o}}throw new bi("intrinsic "+e+" does not exist!")},Pf=function(e,t){if(typeof e!="string"||e.length===0)throw new oi("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new oi('"allowMissing" argument must be a boolean');if(HP(/^%?[^%]*%?$/,e)===null)throw new bi("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=GP(e),i=r.length>0?r[0]:"",o=JP("%"+i+"%",t),s=o.name,a=o.value,l=!1,c=o.alias;c&&(i=c[0],WP(r,_P([0,1],c)));for(var u=1,f=!0;u<r.length;u+=1){var d=r[u],h=sa(d,0,1),p=sa(d,-1);if((h==='"'||h==="'"||h==="`"||p==='"'||p==="'"||p==="`")&&h!==p)throw new bi("property names with quotes must have matching quotes");if((d==="constructor"||!f)&&(l=!0),i+="."+d,s="%"+i+"%",oa(gr,s))a=gr[s];else if(a!=null){if(!(d in a)){if(!t)throw new oi("base intrinsic for "+e+" exists, but the property is not available.");return}if(Oo&&u+1>=r.length){var m=Oo(a,d);f=!!m,f&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else f=oa(a,d),a=a[d];f&&!l&&(gr[s]=a)}}return a},rb=Pf,ib=eb,UP=ib([rb("%String.prototype.indexOf%")]),ob=function(e,t){var r=rb(e,!!t);return typeof r=="function"&&UP(e,".prototype.")>-1?ib([r]):r},KP=Pf,Vo=ob,YP=Ka,XP=Ri,$p=KP("%Map%",!0),QP=Vo("Map.prototype.get",!0),ZP=Vo("Map.prototype.set",!0),eN=Vo("Map.prototype.has",!0),tN=Vo("Map.prototype.delete",!0),nN=Vo("Map.prototype.size",!0),sb=!!$p&&function(){var e,t={assert:function(r){if(!t.has(r))throw new XP("Side channel does not contain "+YP(r))},delete:function(r){if(e){var i=tN(e,r);return nN(e)===0&&(e=void 0),i}return!1},get:function(r){if(e)return QP(e,r)},has:function(r){return e?eN(e,r):!1},set:function(r,i){e||(e=new $p),ZP(e,r,i)}};return t},rN=Pf,Qa=ob,iN=Ka,hs=sb,oN=Ri,Hr=rN("%WeakMap%",!0),sN=Qa("WeakMap.prototype.get",!0),aN=Qa("WeakMap.prototype.set",!0),lN=Qa("WeakMap.prototype.has",!0),cN=Qa("WeakMap.prototype.delete",!0),uN=Hr?function(){var e,t,r={assert:function(i){if(!r.has(i))throw new oN("Side channel does not contain "+iN(i))},delete:function(i){if(Hr&&i&&(typeof i=="object"||typeof i=="function")){if(e)return cN(e,i)}else if(hs&&t)return t.delete(i);return!1},get:function(i){return Hr&&i&&(typeof i=="object"||typeof i=="function")&&e?sN(e,i):t&&t.get(i)},has:function(i){return Hr&&i&&(typeof i=="object"||typeof i=="function")&&e?lN(e,i):!!t&&t.has(i)},set:function(i,o){Hr&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new Hr),aN(e,i,o)):hs&&(t||(t=hs()),t.set(i,o))}};return r}:hs,fN=Ri,dN=Ka,hN=N$,pN=sb,mN=uN,gN=mN||pN||hN,yN=function(){var e,t={assert:function(r){if(!t.has(r))throw new fN("Side channel does not contain "+dN(r))},delete:function(r){return!!e&&e.delete(r)},get:function(r){return e&&e.get(r)},has:function(r){return!!e&&e.has(r)},set:function(r,i){e||(e=gN()),e.set(r,i)}};return t},bN=String.prototype.replace,wN=/%20/g,Kl={RFC1738:"RFC1738",RFC3986:"RFC3986"},Nf={default:Kl.RFC3986,formatters:{RFC1738:function(n){return bN.call(n,wN,"+")},RFC3986:function(n){return String(n)}},RFC1738:Kl.RFC1738,RFC3986:Kl.RFC3986},vN=Nf,Yl=Object.prototype.hasOwnProperty,Zn=Array.isArray,qt=function(){for(var n=[],e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n}(),xN=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(Zn(r)){for(var i=[],o=0;o<r.length;++o)typeof r[o]<"u"&&i.push(r[o]);t.obj[t.prop]=i}}},ab=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(r[i]=e[i]);return r},SN=function n(e,t,r){if(!t)return e;if(typeof t!="object"){if(Zn(e))e.push(t);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Yl.call(Object.prototype,t))&&(e[t]=!0);else return[e,t];return e}if(!e||typeof e!="object")return[e].concat(t);var i=e;return Zn(e)&&!Zn(t)&&(i=ab(e,r)),Zn(e)&&Zn(t)?(t.forEach(function(o,s){if(Yl.call(e,s)){var a=e[s];a&&typeof a=="object"&&o&&typeof o=="object"?e[s]=n(a,o,r):e.push(o)}else e[s]=o}),e):Object.keys(t).reduce(function(o,s){var a=t[s];return Yl.call(o,s)?o[s]=n(o[s],a,r):o[s]=a,o},i)},CN=function(e,t){return Object.keys(t).reduce(function(r,i){return r[i]=t[i],r},e)},kN=function(n,e,t){var r=n.replace(/\+/g," ");if(t==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},ON=function(e,t,r,i,o){if(e.length===0)return e;var s=e;if(typeof e=="symbol"?s=Symbol.prototype.toString.call(e):typeof e!="string"&&(s=String(e)),r==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});for(var a="",l=0;l<s.length;++l){var c=s.charCodeAt(l);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||o===vN.RFC1738&&(c===40||c===41)){a+=s.charAt(l);continue}if(c<128){a=a+qt[c];continue}if(c<2048){a=a+(qt[192|c>>6]+qt[128|c&63]);continue}if(c<55296||c>=57344){a=a+(qt[224|c>>12]+qt[128|c>>6&63]+qt[128|c&63]);continue}l+=1,c=65536+((c&1023)<<10|s.charCodeAt(l)&1023),a+=qt[240|c>>18]+qt[128|c>>12&63]+qt[128|c>>6&63]+qt[128|c&63]}return a},MN=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var o=t[i],s=o.obj[o.prop],a=Object.keys(s),l=0;l<a.length;++l){var c=a[l],u=s[c];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(t.push({obj:s,prop:c}),r.push(u))}return xN(t),e},EN=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},TN=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},RN=function(e,t){return[].concat(e,t)},AN=function(e,t){if(Zn(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)},lb={arrayToObject:ab,assign:CN,combine:RN,compact:MN,decode:kN,encode:ON,isBuffer:TN,isRegExp:EN,maybeMap:AN,merge:SN},cb=yN,Ds=lb,io=Nf,DN=Object.prototype.hasOwnProperty,Pp={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},fn=Array.isArray,$N=Array.prototype.push,ub=function(n,e){$N.apply(n,fn(e)?e:[e])},PN=Date.prototype.toISOString,Np=io.default,He={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Ds.encode,encodeValuesOnly:!1,format:Np,formatter:io.formatters[Np],indices:!1,serializeDate:function(e){return PN.call(e)},skipNulls:!1,strictNullHandling:!1},NN=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Xl={},IN=function n(e,t,r,i,o,s,a,l,c,u,f,d,h,p,m,g){for(var b=e,x=g,w=0,C=!1;(x=x.get(Xl))!==void 0&&!C;){var S=x.get(e);if(w+=1,typeof S<"u"){if(S===w)throw new RangeError("Cyclic object value");C=!0}typeof x.get(Xl)>"u"&&(w=0)}if(typeof l=="function"?b=l(t,b):b instanceof Date?b=f(b):r==="comma"&&fn(b)&&(b=Ds.maybeMap(b,function(J){return J instanceof Date?f(J):J})),b===null){if(o)return a&&!p?a(t,He.encoder,m,"key",d):t;b=""}if(NN(b)||Ds.isBuffer(b)){if(a){var k=p?t:a(t,He.encoder,m,"key",d);return[h(k)+"="+h(a(b,He.encoder,m,"value",d))]}return[h(t)+"="+h(String(b))]}var O=[];if(typeof b>"u")return O;var M;if(r==="comma"&&fn(b))p&&a&&(b=Ds.maybeMap(b,a)),M=[{value:b.length>0?b.join(",")||null:void 0}];else if(fn(l))M=l;else{var R=Object.keys(b);M=c?R.sort(c):R}for(var T=i&&fn(b)&&b.length===1?t+"[]":t,P=0;P<M.length;++P){var z=M[P],U=typeof z=="object"&&typeof z.value<"u"?z.value:b[z];if(!(s&&U===null)){var H=fn(b)?typeof r=="function"?r(T,z):T:T+(u?"."+z:"["+z+"]");g.set(e,w);var Se=cb();Se.set(Xl,g),ub(O,n(U,H,r,i,o,s,r==="comma"&&p&&fn(b)?null:a,l,c,u,f,d,h,p,m,Se))}}return O},zN=function(e){if(!e)return He;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var t=e.charset||He.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=io.default;if(typeof e.format<"u"){if(!DN.call(io.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=io.formatters[r],o=He.filter;return(typeof e.filter=="function"||fn(e.filter))&&(o=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:He.addQueryPrefix,allowDots:typeof e.allowDots>"u"?He.allowDots:!!e.allowDots,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:He.charsetSentinel,delimiter:typeof e.delimiter>"u"?He.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:He.encode,encoder:typeof e.encoder=="function"?e.encoder:He.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:He.encodeValuesOnly,filter:o,format:r,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:He.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:He.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:He.strictNullHandling}},jN=function(n,e){var t=n,r=zN(e),i,o;typeof r.filter=="function"?(o=r.filter,t=o("",t)):fn(r.filter)&&(o=r.filter,i=o);var s=[];if(typeof t!="object"||t===null)return"";var a;e&&e.arrayFormat in Pp?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=Pp[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=l==="comma"&&e&&e.commaRoundTrip;i||(i=Object.keys(t)),r.sort&&i.sort(r.sort);for(var u=cb(),f=0;f<i.length;++f){var d=i[f];r.skipNulls&&t[d]===null||ub(s,IN(t[d],d,l,c,r.strictNullHandling,r.skipNulls,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}var h=s.join(r.delimiter),p=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),h.length>0?p+h:""},wi=lb,hu=Object.prototype.hasOwnProperty,LN=Array.isArray,$e={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:wi.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},BN=function(n){return n.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},fb=function(n,e){return n&&typeof n=="string"&&e.comma&&n.indexOf(",")>-1?n.split(","):n},FN="utf8=%26%2310003%3B",_N="utf8=%E2%9C%93",WN=function(e,t){var r={},i=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,o=t.parameterLimit===1/0?void 0:t.parameterLimit,s=i.split(t.delimiter,o),a=-1,l,c=t.charset;if(t.charsetSentinel)for(l=0;l<s.length;++l)s[l].indexOf("utf8=")===0&&(s[l]===_N?c="utf-8":s[l]===FN&&(c="iso-8859-1"),a=l,l=s.length);for(l=0;l<s.length;++l)if(l!==a){var u=s[l],f=u.indexOf("]="),d=f===-1?u.indexOf("="):f+1,h,p;d===-1?(h=t.decoder(u,$e.decoder,c,"key"),p=t.strictNullHandling?null:""):(h=t.decoder(u.slice(0,d),$e.decoder,c,"key"),p=wi.maybeMap(fb(u.slice(d+1),t),function(m){return t.decoder(m,$e.decoder,c,"value")})),p&&t.interpretNumericEntities&&c==="iso-8859-1"&&(p=BN(p)),u.indexOf("[]=")>-1&&(p=LN(p)?[p]:p),hu.call(r,h)?r[h]=wi.combine(r[h],p):r[h]=p}return r},HN=function(n,e,t,r){for(var i=r?e:fb(e,t),o=n.length-1;o>=0;--o){var s,a=n[o];if(a==="[]"&&t.parseArrays)s=[].concat(i);else{s=t.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,c=parseInt(l,10);!t.parseArrays&&l===""?s={0:i}:!isNaN(c)&&a!==l&&String(c)===l&&c>=0&&t.parseArrays&&c<=t.arrayLimit?(s=[],s[c]=i):l!=="__proto__"&&(s[l]=i)}i=s}return i},VN=function(e,t,r,i){if(e){var o=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,s=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=r.depth>0&&s.exec(o),c=l?o.slice(0,l.index):o,u=[];if(c){if(!r.plainObjects&&hu.call(Object.prototype,c)&&!r.allowPrototypes)return;u.push(c)}for(var f=0;r.depth>0&&(l=a.exec(o))!==null&&f<r.depth;){if(f+=1,!r.plainObjects&&hu.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+o.slice(l.index)+"]"),HN(u,t,r,i)}},qN=function(e){if(!e)return $e;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=typeof e.charset>"u"?$e.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?$e.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:$e.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:$e.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:$e.arrayLimit,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:$e.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:$e.comma,decoder:typeof e.decoder=="function"?e.decoder:$e.decoder,delimiter:typeof e.delimiter=="string"||wi.isRegExp(e.delimiter)?e.delimiter:$e.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:$e.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:$e.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:$e.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:$e.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:$e.strictNullHandling}},GN=function(n,e){var t=qN(e);if(n===""||n===null||typeof n>"u")return t.plainObjects?Object.create(null):{};for(var r=typeof n=="string"?WN(n,t):n,i=t.plainObjects?Object.create(null):{},o=Object.keys(r),s=0;s<o.length;++s){var a=o[s],l=VN(a,r[a],t,typeof n=="string");i=wi.merge(i,l,t)}return t.allowSparse===!0?i:wi.compact(i)},JN=jN,UN=GN,KN=Nf,db={formats:KN,parse:UN,stringify:JN};const In={getSettings:async n=>(await lt("forms/settings",n,"GET",null,null,!0)).json(),getForms:async(n,e)=>(await lt(`forms?${db.stringify({pagination:{page:e.page,pageSize:e.pageSize},fields:["title","createdAt","active","dateFrom","dateTill"],sort:"createdAt:desc",populate:["submissions","notifications"]})}`,n,"GET",null,null,!0)).json(),getForm:async(n,e,t)=>(await(await lt(`forms/${e}${t?`?${t}`:""}`,n,"GET",null,null,!0)).json()).data,getMessage:async n=>(await(await lt(`form/${n}/message`,"GET",null,null,!0)).json()).data,getFormSubmissions:async(n,e)=>(await(await lt(`form/${n}/submissions${e?`?${e}`:""}`,"GET",null,null,!0)).json()).data,generateForm:async(n,e)=>{try{return(await lt("forms/generate",n,"POST",null,e,!0)).json()}catch{throw new Error("Failed to generate form")}},submitForm:async(n,e)=>{try{const t=await lt("forms",n,"POST",null,e,!0);if(!t.ok)throw new Error("Failed to submit form");return t.json()}catch{throw new Error("Failed to submit form")}},updateForm:async(n,e,t)=>(await lt(`forms/${e}`,n,"PUT",null,t,!0)).json(),deleteForm:async(n,e)=>(await lt(`forms/${e}`,n,"DELETE",null,null,!0)).json()},YN=()=>{const n=wu(),{formatMessage:e}=Ct(),{id:t}=um(),r=Ao("Admin",O=>O.token),{state:i,dispatch:o}=ki(),[s,a]=v.useState(!0),[l,c]=v.useState(!1),[u,f]=v.useState(!1),[d,h]=v.useState("success"),[p,m]=v.useState(""),[g,b]=v.useState({}),[x,w]=v.useState(null),[C,S]=v.useState(null);v.useEffect(()=>{setTimeout(()=>{u&&f(!1)},5e3)},[d]),v.useEffect(()=>{if(!t){a(!1);return}In.getForm(r,t).then(O=>{w(O.dateFrom),S(O.dateTill),o({type:"EDIT_FORM",payload:O})}).finally(()=>a(!1))},[]);const k=async()=>{if(!i.title||!i.steps||!i.successMessage||!i.errorMessage)return h("danger"),f(!0);const O=yw(i,["currentStep"]);try{if(!t){const M=await In.submitForm(r,O);return b(M.data),c(!0)}await In.updateForm(r,t,O),c(!0),f(!1)}catch(M){return m(M.message),h("danger"),f(!0)}};return s?y.jsx(gt.Loading,{}):y.jsxs(Kt.Root,{children:[y.jsx(gt.Title,{children:e({id:A("heading.menu")})}),y.jsxs(gt.Main,{style:{position:"relative"},children:[u?y.jsx(_0,{variant:d,toggleAlert:f,message:p!==""?p:e({id:A(`alert.description.${d}`)})}):y.jsx(y.Fragment,{}),y.jsx(Kt.Header,{title:e({id:A("heading.menu")}),subtitle:e({id:A(t?"heading.edit":"heading.add")}),primaryAction:y.jsx(he,{onClick:k,children:e({id:A("save")})}),navigationAction:y.jsx(vu,{fallback:`/plugins/${wt}`,disabled:!1})}),y.jsxs(Kt.Content,{children:[y.jsx(vt,{children:y.jsx(vt,{background:"neutral0",padding:4,marginBottom:4,shadow:"filterShadow",hasRadius:!0,children:y.jsxs(Tt.Root,{gap:3,children:[y.jsx(Tt.Item,{col:6,xs:12,children:y.jsxs(X.Root,{name:"title",required:!0,style:{width:"100%"},error:!i.title&&u&&p===""?e({id:A("required")}):"",children:[y.jsx(X.Label,{children:e({id:A("forms.fields.title")})}),y.jsx(X.Input,{name:"title",type:"text",value:i.title,onChange:O=>o({type:"EDIT_FORM",payload:{title:O.currentTarget.value}})}),y.jsx(X.Error,{})]})}),y.jsx(Tt.Item,{col:6,xs:12,children:y.jsxs(Tt.Root,{name:"date",gap:2,style:{width:"100%"},children:[y.jsx(Tt.Item,{col:6,xs:6,children:y.jsxs(X.Root,{style:{width:"100%"},children:[y.jsx(X.Label,{children:e({id:A("forms.fields.dateFrom")})}),x?y.jsx(y.Fragment,{children:y.jsxs(ye,{children:[y.jsx(Me,{children:x}),y.jsx(Ns,{style:{cursor:"pointer",marginLeft:"10px",width:"0.75rem"},onClick:()=>w(null),color:"primary"})]})}):y.jsx(Uf,{locale:"nl-NL",minDate:new Date,label:e({id:A("forms.fields.dateFrom")}),onChange:O=>{if(!O)return;const M=new Date;w(null),o({type:"EDIT_FORM",payload:{dateFrom:wd(O,"dd-MM-yyyy")+"T00:00:00.000Z",active:M>=O}})},onClear:()=>o({type:"EDIT_FORM",payload:{dateFrom:null,active:!0}})})]})}),y.jsx(Tt.Item,{col:6,xs:6,children:y.jsxs(X.Root,{style:{width:"100%"},children:[y.jsx(X.Label,{children:e({id:A("forms.fields.dateTill")})}),C?y.jsx(y.Fragment,{children:y.jsxs(ye,{children:[y.jsx(Me,{children:C}),y.jsx(Ns,{style:{cursor:"pointer",marginLeft:"10px",width:"0.75rem"},onClick:()=>S(null),color:"primary"})]})}):y.jsx(Uf,{locale:"nl-NL",minDate:new Date,label:e({id:A("forms.fields.dateTill")}),onChange:O=>{if(!O)return;const M=new Date;S(null),o({type:"EDIT_FORM",payload:{dateTill:wd(O,"dd-MM-yyyy")+"T00:00:00.000Z",active:M<=O}})},onClear:()=>o({type:"EDIT_FORM",payload:{dateTill:null,active:!0}})})]})})]})}),y.jsx(Tt.Item,{padding:1,col:6,xs:6,children:y.jsxs(X.Root,{required:!0,name:"successMessage",style:{width:"100%"},error:!i.successMessage&&u&&p===""?e({id:A("required")}):"",children:[y.jsx(X.Label,{children:e({id:A("forms.fields.successMessage")})}),y.jsx(lo,{name:"successMessage",type:"text",value:i.successMessage,onChange:O=>o({type:"EDIT_FORM",payload:{successMessage:O.currentTarget.value}})}),y.jsx(X.Error,{})]})}),y.jsx(Tt.Item,{padding:1,col:6,xs:6,children:y.jsxs(X.Root,{required:!0,name:"errorMessage",style:{width:"100%"},error:!i.errorMessage&&u&&p===""?e({id:A("required")}):"",children:[y.jsx(X.Label,{children:e({id:A("forms.fields.errorMessage")})}),y.jsx(lo,{name:"errorMessage",type:"text",value:i.errorMessage,onChange:O=>o({type:"EDIT_FORM",payload:{errorMessage:O.currentTarget.value}})}),y.jsx(X.Error,{})]})})]})})}),y.jsx(KD,{}),y.jsx(Te.Root,{open:l,onDismiss:()=>c(!1),children:y.jsxs(Te.Content,{children:[y.jsx(Te.Header,{children:e({id:A("alert.success")})}),y.jsx(Te.Body,{icon:y.jsx(pw,{fill:"success600"}),children:e({id:A("alert.description.success")})}),y.jsxs(Te.Footer,{children:[y.jsx(Te.Cancel,{children:y.jsx(he,{fullWidth:!0,variant:"secondary",onClick:()=>{n(`/plugins/${wt}/form/${g.documentId}`),c(!1)},children:e({id:A("back_to_form")})})}),y.jsx(Te.Action,{children:y.jsx(he,{fullWidth:!0,variant:"primary",onClick:()=>n(`/plugins/${wt}`),children:e({id:A("back_to_overview")})})})]})]})})]})]})]})},Ip=()=>y.jsx(y0,{children:y.jsx(YN,{})}),XN=({formId:n,disabled:e})=>{const{formatMessage:t}=Ct(),[r,i]=v.useState(!1),{get:o}=cw(),{toggleNotification:s}=uw(),a=async l=>{i(!0),o(`/${wt}/submissions/export/${l}`).then(c=>{const u=new Blob([c.data.data]),f=document.createElement("a");f.href=window.URL.createObjectURL(u),f.download=c.data.filename,f.click(),i(!1),s({type:"success"})})};return y.jsx(y.Fragment,{children:y.jsx(Nt,{variant:"secondary",disabled:r||e,onClick:()=>a(n),startIcon:r?y.jsx(fw,{small:!0}):y.jsx(dw,{}),children:t({id:`${wt}.forms.fields.actions.export_submissions`})})})},QN=({...n})=>y.jsx("svg",{focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"SendIcon",width:n.width??24,height:n.height??24,children:y.jsx("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z",fill:"currentColor"})}),ZN=({handleOnClick:n})=>{const{formatMessage:e}=Ct();return y.jsx(y.Fragment,{children:y.jsx(Nt,{variant:"secondary",onClick:()=>n(_o.Notification),startIcon:y.jsx(QN,{width:16,height:16}),children:e({id:A("handlers.notification")})})})},eI=({...n})=>y.jsx("svg",{focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24","data-testid":"SendIcon",width:n.width??24,height:n.height??24,children:y.jsx("path",{d:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11",fill:"currentColor"})}),tI=({handleOnClick:n})=>{const{formatMessage:e}=Ct();return y.jsx(Nt,{variant:"secondary",onClick:()=>n(_o.Confirmation),startIcon:y.jsx(eI,{width:16,height:16}),children:e({id:A("handlers.confirmation")})})},nI=({notifications:n,setModalIsVisible:e,setHandlerType:t})=>{const r=i=>{const o=n.find(s=>s.identifier===i);t(o),e(!0)};return y.jsx(y.Fragment,{children:n.map((i,o)=>i.identifier===_o.Notification?y.jsx(ZN,{handleOnClick:r},o):y.jsx(tI,{handleOnClick:r},o))})},rI=({notification:n,setValue:e})=>{const{state:t}=ki(),{formatMessage:r}=Ct(),i=[];return t.steps.map(o=>o.layouts.lg.map(s=>{if(Array.isArray(s.field))return;s.field.type==="email"&&i.push(s.field)})),i.length?y.jsx(y.Fragment,{children:y.jsx(ga,{label:r({id:A("forms.fields.select_recipient")}),value:n.to,onChange:o=>e("to",o),placeholder:r({id:A("forms.fields.select_recipient")}),name:"to",children:i.map((o,s)=>y.jsxs(co,{value:o.name,children:[o.label," field"]},`select-${o.name}-${s}`))})}):y.jsx(y.Fragment,{})},Ql={update:async(n,e,t)=>{const r=t;return delete r.id,delete r.documentId,delete r.createdAt,delete r.updatedAt,delete r.publishedAt,delete r.form,(await(await lt(`notifications/update/${e}`,n,"PUT",null,r,!0)).json()).data},get:async(n,e)=>(await(await lt(`notifications/${e}`,n,"GET",null,null,!0)).json()).data,test:async(n,e)=>await lt(`notifications/test/${e}`,n,"POST",null,{data:{notificationId:e}},!0)};function Le(n){this.content=n}Le.prototype={constructor:Le,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new Le(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Le(t)},addToStart:function(n,e){return new Le([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new Le(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new Le(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=Le.from(n),n.size?new Le(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=Le.from(n),n.size?new Le(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=Le.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};Le.from=function(n){if(n instanceof Le)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new Le(e)};function hb(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=hb(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function pb(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let c=pb(s.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class ${constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,a=0;a<t;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new $(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),i+=a.nodeSize),s=l}return new $(r,i)}cutByIndex(e,t){return e==t?$.empty:e==0&&t==this.content.length?this:new $(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new $(i,o)}addToStart(e){return new $([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new $(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return hb(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return pb(this,e,t,r)}findIndex(e,t=-1){if(e==0)return ps(0,e);if(e==this.size)return ps(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?ps(r+1,s):ps(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return $.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new $(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return $.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new $(t||e,r)}static from(e){if(!e)return $.empty;if(e instanceof $)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new $([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}$.empty=new $([],0);const Zl={index:0,offset:0};function ps(n,e){return Zl.index=n,Zl.offset=e,Zl}function aa(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!aa(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!aa(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class ce{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&aa(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return ce.none;if(e instanceof ce)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}}ce.none=[];class la extends Error{}class _{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=gb(this.content,e+this.openStart,t);return r&&new _(r,this.openStart,this.openEnd)}removeBetween(e,t){return new _(mb(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return _.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new _($.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new _(e,r,i)}}_.empty=new _($.empty,0,0);function mb(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(i==e||o.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(mb(o.content,e-i-1,t-i-1)))}function gb(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=gb(s.content,e-o-1,t);return a&&n.replaceChild(i,s.copy(a))}function iI(n,e,t){if(t.openStart>n.depth)throw new la("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new la("Inconsistent open depths");return yb(n,e,t,0)}function yb(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=yb(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return br(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=oI(t,n);return br(o,wb(n,s,a,e,r))}else return br(o,ca(n,e,r))}function bb(n,e){if(!e.type.compatibleContent(n.type))throw new la("Cannot join "+e.type.name+" onto "+n.type.name)}function pu(n,e,t){let r=n.node(t);return bb(r,e.node(t)),r}function yr(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function oo(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(yr(n.nodeAfter,r),o++));for(let a=o;a<s;a++)yr(i.child(a),r);e&&e.depth==t&&e.textOffset&&yr(e.nodeBefore,r)}function br(n,e){return n.type.checkContent(e),n.copy(e)}function wb(n,e,t,r,i){let o=n.depth>i&&pu(n,e,i+1),s=r.depth>i&&pu(t,r,i+1),a=[];return oo(null,n,i,a),o&&s&&e.index(i)==t.index(i)?(bb(o,s),yr(br(o,wb(n,e,t,r,i+1)),a)):(o&&yr(br(o,ca(n,e,i+1)),a),oo(e,t,i,a),s&&yr(br(s,ca(t,r,i+1)),a)),oo(r,null,i,a),new $(a)}function ca(n,e,t){let r=[];if(oo(null,n,t,r),n.depth>t){let i=pu(n,e,t+1);yr(br(i,ca(n,e,t+1)),r)}return oo(e,null,t,r),new $(r)}function oI(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy($.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class Mo{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return ce.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new ua(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new Mo(t,r,o)}static resolveCached(e,t){let r=zp.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else zp.set(e,r=new sI);let i=r.elts[r.i]=Mo.resolve(e,t);return r.i=(r.i+1)%aI,i}}class sI{constructor(){this.elts=[],this.i=0}}const aI=12,zp=new WeakMap;class ua{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const lI=Object.create(null);let wr=class mu{constructor(e,t,r,i=ce.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||$.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&aa(this.attrs,t||e.defaultAttrs||lI)&&ce.sameSet(this.marks,r||ce.none)}copy(e=null){return e==this.content?this:new mu(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new mu(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return _.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new _(c,i.depth-s,o.depth-s)}replace(e,t,r){return iI(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Mo.resolveCached(this,e)}resolveNoCache(e){return Mo.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),vb(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=$.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ce.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!ce.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=$.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};wr.prototype.text=void 0;class fa extends wr{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):vb(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new fa(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new fa(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function vb(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Or{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new cI(e,t);if(r.next==null)return Or.empty;let i=xb(r);r.next&&r.err("Unexpected trailing text");let o=gI(mI(i));return yI(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return $.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:f}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let d=o(f,a.concat(u));if(d)return d}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}Or.empty=new Or(!0);class cI{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function xb(n){let e=[];do e.push(uI(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function uI(n){let e=[];do e.push(fI(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function fI(n){let e=pI(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=dI(n,e);else break;return e}function jp(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function dI(n,e){let t=jp(n),r=t;return n.eat(",")&&(n.next!="}"?r=jp(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function hI(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function pI(n){if(n.eat("(")){let e=xb(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=hI(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function mI(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=t())}else if(s.type=="star"){let l=t();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=t();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=t();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Sb(n,e){return e-n}function Lp(n,e){let t=[];return r(e),t.sort(Sb);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&t.indexOf(l)==-1&&r(l)}}}function gI(n){let e=Object.create(null);return t(Lp(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Lp(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new Or(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(Sb);o.next.push({type:i[s][0],next:e[a.join(",")]||t(a)})}return o}}function yI(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Cb(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function kb(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Ob(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function Mb(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new wI(n,r,e[r]);return t}class da{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Mb(e,r.attrs),this.defaultAttrs=Cb(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Or.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:kb(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new wr(this,this.computeAttrs(e),$.from(t),ce.setFrom(r))}createChecked(e=null,t,r){return t=$.from(t),this.checkContent(t),new wr(this,this.computeAttrs(e),t,ce.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=$.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore($.empty,!0);return o?new wr(this,e,t.append(o),ce.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Ob(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:ce.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new da(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}function bI(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class wI{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?bI(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class If{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=Mb(e,i.attrs),this.excluded=null;let o=Cb(this.attrs);this.instance=o?new ce(this,o):null}create(e=null){return!e&&this.instance?this.instance:new ce(this,kb(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new If(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Ob(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class vI{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Le.from(e.nodes),t.marks=Le.from(e.marks||{}),this.nodes=da.compile(this.spec.nodes,this),this.marks=If.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=Or.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Bp(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Bp(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof da){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new fa(r,r.defaultAttrs,e,ce.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return wr.fromJSON(this,e)}markFromJSON(e){return ce.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Bp(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function xI(n){return n.tag!=null}function SI(n){return n.style!=null}class si{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(xI(i))this.tags.push(i);else if(SI(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new _p(this,t,!1);return r.addAll(e,ce.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new _p(this,t,!0);return r.addAll(e,ce.none,t.from,t.to),_.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(OI(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Wp(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Wp(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new si(e,si.schemaRules(e)))}}const Eb={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},CI={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Tb={ol:!0,ul:!0},Eo=1,gu=2,so=4;function Fp(n,e,t){return e!=null?(e?Eo:0)|(e==="full"?gu:0):n&&n.whitespace=="pre"?Eo|gu:t&~so}class ms{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=ce.none,this.match=o||(s&so?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore($.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Eo)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=$.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore($.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Eb.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class _p{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,s=Fp(null,t.preserveWhitespace,0)|(r?so:0);i?o=new ms(i.type,i.attrs,ce.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new ms(null,null,ce.none,!0,null,s):o=new ms(e.schema.topNodeType,null,ce.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,o=i.options&gu?"full":this.localPreserveWS||(i.options&Eo)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;Tb.hasOwnProperty(s)&&this.parser.normalizeLists&&kI(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:CI.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(Eb.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let f=l&&l.skip?t:this.readStyles(e,t);f&&this.addAll(e,f),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(s,t.attrs||null,r,t.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],a=s.findWrapping(e);if(a&&(!r||r.length>a.length)&&(r=a,i=s,!a.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)t=this.enterInner(r[o],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let r=this.findPlace(e,t);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=ce.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):Hp(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Fp(e,o,s.options);s.options&so&&s.content.length==0&&(a|=so);let l=ce.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Hp(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new ms(e,t,l,i,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Eo)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function kI(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Tb.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function OI(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Wp(n){let e={};for(let t in n)e[t]=n[t];return e}function Hp(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}const Rb=65535,Ab=Math.pow(2,16);function MI(n,e){return n+e*Ab}function Vp(n){return n&Rb}function EI(n){return(n-(n&Rb))/Ab}const Db=1,$b=2,$s=4,Pb=8;class qp{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Pb)>0}get deletedBefore(){return(this.delInfo&(Db|$s))>0}get deletedAfter(){return(this.delInfo&($b|$s))>0}get deletedAcross(){return(this.delInfo&$s)>0}}class bt{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&bt.empty)return bt.empty}recover(e){let t=0,r=Vp(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+EI(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],f=l+c;if(e<=f){let d=c?e==l?-1:e==f?1:t:t,h=l+i+(d<0?0:u);if(r)return h;let p=e==(t<0?l:f)?null:MI(a/3,e-l),m=e==l?$b:e==f?Db:$s;return(t<0?e!=l:e!=f)&&(m|=Pb),new qp(h,m,p)}i+=u-c}return r?e+i:new qp(e+i,0,null)}touches(e,t){let r=0,i=Vp(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new bt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?bt.empty:new bt(e<0?[0,-e,0]:[0,0,e])}}bt.empty=new bt([]);const ec=Object.create(null);class Xe{getMap(){return bt.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=ec[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in ec)throw new RangeError("Duplicate use of step JSON ID "+e);return ec[e]=t,t.prototype.jsonID=e,t}}class Ee{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ee(e,null)}static fail(e){return new Ee(null,e)}static fromReplace(e,t,r,i){try{return Ee.ok(e.replace(t,r,i))}catch(o){if(o instanceof la)return Ee.fail(o.message);throw o}}}function zf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(zf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return $.fromArray(r)}class sr extends Xe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new _(zf(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Ee.fromReplace(e,this.from,this.to,o)}invert(){return new ar(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new sr(t.pos,r.pos,this.mark)}merge(e){return e instanceof sr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new sr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new sr(t.from,t.to,e.markFromJSON(t.mark))}}Xe.jsonID("addMark",sr);class ar extends Xe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new _(zf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Ee.fromReplace(e,this.from,this.to,r)}invert(){return new sr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ar(t.pos,r.pos,this.mark)}merge(e){return e instanceof ar&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ar(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ar(t.from,t.to,e.markFromJSON(t.mark))}}Xe.jsonID("removeMark",ar);class lr extends Xe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ee.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ee.fromReplace(e,this.pos,this.pos+1,new _($.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new lr(this.pos,t.marks[i]);return new lr(this.pos,this.mark)}}return new To(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new lr(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new lr(t.pos,e.markFromJSON(t.mark))}}Xe.jsonID("addNodeMark",lr);class To extends Xe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ee.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ee.fromReplace(e,this.pos,this.pos+1,new _($.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new lr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new To(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new To(t.pos,e.markFromJSON(t.mark))}}Xe.jsonID("removeNodeMark",To);class mt extends Xe{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&yu(e,this.from,this.to)?Ee.fail("Structure replace would overwrite content"):Ee.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new bt([this.from,this.to-this.from,this.slice.size])}invert(e){return new mt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new mt(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof mt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?_.empty:new _(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new mt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?_.empty:new _(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new mt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new mt(t.from,t.to,_.fromJSON(e,t.slice),!!t.structure)}}Xe.jsonID("replace",mt);class ut extends Xe{constructor(e,t,r,i,o,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&(yu(e,this.from,this.gapFrom)||yu(e,this.gapTo,this.to)))return Ee.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ee.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Ee.fromReplace(e,this.from,this.to,r):Ee.fail("Content does not fit in gap")}getMap(){return new bt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ut(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new ut(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ut(t.from,t.to,t.gapFrom,t.gapTo,_.fromJSON(e,t.slice),t.insert,!!t.structure)}}Xe.jsonID("replaceAround",ut);function yu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function TI(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function Ai(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!TI(i,o,s))break}return null}function Nb(n,e,t=null,r=n){let i=RI(n,e),o=i&&AI(r,e);return o?i.map(Gp).concat({type:e,attrs:t}).concat(o.map(Gp)):null}function Gp(n){return{type:n,attrs:null}}function RI(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function AI(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:s}function ai(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>o;c--,u--){let f=i.node(c),d=i.index(c);if(f.type.spec.isolating)return!1;let h=f.content.cutByIndex(d,f.childCount),p=r&&r[u+1];p&&(h=h.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||f;if(!f.canReplace(d+1,f.childCount)||!m.type.validContent(h))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function Ar(n,e){let t=n.resolve(e),r=t.index();return Ib(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function DI(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?n.type.schema.nodes.text:o.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(o.marks))return!1}return t.validEnd}function Ib(n,e){return!!(n&&e&&!n.isLeaf&&DI(n,e))}function Za(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):t>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&Ib(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function jf(n,e,t=e,r=_.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return $I(i,o,r)?new mt(e,t,r):new PI(i,o,r).fit()}function $I(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class PI{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=$.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=$.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new _(o,s,a);return e>-1?new ut(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new mt(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=tc(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,f=null;if(t==1&&(s?c.matchType(s.type)||(f=c.fillBefore($.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:f};if(t==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=tc(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new _(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=tc(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new _(Ki(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new _(Ki(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));f=f.matchFragment(i)}let h=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),g=f.matchType(m.type);if(!g)break;c++,(c>1||l==0||m.content.size)&&(f=g,u.push(zb(m.mark(d.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?h:-1)))}let p=c==a.childCount;p||(h=-1),this.placed=Yi(this.placed,t,$.from(u)),this.frontier[t].match=f,p&&h<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<h;m++){let b=g.lastChild;this.frontier.push({type:b.type,match:b.contentMatchAt(b.childCount)}),g=b.content}this.unplaced=p?e==0?_.empty:new _(Ki(s.content,e-1,1),e-1,h<0?s.openEnd:e-1):new _(Ki(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!nc(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=nc(e,t,i,r,o);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=nc(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Yi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Yi(this.placed,this.depth,$.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore($.empty,!0);t.childCount&&(this.placed=Yi(this.placed,this.frontier.length,t))}}function Ki(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Ki(n.firstChild.content,e-1,t)))}function Yi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Yi(n.lastChild.content,e-1,t)))}function tc(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function zb(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,zb(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore($.empty,!0)))),n.copy(r)}function nc(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!NI(t,o.content,s)?a:null}function NI(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}class ao extends Xe{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ee.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Ee.fromReplace(e,this.pos,this.pos+1,new _($.from(i),0,t.isLeaf?0:1))}getMap(){return bt.empty}invert(e){return new ao(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ao(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new ao(t.pos,t.attr,t.value)}}Xe.jsonID("attr",ao);class ha extends Xe{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return Ee.ok(r)}getMap(){return bt.empty}invert(e){return new ha(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new ha(t.attr,t.value)}}Xe.jsonID("docAttr",ha);let Ro=class extends Error{};Ro=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Ro.prototype=Object.create(Error.prototype);Ro.prototype.constructor=Ro;Ro.prototype.name="TransformError";const rc=Object.create(null);class ie{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new II(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=_.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?_.empty:t),a==0&&Kp(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Kp(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new be(e):Kr(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?Kr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Kr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new jt(e.node(0))}static atStart(e){return Kr(e,e,0,0,1)||new jt(e)}static atEnd(e){return Kr(e,e,e.content.size,e.childCount,-1)||new jt(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=rc[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in rc)throw new RangeError("Duplicate use of selection JSON ID "+e);return rc[e]=t,t.prototype.jsonID=e,t}getBookmark(){return be.between(this.$anchor,this.$head).getBookmark()}}ie.prototype.visible=!0;class II{constructor(e,t){this.$from=e,this.$to=t}}let Jp=!1;function Up(n){!Jp&&!n.parent.inlineContent&&(Jp=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class be extends ie{constructor(e,t=e){Up(e),Up(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return ie.near(r);let i=e.resolve(t.map(this.anchor));return new be(i.parent.inlineContent?i:r,r)}replace(e,t=_.empty){if(super.replace(e,t),t==_.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof be&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new el(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new be(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=ie.findFrom(t,r,!0)||ie.findFrom(t,-r,!0);if(o)t=o.$head;else return ie.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(ie.findFrom(e,-r,!0)||ie.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new be(e,t)}}ie.jsonID("text",be);class el{constructor(e,t){this.anchor=e,this.head=t}map(e){return new el(e.map(this.anchor),e.map(this.head))}resolve(e){return be.between(e.resolve(this.anchor),e.resolve(this.head))}}class fe extends ie{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?ie.near(o):new fe(o)}content(){return new _($.from(this.node),0,0)}eq(e){return e instanceof fe&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Lf(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new fe(e.resolve(t.anchor))}static create(e,t){return new fe(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}fe.prototype.visible=!1;ie.jsonID("node",fe);class Lf{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new el(r,r):new Lf(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&fe.isSelectable(r)?new fe(t):ie.near(t)}}class jt extends ie{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=_.empty){if(t==_.empty){e.delete(0,e.doc.content.size);let r=ie.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new jt(e)}map(e){return new jt(e)}eq(e){return e instanceof jt}getBookmark(){return zI}}ie.jsonID("all",jt);const zI={map(){return this},resolve(n){return new jt(n)}};function Kr(n,e,t,r,i,o=!1){if(e.inlineContent)return be.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&fe.isSelectable(a))return fe.create(n,t-(i<0?a.nodeSize:0))}else{let l=Kr(n,a,t+i,i<0?a.childCount:0,i,o);if(l)return l}t+=a.nodeSize*i}return null}function Kp(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof mt||i instanceof ut))return;let o=n.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),n.setSelection(ie.near(n.doc.resolve(s),t))}function Yp(n,e){return!e||!n?n:n.bind(e)}class gs{constructor(e,t,r){this.name=e,this.init=Yp(t.init,r),this.apply=Yp(t.apply,r)}}new gs("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new gs("selection",{init(n,e){return n.selection||ie.atStart(e.doc)},apply(n){return n.selection}}),new gs("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new gs("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}});function jb(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=jb(i,e,{})),t[r]=i}return t}class Dr{constructor(e){this.spec=e,this.props={},e.props&&jb(e.props,this,this.props),this.key=e.key?e.key.key:Lb("plugin")}getState(e){return e[this.key]}}const ic=Object.create(null);function Lb(n){return n in ic?n+"$"+ ++ic[n]:(ic[n]=0,n+"$")}class $r{constructor(e="key"){this.key=Lb(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const jI=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Bb(n,e){let{$cursor:t}=n.selection;return!t||t.parentOffset>0?null:t}const LI=(n,e,t)=>{let r=Bb(n);if(!r)return!1;let i=Bf(r);if(!i){let s=r.blockRange(),a=s&&Ai(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(Hb(n,i,e,-1))return!0;if(r.parent.content.size==0&&(vi(o,"end")||fe.isSelectable(o)))for(let s=r.depth;;s--){let a=jf(n.doc,r.before(s),r.after(s),_.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(vi(o,"end")?ie.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):fe.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},BI=(n,e,t)=>{let r=Bb(n);if(!r)return!1;let i=Bf(r);return i?Fb(n,i,e):!1},FI=(n,e,t)=>{let r=_b(n);if(!r)return!1;let i=Ff(r);return i?Fb(n,i,e):!1};function Fb(n,e,t){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=jf(n.doc,o,l,_.empty);if(!c||c.from!=o||c instanceof mt&&c.slice.size>=l-o)return!1;if(t){let u=n.tr.step(c);u.setSelection(be.create(u.doc,o)),t(u.scrollIntoView())}return!0}function vi(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const _I=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(r.parentOffset>0)return!1;o=Bf(r)}let s=o&&o.nodeBefore;return!s||!fe.isSelectable(s)?!1:(e&&e(n.tr.setSelection(fe.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function Bf(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function _b(n,e){let{$cursor:t}=n.selection;return!t||t.parentOffset<t.parent.content.size?null:t}const WI=(n,e,t)=>{let r=_b(n);if(!r)return!1;let i=Ff(r);if(!i)return!1;let o=i.nodeAfter;if(Hb(n,i,e,1))return!0;if(r.parent.content.size==0&&(vi(o,"start")||fe.isSelectable(o))){let s=jf(n.doc,r.before(),r.after(),_.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(vi(o,"start")?ie.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):fe.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},HI=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(r.parentOffset<r.parent.content.size)return!1;o=Ff(r)}let s=o&&o.nodeAfter;return!s||!fe.isSelectable(s)?!1:(e&&e(n.tr.setSelection(fe.create(n.doc,o.pos)).scrollIntoView()),!0)};function Ff(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const VI=(n,e)=>{let t=n.selection,r=t instanceof fe,i;if(r){if(t.node.isTextblock||!Ar(n.doc,t.from))return!1;i=t.from}else if(i=Za(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection(fe.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},qI=(n,e)=>{let t=n.selection,r;if(t instanceof fe){if(t.node.isTextblock||!Ar(n.doc,t.to))return!1;r=t.to}else if(r=Za(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},GI=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&Ai(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},JI=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Wb(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const UI=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=Wb(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(ie.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},KI=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof jt||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=Wb(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(be.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},YI=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(ai(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&Ai(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},XI=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection(fe.create(n.doc,i))),!0)};function QI(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Ar(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function Hb(n,e,t,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&QI(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(t){let h=e.pos+o.nodeSize,p=$.empty;for(let b=s.length-1;b>=0;b--)p=$.from(s[b].create(null,p));p=$.from(i.copy(p));let m=n.tr.step(new ut(e.pos-1,h,e.pos,h,new _(p,1,0),s.length,!0)),g=m.doc.resolve(h+2*s.length);g.nodeAfter&&g.nodeAfter.type==i.type&&Ar(m.doc,g.pos)&&m.join(g.pos),t(m.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:ie.findFrom(e,1),f=u&&u.$from.blockRange(u.$to),d=f&&Ai(f);if(d!=null&&d>=e.depth)return t&&t(n.tr.lift(f,d).scrollIntoView()),!0;if(c&&vi(o,"start",!0)&&vi(i,"end")){let h=i,p=[];for(;p.push(h),!h.isTextblock;)h=h.lastChild;let m=o,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(h.canReplace(h.childCount,h.childCount,m.content)){if(t){let b=$.empty;for(let w=p.length-1;w>=0;w--)b=$.from(p[w].copy(b));let x=n.tr.step(new ut(e.pos-p.length,e.pos+o.nodeSize,e.pos+g,e.pos+o.nodeSize-g,new _(b,p.length,0),0,!0));t(x.scrollIntoView())}return!0}}return!1}function Vb(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(be.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const ZI=Vb(-1),ez=Vb(1);function tz(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=s&&Nb(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function Xp(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),f=u.index();i=u.parent.canReplaceWith(f,f+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];o.setBlockType(a,l,n,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function nz(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o);if(!s)return!1;let a=r?t.tr:null;return rz(a,s,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function rz(n,e,t,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new ua(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new ua(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=Nb(o,t,r,e);return a?(n&&iz(n,e,a,i,t),!0):!1}function iz(n,e,t,r,i){let o=$.empty;for(let u=t.length-1;u>=0;u--)o=$.from(t[u].type.create(t[u].attrs,o));n.step(new ut(e.start-(r?2:0),e.end,e.start,e.end,new _(o,0,0),t.length,!0));let s=0;for(let u=0;u<t.length;u++)t[u].type==i&&(s=u+1);let a=t.length-s,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,d=!0;u<f;u++,d=!1)!d&&ai(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function oz(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?sz(e,t,n,o):az(e,t,o):!0:!1}}function sz(n,e,t,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new ut(o-1,s,o,s,new _($.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new ua(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=Ai(r);if(a==null)return!1;i.lift(r,a);let l=i.mapping.map(o,-1)-1;return Ar(i.doc,l)&&i.join(l),e(i.scrollIntoView()),!0}function az(n,e,t){let r=n.tr,i=t.parent;for(let h=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)h-=i.child(p).nodeSize,r.delete(h-1,h+1);let o=r.doc.resolve(t.start),s=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?$.empty:$.from(i))))return!1;let f=o.pos,d=f+s.nodeSize;return r.step(new ut(f-(a?1:0),d+(l?1:0),f+1,d-1,new _((a?$.empty:$.from(i.copy($.empty))).append(l?$.empty:$.from(i.copy($.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function lz(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=$.from(c?n.create():null),f=new _($.from(n.create(null,$.from(a.type.create(null,u)))),c?3:1,0),d=o.start,h=o.end;t(e.tr.step(new ut(d-(c?3:1),h,d,h,f,1,!0)).scrollIntoView())}return!0}}function qb(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}class cz{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const f=l(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(d=>d===!0)),f={...Object.fromEntries(Object.entries(r).map(([d,h])=>[d,(...m)=>{const g=this.buildProps(c,t),b=h(...m)(g);return a.push(b),f}])),run:u};return f}createCan(e){const{rawCommands:t,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:qb({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}function zt(n,e,t){return n.config[e]===void 0&&n.parent?zt(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?zt(n.parent,e,t):null}):n.config[e]}function uz(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Ke(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function fz(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[f,d]=u.split(":").map(h=>h.trim());c.set(f,d)}),a.forEach(u=>{const[f,d]=u.split(":").map(h=>h.trim());c.set(f,d)}),r[i]=Array.from(c.entries()).map(([u,f])=>`${u}: ${f}`).join("; ")}else r[i]=o}),r},{})}function dz(n){return typeof n=="function"}function hn(n,e=void 0,...t){return dz(n)?e?n.bind(e)(...t):n(...t):n}function hz(n){return Object.prototype.toString.call(n)==="[object RegExp]"}function pz(n){return Object.prototype.toString.call(n).slice(8,-1)}function ys(n){return pz(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function _f(n,e){const t={...n};return ys(n)&&ys(e)&&Object.keys(e).forEach(r=>{ys(e[r])&&ys(n[r])?t[r]=_f(n[r],e[r]):t[r]=e[r]}),t}class _t{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=hn(zt(this,"addOptions",{name:this.name}))),this.storage=hn(zt(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new _t(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>_f(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new _t({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=hn(zt(t,"addOptions",{name:t.name})),t.storage=hn(zt(t,"addStorage",{name:t.name,options:t.options})),t}}function mz(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=t;let a="";return n.nodesBetween(r,i,(l,c,u,f)=>{var d;l.isBlock&&c>r&&(a+=o);const h=s?.[l.type.name];if(h)return u&&(a+=h({node:l,pos:c,parent:u,index:f,range:e})),!1;l.isText&&(a+=(d=l?.text)===null||d===void 0?void 0:d.slice(Math.max(r,c)-c,i-c))}),a}function gz(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}_t.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Dr({key:new $r("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=gz(t);return mz(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});const yz=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),bz=(n=!1)=>({commands:e})=>e.setContent("",n),wz=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(l)),d=c.resolve(u.map(l+a.nodeSize)),h=f.blockRange(d);if(!h)return;const p=Ai(h);if(a.type.isTextblock){const{defaultType:m}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(h.start,m)}(p||p===0)&&e.lift(h,p)})}),!0},vz=n=>e=>n(e),xz=()=>({state:n,dispatch:e})=>KI(n,e),Sz=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new be(r.doc.resolve(s-1))),!0},Cz=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1},kz=n=>({tr:e,state:t,dispatch:r})=>{const i=Ke(n,t.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},Oz=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},Mz=()=>({state:n,dispatch:e})=>jI(n,e),Ez=()=>({commands:n})=>n.keyboardShortcut("Enter"),Tz=()=>({state:n,dispatch:e})=>UI(n,e);function pa(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:hz(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function Gb(n,e,t={}){return n.find(r=>r.type===e&&pa(Object.fromEntries(Object.keys(t).map(i=>[i,r.attrs[i]])),t))}function Qp(n,e,t={}){return!!Gb(n,e,t)}function Jb(n,e,t){var r;if(!n||!e)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(t=t||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!Gb([...i.node.marks],e,t)))return;let s=i.index,a=n.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&Qp([...n.parent.child(s-1).marks],e,t);)s-=1,a-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&Qp([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function qn(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const Rz=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=qn(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:c,to:u}=a;if(i){const f=Jb(l,o,e);if(f&&f.from<=c&&f.to>=u){const d=be.create(s,f.from,f.to);t.setSelection(d)}}return!0},Az=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Ub(n){return n instanceof be}function cr(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function Dz(n,e=null){if(!e)return null;const t=ie.atStart(n),r=ie.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?be.create(n,cr(0,i,o),cr(n.content.size,i,o)):be.create(n,cr(e,i,o),cr(e,i,o))}function $z(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Wf(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Pz=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(Wf()||$z())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!Ub(t.state.selection))return s(),!0;const a=Dz(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},Nz=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),Iz=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),Kb=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&Kb(r)}return n};function bs(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return Kb(t)}function ma(n,e,t){if(n instanceof wr||n instanceof $)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return $.fromArray(n.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),ma("",e,t)}if(i){if(t.errorOnInvalidContent){let s=!1,a="";const l=new vI({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?si.fromSchema(l).parseSlice(bs(n),t.parseOptions):si.fromSchema(l).parse(bs(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=si.fromSchema(e);return t.slice?o.parseSlice(bs(n),t.parseOptions).content:o.parse(bs(n),t.parseOptions)}return ma("",e,t)}function zz(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof mt||i instanceof ut))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),n.setSelection(ie.near(n.doc.resolve(s),t))}const jz=n=>!("type"in n),Lz=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;try{a=ma(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(s=t.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(p){return o.emit("contentError",{editor:o,error:p,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},u=!0,f=!0;if((jz(a)?a:[a]).forEach(p=>{p.check(),u=u?p.isText&&p.marks.length===0:!1,f=f?p.isBlock:!1}),l===c&&f){const{parent:p}=r.doc.resolve(l);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(l-=1,c+=1)}let h;if(u){if(Array.isArray(e))h=e.map(p=>p.text||"").join("");else if(e instanceof $){let p="";e.forEach(m=>{m.text&&(p+=m.text)}),h=p}else typeof e=="object"&&e&&e.text?h=e.text:h=e;r.insertText(h,l,c)}else h=a,r.replaceWith(l,c,h);t.updateSelection&&zz(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:h}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:h})}return!0},Bz=()=>({state:n,dispatch:e})=>VI(n,e),Fz=()=>({state:n,dispatch:e})=>qI(n,e),_z=()=>({state:n,dispatch:e})=>LI(n,e),Wz=()=>({state:n,dispatch:e})=>WI(n,e),Hz=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Za(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},Vz=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Za(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},qz=()=>({state:n,dispatch:e})=>BI(n,e),Gz=()=>({state:n,dispatch:e})=>FI(n,e);function Yb(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function Jz(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Wf()||Yb()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const Uz=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=Jz(n).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l?.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Hf(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,s=e?Ke(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(f,d)=>{if(f.isText)return;const h=Math.max(r,d),p=Math.min(i,d+f.nodeSize);a.push({node:f,from:h,to:p})});const l=i-r,c=a.filter(f=>s?s.name===f.node.type.name:!0).filter(f=>pa(f.node.attrs,t,{strict:!1}));return o?!!c.length:c.reduce((f,d)=>f+d.to-d.from,0)>=l}const Kz=(n,e={})=>({state:t,dispatch:r})=>{const i=Ke(n,t.schema);return Hf(t,i,e)?GI(t,r):!1},Yz=()=>({state:n,dispatch:e})=>YI(n,e),Xz=n=>({state:e,dispatch:t})=>{const r=Ke(n,e.schema);return oz(r)(e,t)},Qz=()=>({state:n,dispatch:e})=>JI(n,e);function Xb(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function Zp(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const Zz=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=Xb(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Ke(n,r.schema)),a==="mark"&&(s=qn(n,r.schema)),i&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&t.setNodeMarkup(u,void 0,Zp(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(f=>{s===f.type&&t.addMark(u,u+c.nodeSize,s.create(Zp(f.attrs,e)))})})}),!0):!1},ej=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),tj=()=>({tr:n,dispatch:e})=>{if(e){const t=new jt(n.doc);n.setSelection(t)}return!0},nj=()=>({state:n,dispatch:e})=>_I(n,e),rj=()=>({state:n,dispatch:e})=>HI(n,e),ij=()=>({state:n,dispatch:e})=>XI(n,e),oj=()=>({state:n,dispatch:e})=>ez(n,e),sj=()=>({state:n,dispatch:e})=>ZI(n,e);function aj(n,e,t={},r={}){return ma(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const lj=(n,e=!1,t={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;const{doc:u}=o;if(t.preserveWhitespace!=="full"){const f=aj(n,i.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,f).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function cj(n,e){const t=qn(e,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function uj(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function fj(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Vf(n){return e=>fj(e.$from,n)}function Ps(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function dj(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?qn(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>o?o.name===f.type.name:!0).find(f=>pa(f.attrs,t,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:f,$to:d})=>{const h=f.pos,p=d.pos;n.doc.nodesBetween(h,p,(m,g)=>{if(!m.isText&&!m.marks.length)return;const b=Math.max(h,g),x=Math.min(p,g+m.nodeSize),w=x-b;s+=w,a.push(...m.marks.map(C=>({mark:C,from:b,to:x})))})}),s===0)return!1;const l=a.filter(f=>o?o.name===f.mark.type.name:!0).filter(f=>pa(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),c=a.filter(f=>o?f.mark.type!==o&&f.mark.type.excludes(o):!0).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+c:l)>=s}function em(n,e){const{nodeExtensions:t}=uz(e),r=t.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=hn(zt(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function Qb(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let i=!0;return n.content.forEach(o=>{i!==!1&&(Qb(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function hj(n,e,t){var r;const{selection:i}=e;let o=null;if(Ub(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,f,d)=>{if(c)return!1;if(u.isInline){const h=!d||d.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=h&&p}return!c}),c})}const pj=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:s,ranges:a}=o,l=qn(n,r.schema);if(i)if(s){const c=cj(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(u,f,(d,h)=>{const p=Math.max(h,u),m=Math.min(h+d.nodeSize,f);d.marks.find(b=>b.type===l)?d.marks.forEach(b=>{l===b.type&&t.addMark(p,m,l.create({...b.attrs,...e}))}):t.addMark(p,m,l.create(e))})});return hj(r,t,l)},mj=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),gj=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=Ke(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>Xp(o,{...s,...e})(t)?!0:a.clearNodes()).command(({state:a})=>Xp(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},yj=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=cr(n,0,r.content.size),o=fe.create(r,i);e.setSelection(o)}return!0},bj=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=be.atStart(r).from,a=be.atEnd(r).to,l=cr(i,s,a),c=cr(o,s,a),u=be.create(r,l,c);e.setSelection(u)}return!0},wj=n=>({state:e,dispatch:t})=>{const r=Ke(n,e.schema);return lz(r)(e,t)};function tm(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e?.includes(i.type.name));n.tr.ensureMarks(r)}}const vj=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=Ps(c,a.node().type.name,a.node().attrs);if(o instanceof fe&&o.node.isBlock)return!a.parentOffset||!ai(s,a.pos)?!1:(r&&(n&&tm(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const f=l.parentOffset===l.parent.content.size,d=a.depth===0?void 0:uj(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=f&&d?[{type:d,attrs:u}]:void 0,p=ai(e.doc,e.mapping.map(a.pos),1,h);if(!h&&!p&&ai(e.doc,e.mapping.map(a.pos),1,d?[{type:d}]:void 0)&&(p=!0,h=d?[{type:d,attrs:u}]:void 0),r){if(p&&(o instanceof be&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,h),d&&!f&&!a.parentOffset&&a.parent.type!==d)){const m=e.mapping.map(a.before()),g=e.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,d)&&e.setNodeMarkup(e.mapping.map(a.before()),d)}n&&tm(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return p},xj=(n,e={})=>({tr:t,state:r,dispatch:i,editor:o})=>{var s;const a=Ke(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const f=l.node(-1);if(f.type!==a)return!1;const d=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let b=$.empty;const x=l.index(-1)?1:l.index(-2)?2:3;for(let M=l.depth-x;M>=l.depth-3;M-=1)b=$.from(l.node(M).copy(b));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,C={...Ps(d,l.node().type.name,l.node().attrs),...e},S=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(C))||void 0;b=b.append($.from(a.createAndFill(null,S)||void 0));const k=l.before(l.depth-(x-1));t.replace(k,l.after(-w),new _(b,4-x,0));let O=-1;t.doc.nodesBetween(k,t.doc.content.size,(M,R)=>{if(O>-1)return!1;M.isTextblock&&M.content.size===0&&(O=R+1)}),O>-1&&t.setSelection(be.near(t.doc.resolve(O))),t.scrollIntoView()}return!0}const h=c.pos===l.end()?f.contentMatchAt(0).defaultType:null,p={...Ps(d,f.type.name,f.attrs),...e},m={...Ps(d,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const g=h?[{type:a,attrs:p},{type:h,attrs:m}]:[{type:a,attrs:p}];if(!ai(t.doc,l.pos,2))return!1;if(i){const{selection:b,storedMarks:x}=r,{splittableMarks:w}=o.extensionManager,C=x||b.$to.parentOffset&&b.$from.marks();if(t.split(l.pos,2,g).scrollIntoView(),!C||!i)return!0;const S=C.filter(k=>w.includes(k.type.name));t.ensureMarks(S)}return!0},oc=(n,e)=>{const t=Vf(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&Ar(n.doc,t.pos)&&n.join(t.pos),!0},sc=(n,e)=>{const t=Vf(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&Ar(n.doc,r)&&n.join(r),!0},Sj=(n,e,t,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:f,splittableMarks:d}=i.extensionManager,h=Ke(n,s.schema),p=Ke(e,s.schema),{selection:m,storedMarks:g}=s,{$from:b,$to:x}=m,w=b.blockRange(x),C=g||m.$to.parentOffset&&m.$from.marks();if(!w)return!1;const S=Vf(k=>em(k.type.name,f))(m);if(w.depth>=1&&S&&w.depth-S.depth<=1){if(S.node.type===h)return c.liftListItem(p);if(em(S.node.type.name,f)&&h.validContent(S.node.content)&&a)return l().command(()=>(o.setNodeMarkup(S.pos,h),!0)).command(()=>oc(o,h)).command(()=>sc(o,h)).run()}return!t||!C||!a?l().command(()=>u().wrapInList(h,r)?!0:c.clearNodes()).wrapInList(h,r).command(()=>oc(o,h)).command(()=>sc(o,h)).run():l().command(()=>{const k=u().wrapInList(h,r),O=C.filter(M=>d.includes(M.type.name));return o.ensureMarks(O),k?!0:c.clearNodes()}).wrapInList(h,r).command(()=>oc(o,h)).command(()=>sc(o,h)).run()},Cj=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,s=qn(n,r.schema);return dj(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},kj=(n,e,t={})=>({state:r,commands:i})=>{const o=Ke(n,r.schema),s=Ke(e,r.schema),a=Hf(r,o,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...t})},Oj=(n,e={})=>({state:t,commands:r})=>{const i=Ke(n,t.schema);return Hf(t,i,e)?r.lift(i):r.wrapIn(i,e)},Mj=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const s=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},Ej=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},Tj=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=qn(n,r.schema),{$from:c,empty:u,ranges:f}=a;if(!i)return!0;if(u&&s){let{from:d,to:h}=a;const p=(o=c.marks().find(g=>g.type===l))===null||o===void 0?void 0:o.attrs,m=Jb(c,l,p);m&&(d=m.from,h=m.to),t.removeMark(d,h,l)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,l)});return t.removeStoredMark(l),!0},Rj=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=Xb(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=Ke(n,r.schema)),a==="mark"&&(s=qn(n,r.schema)),i&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let f,d,h,p;t.selection.empty?r.doc.nodesBetween(c,u,(m,g)=>{o&&o===m.type&&(h=Math.max(g,c),p=Math.min(g+m.nodeSize,u),f=g,d=m)}):r.doc.nodesBetween(c,u,(m,g)=>{g<c&&o&&o===m.type&&(h=Math.max(g,c),p=Math.min(g+m.nodeSize,u),f=g,d=m),g>=c&&g<=u&&(o&&o===m.type&&t.setNodeMarkup(g,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(b=>{if(s===b.type){const x=Math.max(g,c),w=Math.min(g+m.nodeSize,u);t.addMark(x,w,s.create({...b.attrs,...e}))}}))}),d&&(f!==void 0&&t.setNodeMarkup(f,void 0,{...d.attrs,...e}),s&&d.marks.length&&d.marks.forEach(m=>{s===m.type&&t.addMark(h,p,s.create({...m.attrs,...e}))}))}),!0):!1},Aj=(n,e={})=>({state:t,dispatch:r})=>{const i=Ke(n,t.schema);return tz(i,e)(t,r)},Dj=(n,e={})=>({state:t,dispatch:r})=>{const i=Ke(n,t.schema);return nz(i,e)(t,r)};var $j=Object.freeze({__proto__:null,blur:yz,clearContent:bz,clearNodes:wz,command:vz,createParagraphNear:xz,cut:Sz,deleteCurrentNode:Cz,deleteNode:kz,deleteRange:Oz,deleteSelection:Mz,enter:Ez,exitCode:Tz,extendMarkRange:Rz,first:Az,focus:Pz,forEach:Nz,insertContent:Iz,insertContentAt:Lz,joinBackward:_z,joinDown:Fz,joinForward:Wz,joinItemBackward:Hz,joinItemForward:Vz,joinTextblockBackward:qz,joinTextblockForward:Gz,joinUp:Bz,keyboardShortcut:Uz,lift:Kz,liftEmptyBlock:Yz,liftListItem:Xz,newlineInCode:Qz,resetAttributes:Zz,scrollIntoView:ej,selectAll:tj,selectNodeBackward:nj,selectNodeForward:rj,selectParentNode:ij,selectTextblockEnd:oj,selectTextblockStart:sj,setContent:lj,setMark:pj,setMeta:mj,setNode:gj,setNodeSelection:yj,setTextSelection:bj,sinkListItem:wj,splitBlock:vj,splitListItem:xj,toggleList:Sj,toggleMark:Cj,toggleNode:kj,toggleWrap:Oj,undoInputRule:Mj,unsetAllMarks:Ej,unsetMark:Tj,updateAttributes:Rj,wrapIn:Aj,wrapInList:Dj});_t.create({name:"commands",addCommands(){return{...$j}}});_t.create({name:"drop",addProseMirrorPlugins(){return[new Dr({key:new $r("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}});_t.create({name:"editable",addProseMirrorPlugins(){return[new Dr({key:new $r("editable"),props:{editable:()=>this.editor.options.editable}})]}});_t.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Dr({key:new $r("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}});_t.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:f}=l,{pos:d,parent:h}=f,p=f.parent.isTextblock&&d>0?a.doc.resolve(d-1):f,m=p.parent.type.spec.isolating,g=f.pos-f.parentOffset,b=m&&p.parent.childCount===1?g===f.pos:ie.atStart(c).from===d;return!u||!h.type.isTextblock||h.textContent.length||!b||b&&f.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Wf()||Yb()?o:i},addProseMirrorPlugins(){return[new Dr({key:new $r("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!e.doc.eq(t.doc),i=n.some(m=>m.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=ie.atStart(e.doc).from,c=ie.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!Qb(t.doc))return;const d=t.tr,h=qb({state:t,transaction:d}),{commands:p}=new cz({editor:this.editor,state:h});if(p.clearNodes(),!!d.steps.length)return d}})]}});_t.create({name:"paste",addProseMirrorPlugins(){return[new Dr({key:new $r("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}});_t.create({name:"tabindex",addProseMirrorPlugins(){return[new Dr({key:new $r("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});let Pj=class bu{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=hn(zt(this,"addOptions",{name:this.name}))),this.storage=hn(zt(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new bu(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>_f(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new bu(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=hn(zt(t,"addOptions",{name:t.name})),t.storage=hn(zt(t,"addStorage",{name:t.name,options:t.options})),t}};const Nj=Pj.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",fz(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const f=l.filter(d=>a.includes(d.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Ij=bw.div`
  .tiptap {
    min-height: 200px;
    p {
      font-size: 1.5rem;
    }
    :first-child {
      margin-top: 0;
    }

    table {
      border-spacing: 10px;
      border-collapse: separate;
      td,
      th {
        padding: 10px;
      }
    }

    /* Heading styles */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-weight: bold;
      line-height: 1.1;
      margin-top: 2.5rem;
      text-wrap: pretty;
    }

    h1 {
      font-size: 2rem;
    }
    h2 {
      font-size: 1.8rem;
    }
    h3 {
      font-size: 1.6rem;
    }
    h4,
    h5,
    h6 {
      font-size: 1.5rem;
    }
  }
`,zj=({value:n,onChange:e,availableFields:t})=>{const r=dE({extensions:[fT,s0,Nj,e0.configure({levels:[1,2,3]}),Qy,o0,dT.configure({placeholder:"Start typing..."}),mR.configure({resizable:!0}),bR,yR,gR],content:n.replaceAll(",",""),onUpdate:({editor:o})=>{e(o.getHTML())}});if(!r)return y.jsx("p",{children:"Loading editor..."});const i=o=>{r.commands.insertContent(`{{${o}}}`)};return y.jsxs(vt,{padding:4,background:"neutral100",borderRadius:"4px",children:[y.jsxs(ye,{gap:2,paddingBottom:3,wrap:"wrap",children:[y.jsx(he,{variant:"tertiary",onClick:()=>r.chain().focus().toggleBold().run(),startIcon:y.jsx(mw,{}),children:"Bold"}),y.jsx(he,{variant:"tertiary",onClick:()=>r.chain().focus().toggleItalic().run(),startIcon:y.jsx(gw,{}),children:"Italic"}),y.jsx(he,{variant:"tertiary",onClick:()=>r.chain().focus().toggleHeading({level:1}).run(),children:"H1"}),y.jsx(he,{variant:"tertiary",onClick:()=>r.chain().focus().toggleHeading({level:2}).run(),children:"H2"}),y.jsx(he,{variant:"tertiary",onClick:()=>r.chain().focus().toggleHeading({level:3}).run(),children:"H3"})]}),y.jsx(ye,{gap:2,paddingBottom:3,wrap:"wrap",children:t.map(o=>!o.field||o.field.type==="file"?y.jsx(y.Fragment,{}):y.jsx(he,{variant:"secondary",onClick:()=>o.field&&i(o.field?.name),children:o.field?.label},o.i))}),y.jsx(Ij,{children:y.jsx(vt,{background:"neutral0",border:"1px solid #EAEAEA",borderRadius:"4px",padding:3,minHeight:"200px",children:y.jsx(nE,{editor:r})})})]})},jj=({formId:n,currentNotification:e,isModalVisible:t,setModalIsVisible:r})=>{const i=Ao("Admin",k=>k.token),[o,s]=v.useState(e),{formatMessage:a}=Ct(),{state:l,dispatch:c}=ki(),[u,f]=v.useState(!1),[d,h]=v.useState(!0),[p,m]=v.useState(a({id:`${wt}.required`})),[g,b]=v.useState(null);if(!o)return y.jsx(y.Fragment,{});v.useEffect(()=>{Ql.get(i,o.documentId).then(k=>{c({type:"EDIT_FORM",payload:k.form}),console.log("res",k),s(k)}).finally(()=>h(!1))},[]);const x=(k,O)=>{const M={...o,[k]:O};s(M)},w=()=>{r(!1)},C=async()=>{await Ql.update(i,o?.documentId,o),w()},S=async()=>{b("Sending...");try{if(!(await Ql.test(i,o?.documentId)).ok)throw new Error("Failed to send test email");b(" Test email sent successfully!")}catch(k){console.error("Test email error:",k),b(" Failed to send test email.")}setTimeout(()=>b(null),5e3)};return!t||!o||!l||d?y.jsx(y.Fragment,{}):y.jsx(Oe.Root,{open:t,onOpenChange:w,children:y.jsxs(Oe.Content,{children:[y.jsx(Oe.Header,{children:y.jsx(ye,{direction:"column",gap:4,alignItems:"stretch",width:"100%",children:y.jsx(Oe.Title,{children:"E-mail"})})}),y.jsx(Oe.Body,{children:y.jsxs(ye,{direction:"column",gap:4,alignItems:"stretch",width:"100%",children:[y.jsx(hw,{onChange:()=>x("enabled",o.enabled=!o.enabled),visibleLabels:!0,checked:!!o.enabled}),y.jsxs(X.Root,{name:"from",id:"from",error:u?p:"",children:[y.jsx(X.Label,{children:a({id:A("forms.fields.from")})}),y.jsx(er,{name:"from",value:o.from,onChange:k=>{x("from",k.target.value)}})]}),y.jsxs(X.Root,{name:"to",id:"to",error:u?p:"",children:[y.jsx(X.Label,{children:a({id:A("forms.fields.recipient")})}),o.identifier===_o.Notification?y.jsx(er,{name:"to",value:o.to,onChange:k=>{x("to",k.target.value)}}):y.jsx(rI,{notification:o,setValue:x})]}),y.jsxs(X.Root,{children:[y.jsx(X.Label,{children:a({id:A("forms.fields.subject")})}),y.jsx(er,{name:"subject",value:o.subject,onChange:k=>{x("subject",k.target.value)}})]}),y.jsx(Is,{}),y.jsx(he,{variant:"secondary",onClick:S,children:a({id:A("forms.fields.test_email.send")})}),y.jsx(Me,{variant:"pi",textColor:"neutral600",children:a({id:A("forms.fields.test_email.info")})}),g&&y.jsx(fm,{variant:"info",style:{width:"100%"},children:g}),y.jsx(Is,{}),y.jsx(zj,{value:o.message,onChange:k=>x("message",k),availableFields:l.steps[0].layouts.lg})]})}),y.jsxs(Oe.Footer,{children:[y.jsx(Oe.Close,{children:y.jsx(he,{variant:"tertiary",children:a({id:A("cancel")})})}),y.jsx(he,{onClick:C,children:a({id:A("save")})})]})]})})},Lj=({onGenerateSuccess:n})=>{const[e,t]=v.useState(!1),[r,i]=v.useState(!1),[o,s]=v.useState(""),[a,l]=v.useState(!1),[c,u]=v.useState(""),f=o.trim().length>10,d=Ao("Admin",p=>p.token);v.useEffect(()=>{(async()=>{const m=await In.getSettings(d),{data:g}=m;if(!g.settings||!g.settings.ai.enabled)return!1;t(!0)})()},[]);const h=async()=>{if(f){u(""),l(!0);try{const p=await In.generateForm(d,{prompt:o});console.log(p),i(!1),s(""),n(!0)}catch{u("Error generating the form. Please try again later.")}finally{l(!1)}}};return e?y.jsxs(y.Fragment,{children:[y.jsx(he,{startIcon:y.jsx(Jf,{}),onClick:()=>i(!0),children:"Generate Form"}),y.jsx(Te.Root,{open:r,onDismiss:()=>i(!1),children:y.jsxs(Te.Content,{children:[y.jsx(Te.Header,{children:"Generate Form"}),y.jsx(Te.Body,{children:y.jsxs(ye,{direction:"column",gap:4,alignItems:"flex-start",style:{width:"100%"},children:[y.jsx(Me,{children:"Describe the form you want to generate using plain text. The AI will help you!"}),y.jsx(X.Root,{style:{width:"100%"},children:y.jsx(lo,{name:"aiPrompt",placeholder:"e.g. 'Customer feedback form with name, email, and a text field for feedback'",onChange:p=>s(p.target.value),value:o,error:o&&!f?"Please enter more details.":""})}),c&&y.jsx(Me,{variant:"pi",textColor:"danger500",children:c})]})}),y.jsxs(Te.Footer,{children:[y.jsx(he,{startIcon:y.jsx(Jf,{}),onClick:h,loading:a,disabled:!f||a,children:"Generate"}),y.jsx(he,{variant:"secondary",onClick:()=>i(!1),disabled:a,children:"Cancel"})]})]})})]}):y.jsx(y.Fragment,{})},nm=n=>n.split("T")[0],Bj=()=>{const n=wu(),e=sm(),t=Ao("Admin",T=>T.token),{formatMessage:r}=Ct(),[i,o]=v.useState(!1),[s,a]=v.useState(null),[l,c]=v.useState(!1),[u,f]=v.useState(null),[d,h]=v.useState(!1),[p,m]=v.useState(null),[g,b]=v.useState([]),[x,w]=v.useState([]),[C,S]=v.useState(!1),[{query:k}]=am({page:1,pageSize:10});v.useEffect(()=>{(async()=>{o(!0);try{const P=await In.getForms(t,k);b(P.data),w(P.meta?.pagination)}catch(P){b([]),w(null),a(P)}finally{o(!1)}})()},[n,C]),v.useEffect(()=>{(async()=>{o(!0);try{const P=await In.getForms(t,k);b(P.data),w(P.meta?.pagination)}catch(P){b([]),w(null),a(P)}finally{o(!1)}})()},[e.search]);const O=["#",r({id:A("list.name")}),r({id:A("list.creation_date")}),r({id:A("list.submissions")}),r({id:A("list.handlers")}),r({id:A("list.active")}),y.jsx(lm,{children:"Actions"})],M=T=>{f(T),c(!0)},R=async()=>{if(!(!u&&!t))try{await In.deleteForm(t,u.documentId),b(g.filter(T=>T.id!==u.id)),c(!1)}catch(T){console.error("Error deleting form:",T)}};return i?y.jsx(gt.Loading,{}):s?y.jsx(gt.Error,{}):y.jsx(y.Fragment,{children:y.jsxs(Kt.Root,{children:[y.jsx(gt.Title,{children:r({id:A("heading.menu")})}),y.jsxs(gt.Main,{style:{position:"relative"},children:[y.jsx(Kt.Header,{title:r({id:A("forms.label")}),primaryAction:y.jsxs(ye,{gap:4,children:[y.jsx(Lj,{onGenerateSuccess:S}),y.jsx(Nt,{startIcon:y.jsx(lc,{style:{fill:"white"}}),href:`/admin/plugins/${wt}/form`,children:r({id:A("forms.subtitle")})})]}),secondaryAction:y.jsx(Nt,{variant:"tertiary",startIcon:y.jsx(Gf,{}),to:`/plugins/${wt}/submissions`,tag:ac,children:r({id:A("submissions.all")})}),navigationAction:y.jsx(vu,{disabled:void 0})}),y.jsxs(Kt.Content,{children:[y.jsx(Tt.Root,{children:y.jsx(Tt.Item,{col:12,s:12,children:y.jsxs(vt,{style:{width:"100%"},children:[y.jsx(se.Root,{rows:g,headers:O,isLoading:i,children:y.jsxs(se.Content,{children:[y.jsx(se.Head,{children:O.map((T,P)=>y.jsx(se.HeaderCell,{name:T,label:T},P))}),y.jsx(se.Loading,{}),y.jsx(se.Empty,{action:y.jsx(Nt,{startIcon:y.jsx(lc,{style:{fill:"white"}}),href:`/admin/plugins/${wt}/form/add`,children:r({id:A("forms.subtitle")})})}),y.jsx(se.Body,{children:g&&g.map(T=>{const P=new Intl.DateTimeFormat("nl-NL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}).format(new Date(T.createdAt)),z=T.dateFrom?nm(T.dateFrom):"",U=T.dateTill?nm(T.dateTill):"";return y.jsxs(se.Row,{children:[y.jsx(se.Cell,{children:y.jsx(Me,{textColor:"neutral800",children:T.id})}),y.jsx(se.Cell,{children:y.jsx(Me,{textColor:"neutral800",children:T.title})}),y.jsx(se.Cell,{children:y.jsx(Me,{textColor:"neutral800",children:P})}),y.jsx(se.Cell,{children:y.jsxs(ye,{gap:2,justifyContent:"flex-start",children:[y.jsx(Nt,{disabled:T.submissions.length===0,variant:"secondary",to:`form/${T.documentId}/submissions`,startIcon:y.jsx(Gf,{}),tag:ac,children:T.submissions.length}),y.jsx(XN,{formId:T.documentId,disabled:T.submissions.length===0})]})}),y.jsx(se.Cell,{children:y.jsx(ye,{gap:2,justifyContent:"flex-start",children:!!T.notifications.length&&y.jsx(nI,{notifications:T.notifications,setModalIsVisible:h,setHandlerType:m})})}),y.jsx(se.Cell,{children:y.jsxs(ye,{gap:2,justifyContent:"flex-start",children:[T.active,y.jsx(ow,{active:T.active,children:r({id:A(`list.${T.active?"active":"inactive"}`)})}),T.dateFrom||T.dateTill?y.jsxs(y.Fragment,{children:[z," - ",U]}):y.jsx(y.Fragment,{})]})}),y.jsx(se.Cell,{children:y.jsxs(ye,{gap:2,justifyContent:"flex-end",children:[y.jsx(Nt,{href:`/admin/plugins/${wt}/form/${T.documentId}`,startIcon:y.jsx(Ns,{}),style:{fill:"white",color:"white"},children:r({id:A("actions.edit")})}),y.jsx(Nt,{variant:"danger",startIcon:y.jsx(cm,{}),onClick:()=>M(T),style:{fill:"white",color:"white"},children:r({id:A("actions.delete")})})]})})]},T.id)})})]})}),y.jsxs(Zr.Root,{...x,defaultPageSize:10,children:[y.jsx(Zr.PageSize,{}),y.jsx(Zr.Links,{})]})]})})}),d&&p&&y.jsx(y0,{children:y.jsx(jj,{currentNotification:p,isModalVisible:d,setModalIsVisible:h})}),y.jsx(Te.Root,{open:l,onDismiss:()=>c(!1),children:y.jsxs(Te.Content,{children:[y.jsx(Te.Header,{children:r({id:A("dialog.delete.text")})}),y.jsx(Te.Body,{icon:y.jsx(sw,{fill:"danger600"}),children:r({id:A("dialog.delete.description")})}),y.jsxs(Te.Footer,{children:[y.jsx(Te.Cancel,{children:y.jsx(he,{fullWidth:!0,variant:"tertiary",onClick:()=>c(!1),children:r({id:A("dialog.cancel")})})}),y.jsx(Te.Action,{children:y.jsx(he,{fullWidth:!0,variant:"danger-light",onClick:R,children:r({id:A("dialog.confirm")})})})]})]})})]})]})]})})},rm={getSubmissions:async(n,e)=>(await lt(`submissions?${db.stringify({sort:"publishedAt:desc",pagination:{page:e.page,pageSize:e.pageSize}})}`,n,"GET",null,null,!0)).json(),getSubmission:async(n,e)=>(await lt(`submission/${e}`,n,"GET",null,null,!0)).json()},im=()=>{const n=wu(),e=sm();um();const[t,r]=v.useState(!1),[i,o]=v.useState(null),s=(S,k=100)=>typeof S=="string"&&S.length>k?S.substring(0,k)+"...":S,a=S=>{o(S),r(!0)},l=()=>{r(!1),o(null)},{formatMessage:c}=Ct(),[u,f]=v.useState(!1),[d,h]=v.useState(null),[p,m]=v.useState([]),[g,b]=v.useState([]),x=Ao("Admin",S=>S.token);if(!x)return y.jsx(gt.Loading,{});const[{query:w}]=am({page:1,pageSize:10});v.useEffect(()=>{(async()=>{f(!0);try{const k=await rm.getSubmissions(x,w);m(k.data),b(k.meta?.pagination)}catch(k){m([]),b(null),h(k)}finally{f(!1)}})()},[n]),v.useEffect(()=>{(async()=>{f(!0);try{const k=await rm.getSubmissions(x,w);m(k.data),b(k.meta?.pagination)}catch(k){m([]),b(null),h(k)}finally{f(!1)}})()},[e.search]);const C=["#",c({id:A("submission.title")}),c({id:A("list.creation_date")}),y.jsx(lm,{children:"Actions"})];return u?y.jsx(gt.Loading,{}):d?y.jsx(gt.Error,{}):y.jsx(y.Fragment,{children:y.jsxs(Kt.Root,{children:[y.jsx(gt.Title,{children:c({id:A("submissions.label")})}),y.jsxs(gt.Main,{style:{position:"relative"},children:[y.jsx(Kt.Header,{title:c({id:A("submissions.label")}),navigationAction:y.jsx(vu,{disabled:void 0}),secondaryAction:y.jsx(Nt,{variant:"tertiary",startIcon:y.jsx(aw,{}),to:`/plugins/${wt}`,tag:ac,children:c({id:A("forms.all")})})}),y.jsxs(Kt.Content,{children:[y.jsx(Tt.Root,{children:y.jsx(Tt.Item,{col:12,s:12,children:y.jsxs(vt,{style:{width:"100%"},children:[y.jsx(se.Root,{rows:p,headers:C,isLoading:u,children:y.jsxs(se.Content,{children:[y.jsx(se.Head,{children:C.map((S,k)=>y.jsx(se.HeaderCell,{name:S,label:S},k))}),y.jsx(se.Loading,{}),y.jsx(se.Empty,{}),y.jsx(se.Body,{children:p&&p.map(S=>{const k=new Intl.DateTimeFormat("nl-NL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}).format(new Date(S.publishedAt)),O=Object.entries(S.submission).map((M,R)=>`${M.join(": ")}  `);return y.jsxs(se.Row,{children:[y.jsx(se.Cell,{children:y.jsx(Me,{textColor:"neutral800",children:S.id})}),y.jsx(se.Cell,{children:y.jsx(Me,{textColor:"neutral800",children:y.jsx("div",{children:s(O.join(" - "))})})}),y.jsx(se.Cell,{children:y.jsx(Me,{textColor:"neutral800",children:k})}),y.jsx(se.Cell,{children:y.jsx(Nt,{variant:"secondary",onClick:()=>a(S),children:y.jsxs(ye,{gap:2,justifyContent:"flex-start",alignItems:"center",children:[y.jsx(lw,{}),"View details"]})})})]},S.id)})})]})}),y.jsxs(Zr.Root,{...g,defaultPageSize:10,children:[y.jsx(Zr.PageSize,{}),y.jsx(Zr.Links,{})]})]})})}),y.jsx(Oe.Root,{open:t&&i,onOpenChange:l,children:y.jsxs(Oe.Content,{children:[y.jsx(Oe.Header,{children:y.jsx(Me,{variant:"beta",children:"Submission Details"})}),y.jsx(Oe.Body,{children:i?.submission&&y.jsx(vt,{padding:0,children:y.jsx(vt,{background:"neutral100",padding:4,shadow:"tableShadow",hasRadius:!0,children:Object.entries(i.submission).map(([S,k])=>y.jsxs(ye,{marginBottom:4,justifyContent:"space-between",alignItems:"flex-start",wrap:"wrap",children:[y.jsxs(Me,{fontWeight:"bold",textColor:"neutral800",style:{flex:1,maxWidth:"200px"},children:[S,":"]}),y.jsx(Me,{textColor:"neutral800",style:{flex:2},children:typeof k=="object"?y.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordWrap:"break-word"},children:JSON.stringify(k,null,2)}):k||"N/A"})]},S))})})}),y.jsx(Oe.Footer,{children:y.jsx(Oe.Close,{children:y.jsx(he,{variant:"tertiary",children:c({id:A("close")})})})})]})})]})]})]})})},fL=()=>y.jsx(Kt.Root,{children:y.jsxs(iw,{children:[y.jsx(Ir,{index:!0,element:y.jsx(Bj,{})}),y.jsx(Ir,{path:"/submissions",element:y.jsx(im,{})}),y.jsx(Ir,{path:"/form/:id/submissions",element:y.jsx(im,{})}),y.jsx(Ir,{path:"/form",element:y.jsx(Ip,{})}),y.jsx(Ir,{path:"/form/:id",element:y.jsx(Ip,{})}),y.jsx(Ir,{path:"*",element:y.jsx(gt.Error,{})})]})});export{fL as App};
