import{b$ as A,gN as y,s as O,gM as $,r as x,aF as T,j as e,aA as c,P as F,gO as o,hi as H,O as W,hI as z,hk as B,hF as u,N as _,hl as G,hx as P,bW as U,i4 as q,hK as K,hc as V,h5 as g,hD as d,is as b,it as Y,iu as j,iv as J}from"./strapi-BzDuHlVM.js";const Q=({sort:i="",pageSize:s=10,onChange:t})=>{const{formatMessage:n}=y();return e.jsx(V,{background:"neutral0",hasRadius:!0,shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:e.jsxs(g.Root,{gap:4,children:[e.jsx(g.Item,{s:12,col:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.entries.note"),defaultMessage:"Number of assets displayed by default in the Media Library"}),name:"pageSize",children:[e.jsx(d.Label,{children:n({id:o("config.entries.title"),defaultMessage:"Entries per page"})}),e.jsx(b,{onChange:a=>t({target:{name:"pageSize",value:a}}),value:s,children:Y.map(a=>e.jsx(j,{value:a,children:a},a))}),e.jsx(d.Hint,{})]})}),e.jsx(g.Item,{s:12,col:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.note"),defaultMessage:"Note: You can override this value in the media library."}),name:"sort",children:[e.jsx(d.Label,{children:n({id:o("config.sort.title"),defaultMessage:"Default sort order"})}),e.jsx(b,{onChange:a=>t({target:{name:"sort",value:a}}),value:i,"test-sort":i,"data-testid":"sort-select",children:J.map(a=>e.jsx(j,{"data-testid":`sort-option-${a.value}`,value:a.value,children:n({id:o(a.key),defaultMessage:`${a.value}`})},a.key))}),e.jsx(d.Hint,{})]})})]})})},D=`${u}/ON_CHANGE`,v=`${u}/SET_LOADED`,X=({name:i,value:s})=>({type:D,keys:i,value:s}),Z=()=>({type:v}),h={initialData:{},modifiedData:{}},S=i=>({...h,initialData:i,modifiedData:i}),ee=(i=h,s={type:""})=>T(i,t=>{switch(s.type){case D:{"keys"in s&&"value"in s&&s.keys&&K(t,["modifiedData",...s.keys.split(".")],s.value);break}case v:{const n=S(q(t,["modifiedData"],{}));t.initialData=n.initialData,t.modifiedData=n.modifiedData;break}default:return t}}),te=({config:i})=>{const{trackUsage:s}=A(),{formatMessage:t}=y(),{toggleNotification:n}=O(),{mutateConfig:a}=$(),{isLoading:C}=a,[M,f]=x.useState(!1),m=()=>f(r=>!r),[k,w]=x.useReducer(ee,h,()=>S(i)),p=w,{initialData:L,modifiedData:l}=k,E=r=>{r.preventDefault(),m()},N=async()=>{s("willEditMediaLibraryConfig"),await a.mutateAsync(l),f(!1),p(Z()),n({type:"success",message:t({id:"notification.form.success.fields",defaultMessage:"Changes saved"})})},R=({target:{name:r,value:I}})=>{p(X({name:r,value:I}))};return e.jsx(c.Root,{children:e.jsx(F.Main,{"aria-busy":C,children:e.jsxs("form",{onSubmit:E,children:[e.jsx(c.Header,{navigationAction:e.jsx(B,{tag:_,startIcon:e.jsx(G,{}),to:`/plugins/${u}`,id:"go-back",children:t({id:o("config.back"),defaultMessage:"Back"})}),primaryAction:e.jsx(H,{size:"S",startIcon:e.jsx(z,{}),disabled:W(l,L),type:"submit",children:t({id:"global.save",defaultMessage:"Save"})}),subtitle:t({id:o("config.subtitle"),defaultMessage:"Define the view settings of the media library."}),title:t({id:o("config.title"),defaultMessage:"Configure the view - Media Library"})}),e.jsx(c.Content,{children:e.jsx(Q,{"data-testid":"settings",pageSize:l.pageSize||"",sort:l.sort||"",onChange:R})}),"x",e.jsx(P.Root,{open:M,onOpenChange:m,children:e.jsx(U,{onConfirm:N,variant:"default",children:t({id:o("config.popUpWarning.warning.updateAllSettings"),defaultMessage:"This will modify all your settings"})})})]})})})};export{te as ConfigureTheView};
